(function(){if(!window.imap5){window.imap5={};var a=window.imap5;a.div=[];a.background=[];a.foreground=[];a.usermap=[];a.map=[];a.mode=[];a.geometry=[];a.svg=[];a.g=[];a.svgcoord=[];a.zoom=[];a.zoomcontrol=[];a.panhome=[];a.zoomin=[];a.zoomout=[];a.selected=[];a.infobox=[];a.coords=[];a.selectedOverlay=[];a.selectedVerticesObj=[];a.marker=[];a.maplabel=[];a.mappath=[];a.mappoly=[];a.maprect=[];a.mapcurve=[];a.maplegend=[];a.mapabbr=[];a.geoareasize=[];a.mapbubble=[];a.mapbubblesize=[];a.piechart=
[];a.path=[];a.poly=[];a.rect=[];a.curve=[];a.groupHL=[];a.center=[];a.grouphighlight=[];a.fadeout=[];a.heatmap=[];a.categorylegend=[];a.maptitle=[];a.base=[];a.precision=6;a.factor=[];a.setMode=function(b){a.mode[b.usermap]=b.mode;ja(b);if("edit"==a.mode[b.usermap])for(var d in a.maplabel[b.usermap])a.maplabel[b.usermap].hasOwnProperty(d)&&(a.maplabel[b.usermap][d].getElementsByTagName("text")[0].style.pointerEvents="auto");else for(d in a.maplabel[b.usermap])a.maplabel[b.usermap].hasOwnProperty(d)&&
(a.maplabel[b.usermap][d].getElementsByTagName("text")[0].style.pointerEvents="none");S(b)};a.setGeometry=function(b){a.usermap[b.usermap].map.geometry[b.geometry]=b.data;U(b);ka(b);$(b)};a.setGeometries=function(b){for(var d in b.geometry)b.geometry.hasOwnProperty(d)&&(a.usermap[b.usermap].map.geometry[d]=b.geometry[d],a.mapabbr[b.usermap].hasOwnProperty(d)&&(a.mapabbr[b.usermap][d].setLabel(b.geometry[d].title),"undefined"!=typeof b.geometry[d].hideAbbreviation&&(b.geometry[d].hideAbbreviation?
a.mapabbr[b.usermap][d].hide():a.mapabbr[b.usermap][d].show())),a.mapbubble[b.usermap].hasOwnProperty(d)&&(a.mapbubble[b.usermap][d]._options.bubblevalue=b.geometry[d].bubblevalue));ka(b);$(b);S(b);for(d in a.usermap[b.usermap].map.geometry)a.usermap[b.usermap].map.geometry.hasOwnProperty(d)&&U({usermap:b.usermap,geometry:d});if("undefined"!=typeof a.usermap[b.usermap].map.bubblemap&&"undefined"!=typeof a.usermap[b.usermap].map.bubblemap.enable&&a.usermap[b.usermap].map.bubblemap.enable){var h=0;
for(d in a.geometry[b.usermap])Math.abs(a.usermap[b.usermap].map.geometry[d].bubblevalue)>=h&&(h=Math.abs(a.usermap[b.usermap].map.geometry[d].bubblevalue));a.usermap[b.usermap].map.bubblemap.maxbubble=h;for(d in a.mapbubble[b.usermap])a.mapbubble[b.usermap].hasOwnProperty(d)&&a.mapbubble[b.usermap][d].drawMapBubble()}};a.setFadeOut=function(b){a.usermap[b.usermap].map.fadeout=b.fadeout;a.fadeout[b.usermap].enable=b.fadeout.enable};a.setGroupHighlight=function(b){a.usermap[b.usermap].map.grouphighlight=
b.grouphighlight;a.grouphighlight[b.usermap].enable=b.grouphighlight.enable};a.setHeatMap=function(b){a.usermap[b.usermap].map.heatmap=b.heatmap;a.heatmap[b.usermap].enable=b.heatmap.enable;$(b);for(var d in a.usermap[b.usermap].map.geometry)a.usermap[b.usermap].map.geometry.hasOwnProperty(d)&&U({usermap:b.usermap,geometry:d})};a.setCategoryLegend=function(b){var d="undefined"==typeof a.usermap[b.usermap].map.categorylegend?!1:a.usermap[b.usermap].map.categorylegend.enable;a.usermap[b.usermap].map.categorylegend=
b.categorylegend;a.usermap[b.usermap].map.categorylegend.enable?d?(a.categorylegend[b.usermap].setOptions(b.categorylegend),a.categorylegend[b.usermap].drawCategoryLegend(),a.updateCategoryLegend(b)):a.categorylegend[b.usermap]=new la(b,a.usermap[b.usermap].map.categorylegend):d&&a.categorylegend[b.usermap].remove();S(b)};a.setMapTitle=function(b){a.usermap[b.usermap].map.maptitle=b.maptitle;"undefined"!==typeof a.maptitle[b.usermap]&&null!==a.maptitle[b.usermap]?(a.maptitle[b.usermap].setOptions(b.maptitle),
a.maptitle[b.usermap].drawMapTitle()):a.maptitle[b.usermap]=new ma(b,b.maptitle)};a.setBubbleMap=function(b){var d="undefined"==typeof a.usermap[b.usermap].map.bubblemap?!1:a.usermap[b.usermap].map.bubblemap.enable;a.usermap[b.usermap].map.bubblemap=b.bubblemap;if(a.usermap[b.usermap].map.bubblemap.enable)if(d){var d=0,h;for(h in a.geometry[b.usermap])Math.abs(a.usermap[b.usermap].map.geometry[h].bubblevalue)>=d&&(d=Math.abs(a.usermap[b.usermap].map.geometry[h].bubblevalue));a.usermap[b.usermap].map.bubblemap.maxbubble=
d;for(h in a.mapbubble[b.usermap])a.mapbubble[b.usermap].hasOwnProperty(h)&&a.mapbubble[b.usermap][h].drawMapBubble()}else{d=0;a.mapbubblesize[b.usermap].length=0;for(h in a.geometry[b.usermap])a.mapbubblesize[b.usermap].push({id:a.geometry[b.usermap][h].id,bubblesize:Math.abs(a.usermap[b.usermap].map.geometry[h].bubblevalue)}),Math.abs(a.usermap[b.usermap].map.geometry[h].bubblevalue)>=d&&(d=Math.abs(a.usermap[b.usermap].map.geometry[h].bubblevalue));a.mapbubblesize[b.usermap].sort(function(a,b){return b.bubblesize-
a.bubblesize});a.usermap[b.usermap].map.bubblemap.maxbubble=d;for(d=0;d<a.mapbubblesize[b.usermap].length;d++)if(a.mapbubblesize[b.usermap].hasOwnProperty(d)&&(h=a.mapbubblesize[b.usermap][d].id,a.geometry[b.usermap].hasOwnProperty(h))){var f={};f.lat=a.geometry[b.usermap][h].centroid.lat;f.lng=a.geometry[b.usermap][h].centroid.lng;f.bubblevalue=a.usermap[b.usermap].map.geometry[h].bubblevalue;a.mapbubble[b.usermap][h]=new na(b,h,f)}}else if(d)for(h in a.mapbubble[b.usermap])a.mapbubble[b.usermap].hasOwnProperty(h)&&
a.mapbubble[b.usermap][h].remove()};a.setPieChart=function(b){var d="undefined"==typeof a.usermap[b.usermap].map.piechart?!1:a.usermap[b.usermap].map.piechart.enable;a.usermap[b.usermap].map.piechart=b.piechart;if(a.usermap[b.usermap].map.piechart.enable)if(d)for(var h in a.piechart[b.usermap])a.piechart[b.usermap].hasOwnProperty(h)&&a.piechart[b.usermap][h].drawPieChart();else for(h in a.geometry[b.usermap])a.geometry[b.usermap].hasOwnProperty(h)&&(d={},d.lat=a.geometry[b.usermap][h].centroid.lat,
d.lng=a.geometry[b.usermap][h].centroid.lng,d.pievalue=a.usermap[b.usermap].map.geometry[h].pievalue,a.piechart[b.usermap][h]=new oa(b,h,d));else if(d)for(h in a.piechart[b.usermap])a.piechart[b.usermap].hasOwnProperty(h)&&a.piechart[b.usermap][h].remove()};a.setZoomSetting=function(b){for(var d in b.zoom_setting)b.zoom_setting.hasOwnProperty(d)&&(a.usermap[b.usermap].map.zoom_setting[d]=b.zoom_setting[d]);a.panhome[b.usermap].style.visibility="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.homeControl?
a.usermap[b.usermap].map.zoom_setting.homeControl?"visible":"hidden":"visible";a.zoomin[b.usermap].style.visibility="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.zoomControl?a.usermap[b.usermap].map.zoom_setting.zoomControl?"visible":"hidden":"visible";a.zoomout[b.usermap].style.visibility="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.zoomControl?a.usermap[b.usermap].map.zoom_setting.zoomControl?"visible":"hidden":"visible"};a.setMarkers=function(b){for(var d in b.marker)b.marker.hasOwnProperty(d)&&
(a.usermap[b.usermap].map.marker[d]=b.marker[d],"undefined"!==typeof a.marker[b.usermap][d]&&null!==a.marker[b.usermap][d]?(a.marker[b.usermap][d].setOptions(b.marker[d]),a.marker[b.usermap][d].drawMarker()):a.marker[b.usermap][d]=new pa(b,d,b.marker[d]),a.marker[b.usermap][d].toggleCategory())};a.delMarkers=function(b){a.marker[b.usermap][b.id].remove()};a.setMapLabels=function(b){for(var d in b.maplabel)b.maplabel.hasOwnProperty(d)&&(a.usermap[b.usermap].map.maplabel[d]=b.maplabel[d],"undefined"!==
typeof a.maplabel[b.usermap][d]&&null!==a.maplabel[b.usermap][d]?(a.maplabel[b.usermap][d].setOptions(b.maplabel[d]),a.maplabel[b.usermap][d].drawMapLabel()):a.maplabel[b.usermap][d]=new qa(b,d,b.maplabel[d]),a.maplabel[b.usermap][d].toggleCategory())};a.delMapLabels=function(b){a.maplabel[b.usermap][b.id].remove()};a.setMapPaths=function(b){for(var d in b.mappath)b.mappath.hasOwnProperty(d)&&(a.usermap[b.usermap].map.mappath[d]=b.mappath[d],"undefined"!==typeof a.mappath[b.usermap][d]&&null!==a.mappath[b.usermap][d]?
(a.mappath[b.usermap][d].setOptions(b.mappath[d]),a.mappath[b.usermap][d].drawMapPath()):a.mappath[b.usermap][d]=new aa(b,d,b.mappath[d]),a.mappath[b.usermap][d].toggleCategory())};a.delMapPaths=function(b){a.selectedVerticesObj[b.usermap]==a.mappath[b.usermap][b.id]&&(a.selectedVerticesObj[b.usermap]=null);a.mappath[b.usermap][b.id].remove()};a.selectMapPaths=function(b){a.mappath[b.usermap][b.id].createVertices()};a.setMapPolys=function(b){for(var d in b.mappoly)b.mappoly.hasOwnProperty(d)&&(a.usermap[b.usermap].map.mappoly[d]=
b.mappoly[d],"undefined"!==typeof a.mappoly[b.usermap][d]&&null!==a.mappoly[b.usermap][d]?(a.mappoly[b.usermap][d].setOptions(b.mappoly[d]),a.mappoly[b.usermap][d].drawMapPoly()):a.mappoly[b.usermap][d]=new ba(b,d,b.mappoly[d]),a.mappoly[b.usermap][d].toggleCategory())};a.delMapPolys=function(b){a.selectedVerticesObj[b.usermap]==a.mappoly[b.usermap][b.id]&&(a.selectedVerticesObj[b.usermap]=null);a.mappoly[b.usermap][b.id].remove()};a.selectMapPolys=function(b){a.mappoly[b.usermap][b.id].createVertices()};
a.setMapRects=function(b){for(var d in b.maprect)b.maprect.hasOwnProperty(d)&&(a.usermap[b.usermap].map.maprect[d]=b.maprect[d],"undefined"!==typeof a.maprect[b.usermap][d]&&null!==a.maprect[b.usermap][d]?(a.maprect[b.usermap][d].setOptions(b.maprect[d]),a.maprect[b.usermap][d].drawMapRect()):a.maprect[b.usermap][d]=new ca(b,d,b.maprect[d]),a.maprect[b.usermap][d].toggleCategory())};a.delMapRects=function(b){a.selectedVerticesObj[b.usermap]==a.maprect[b.usermap][b.id]&&(a.selectedVerticesObj[b.usermap]=
null);a.maprect[b.usermap][b.id].remove()};a.selectMapRects=function(b){a.maprect[b.usermap][b.id].createVertices()};a.setMapCurves=function(b){for(var d in b.mapcurve)b.mapcurve.hasOwnProperty(d)&&(a.usermap[b.usermap].map.mapcurve[d]=b.mapcurve[d],"undefined"!==typeof a.mapcurve[b.usermap][d]&&null!==a.mapcurve[b.usermap][d]?(a.mapcurve[b.usermap][d].setOptions(b.mapcurve[d]),a.mapcurve[b.usermap][d].drawMapCurve()):a.mapcurve[b.usermap][d]=new da(b,d,b.mapcurve[d]),a.mapcurve[b.usermap][d].toggleCategory())};
a.delMapCurves=function(b){a.selectedVerticesObj[b.usermap]==a.mapcurve[b.usermap][b.id]&&(a.selectedVerticesObj[b.usermap]=null);a.mapcurve[b.usermap][b.id].remove()};a.selectMapCurves=function(b){a.mapcurve[b.usermap][b.id].createVertices()};a.setMapLegends=function(b){for(var d in b.maplegend)b.maplegend.hasOwnProperty(d)&&(a.usermap[b.usermap].map.maplegend[d]=b.maplegend[d],"undefined"!==typeof a.maplegend[b.usermap][d]&&null!==a.maplegend[b.usermap][d]?(a.maplegend[b.usermap][d].setOptions(b.maplegend[d]),
a.maplegend[b.usermap][d].drawMapLegend()):a.maplegend[b.usermap][d]=new ra(b,d,b.maplegend[d]),a.maplegend[b.usermap][d].toggleCategory())};a.delMapLegends=function(b){a.maplegend[b.usermap][b.id].remove()};a.initUserMap=function(b){a.usermap[b.id]=b};a.initMap=function(b){a.map[b.id]=b};a.init=function(b){b.base||(b.base="");if(b.usermap&&(a.touchdevices="ontouchstart"in document.documentElement&&null==navigator.userAgent.match(/Windows NT/i),a.mode[b.usermap]="normal",a.geometry[b.usermap]=[],
a.selected[b.usermap]=[],a.infobox[b.usermap]=[],a.coords[b.usermap]=[],a.selectedOverlay[b.usermap]=null,a.selectedVerticesObj[b.usermap]=null,a.marker[b.usermap]=[],a.maplabel[b.usermap]=[],a.mappath[b.usermap]=[],a.mappoly[b.usermap]=[],a.maprect[b.usermap]=[],a.mapcurve[b.usermap]=[],a.maplegend[b.usermap]=[],a.mapabbr[b.usermap]=[],a.geoareasize[b.usermap]=[],a.mapbubble[b.usermap]=[],a.mapbubblesize[b.usermap]=[],a.piechart[b.usermap]=[],a.path[b.usermap]=[],a.poly[b.usermap]=[],a.rect[b.usermap]=
[],a.curve[b.usermap]=[],a.groupHL[b.usermap]=[],a.grouphighlight[b.usermap]={},a.fadeout[b.usermap]={},a.heatmap[b.usermap]={},a.categorylegend[b.usermap]={},a.maptitle[b.usermap]={},a.base[b.usermap]=b.base,a.factor[b.usermap]=1,document.writeln("\x3c!--[if lt IE 9]>"),document.writeln("<div>You can only view this map using Internet Explorer 9 or above, please upgrade or use other modern browsers like chrome, firefox or safari</div>"),document.writeln("<![endif]--\x3e"),document.writeln('<div id="imap5_'+
b.usermap+'"></div>'),a.div[b.usermap]=document.getElementById("imap5_"+b.usermap),b.local)){a.local=!0;var d=document.createElement("script");d.type="application/javascript";d.src=b.base+"imap5usermap_"+b.usermap+".js?"+Math.random(1E5);d.onerror=function(){};d.onload=function(){za(b)};document.body.appendChild(d)}};a.updateCategoryLegend=function(a){S(a)};var H=function(a,d,h,f,g){var c=180*Math.atan((f-d)/(h-a))/Math.PI;0!=c?0<c?f>d?(a=180-c,c=360-c):(a=360-c,c=180-c):f>d?(a=360-c,c=180-c):(a=
180-c,c=360-c):h>a?(a=180,c=0):(a=0,c=180);0==g&&(result=a);1==g&&(result=c);return result},V=function(a,d,h,f){var g,c,e,n;g=2*Math.PI/3;f=f/180*Math.PI;a-=Math.cos(f)*(h/2);d+=Math.sin(f)*(h/2);var t;t=""+(a+Math.cos(f)*h)+","+(d-Math.sin(f)*h);for(c=1;3>=c;c++)e=a+Math.cos(f+g*c)*h,n=d-Math.sin(f+g*c)*h,t=t+" "+e+","+n;return t},W=function(a,d,h,f){var g,c,e,n;g=2*Math.PI/3;f=f/180*Math.PI;a-=Math.cos(f)*(h/2);d+=Math.sin(f)*(h/2);var t;t="M "+(a+Math.cos(f)*h)+","+(d-Math.sin(f)*h);for(c=1;4>=
c;c++)e=a+Math.cos(f+g*c)*h,n=d-Math.sin(f+g*c)*h,t=2>=c?t+" M "+e+","+n:t+" L "+e+","+n;return t},X=function(a,d,h,f){var g,c=(f.x-h.x)*(a.y-h.y)-(f.y-h.y)*(a.x-h.x);g=(d.x-a.x)*(a.y-h.y)-(d.y-a.y)*(a.x-h.x);a=(f.y-h.y)*(d.x-a.x)-(f.x-h.x)*(d.y-a.y);0!=a?(c/=a,g/=a,g=0<=c&&1>=c&&0<=g&&1>=g?!0:!1):g=!1;return g},Aa=function(a,d,h,f){return Y({x:a.x,y:a.y},{x:a.x,y:d.y},h,f)||Y({x:a.x,y:d.y},{x:d.x,y:d.y},h,f)||Y({x:d.x,y:d.y},{x:d.x,y:a.y},h,f)||Y({x:d.x,y:a.y},{x:a.x,y:a.y},h,f)?!0:!1},Y=function(a,
d,h,f){return X({x:h.x,y:h.y},{x:h.x,y:f.y},a,d)||X({x:h.x,y:f.y},{x:f.x,y:f.y},a,d)||X({x:f.x,y:f.y},{x:f.x,y:h.y},a,d)||X({x:f.x,y:h.y},{x:h.x,y:h.y},a,d)?!0:!1},Ba=function(b){var d=0,h=0,f=0;if(3<b.length){for(var g=0;g<b.length-1;g++)b.hasOwnProperty(g)&&(f+=(b[g].lng+b[g+1].lng)*(b[g].lng*u(b[g+1].lat)-b[g+1].lng*u(b[g].lat)),h+=(u(b[g].lat)+u(b[g+1].lat))*(b[g].lng*u(b[g+1].lat)-b[g+1].lng*u(b[g].lat)),d=d+b[g].lng*u(b[g+1].lat)-b[g+1].lng*u(b[g].lat));d/=2;h=k(O(h/(6*d)),a.precision);f=k(f/
(6*d),a.precision)}else h=k(b[0].lat,a.precision),f=k(b[0].lng,a.precision);return{lat:h,lng:f}},z=function(a){89.5<a&&(a=89.5);-89.5>a&&(a=-89.5);return a},E=function(a){180<a&&(a=-180+(a-180)%360);-180>a&&(a=180+(a+180)%360);return a},P=function(a,d){return 89.5<a||-89.5>a||180<d||-180>d},Ca=function(a,d){var h=Math.max(Math.abs(a/32768),Math.abs(d/32768));return h=1<h?2*Math.round(h):1},v=function(b,d,h){var f;document.getElementById("imap5_"+b.usermap+"_hint")?f=document.getElementById("imap5_"+
b.usermap+"_hint"):(f=document.createElement("div"),f.id="imap5_"+b.usermap+"_hint",a.div[b.usermap].appendChild(f));f.style.backgroundColor="#FFFF88";f.style.pointerEvents="none";f.style.position="fixed";f.style.padding="2px";f.style.margin="5px";f.style.border="1px solid gray";f.style.borderRadius="5px";f.style.top=d.clientY+10+"px";f.style.left=d.clientX+10+"px";f.style.font="12px Arial";f.style.display="block";f.innerHTML=h},G=function(a){divhint=document.getElementById("imap5_"+a.usermap+"_hint");
divhint.style.display="none"},I=function(a){return parseInt(ea(a).substring(0,2),16)},J=function(a){return parseInt(ea(a).substring(2,4),16)},K=function(a){return parseInt(ea(a).substring(4,6),16)},ea=function(a){return"#"==a.charAt(0)?a.substring(1,7):a},Q=function(a,d){for(var h=parseInt(a).toString(16),f=d-h.length,g=0;g<f;g++)h="0"+h;return h},fa=function(a,d,h){var f,g,c;f=I(a);g=J(a);c=K(a);var e;a=I(d);e=J(d);d=K(d);g+=(e-g)*h/100;c+=(d-c)*h/100;return"#"+Q(f+(a-f)*h/100,2)+Q(g,2)+Q(c,2)},
ga=function(a,d,h){var f,g=d.length;if(a<d[0])f=h[0];else if(a>=d[g-1])f=h[g];else for(var c=0;c<g-1;c++)if(a>=d[c]&&a<d[c+1]){f=h[c+1];break}return f},sa=function(b){var d=0,h=0,f;for(f in a.usermap[b.usermap].map.geometry)!a.usermap[b.usermap].map.geometry.hasOwnProperty(f)||"undefined"!=typeof a.usermap[b.usermap].map.geometry[f].disableHeatMap&&a.usermap[b.usermap].map.geometry[f].disableHeatMap||(a.usermap[b.usermap].map.geometry[f].heatvalue<d&&(d=a.usermap[b.usermap].map.geometry[f].heatvalue),
a.usermap[b.usermap].map.geometry[f].heatvalue>h&&(h=a.usermap[b.usermap].map.geometry[f].heatvalue));return{hmin:d,hmax:h}},ha=function(a,d,h){return d==a?0:(h+Math.abs(a))/(d-a)*100},F=function(b,d){return _result=a.heatmap[b.usermap].enable?"undefined"!=typeof a.usermap[b.usermap].map.geometry[d].disableHeatMap&&a.usermap[b.usermap].map.geometry[d].disableHeatMap?a.usermap[b.usermap].map.geometry[d].fill:"continuous"==a.usermap[b.usermap].map.heatmap.heattype?fa(a.usermap[b.usermap].map.heatmap.continuous.startcolor,
a.usermap[b.usermap].map.heatmap.continuous.endcolor,ha(a.heatmap[b.usermap].hmin,a.heatmap[b.usermap].hmax,a.usermap[b.usermap].map.geometry[d].heatvalue)):ga(a.usermap[b.usermap].map.geometry[d].heatvalue,a.usermap[b.usermap].map.heatmap.discrete.rangeset.split(","),a.usermap[b.usermap].map.heatmap.discrete.colorset.split(",")):a.usermap[b.usermap].map.geometry[d].fill},R=function(b,d){return _result=a.heatmap[b.usermap].enable?"undefined"!=typeof a.usermap[b.usermap].map.geometry[d].disableHeatMap&&
a.usermap[b.usermap].map.geometry[d].disableHeatMap?a.usermap[b.usermap].map.geometry[d].fill_mouseover:"continuous"==a.usermap[b.usermap].map.heatmap.heattype?a.usermap[b.usermap].map.heatmap.continuous.highlightcolor:a.usermap[b.usermap].map.heatmap.discrete.highlightcolor:a.usermap[b.usermap].map.geometry[d].fill_mouseover},k=function(a,d){var h=Math.pow(10,d);return Math.round(a*h)/h},ta=function(a,d){var h=d.x-a.x,f=d.y-a.y;return Math.sqrt(h*h+f*f)},L=function(a,d){for(var h=d*Math.pow(1/1.5,
4),f=-1,g=1;20>g;g++)if(0.1>Math.abs(a-h*Math.pow(1.5,g))){f=g+1;break}return f},ka=function(b){a.groupHL[b.usermap]=[];for(var d in a.geometry[b.usermap])a.geometry[b.usermap].hasOwnProperty(d)&&(a.geometry[b.usermap][d].group={},a.geometry[b.usermap][d].group.id="undefined"==typeof a.usermap[b.usermap].map.geometry[d].group?0:a.usermap[b.usermap].map.geometry[d].group,"undefined"==typeof a.groupHL[b.usermap][a.geometry[b.usermap][d].group.id]&&(a.groupHL[b.usermap][a.geometry[b.usermap][d].group.id]=
[]),a.groupHL[b.usermap][a.geometry[b.usermap][d].group.id].push(d))},$=function(b){if(a.heatmap[b.usermap].enable)if("continuous"==a.usermap[b.usermap].map.heatmap.heattype){var d={},d=sa(b);a.heatmap[b.usermap].hmin=d.hmin;a.heatmap[b.usermap].hmax=d.hmax}else{var d=a.usermap[b.usermap].map.heatmap.discrete.rangeset.split(",").length,h=a.usermap[b.usermap].map.heatmap.discrete.colorset.split(",").length;0<d&&0<h&&h==d+1||(a.heatmap[b.usermap].enable=!1)}},S=function(b){for(var d in a.usermap[b.usermap].map.mappoly)a.usermap[b.usermap].map.mappoly.hasOwnProperty(d)&&
a.mappoly[b.usermap].hasOwnProperty(d)&&a.mappoly[b.usermap][d].toggleCategory();for(d in a.usermap[b.usermap].map.maprect)a.usermap[b.usermap].map.maprect.hasOwnProperty(d)&&a.maprect[b.usermap].hasOwnProperty(d)&&a.maprect[b.usermap][d].toggleCategory();for(d in a.usermap[b.usermap].map.mappath)a.usermap[b.usermap].map.mappath.hasOwnProperty(d)&&a.mappath[b.usermap].hasOwnProperty(d)&&a.mappath[b.usermap][d].toggleCategory();for(d in a.usermap[b.usermap].map.mapcurve)a.usermap[b.usermap].map.mapcurve.hasOwnProperty(d)&&
a.mapcurve[b.usermap].hasOwnProperty(d)&&a.mapcurve[b.usermap][d].toggleCategory();for(d in a.usermap[b.usermap].map.maplabel)a.usermap[b.usermap].map.maplabel.hasOwnProperty(d)&&a.maplabel[b.usermap].hasOwnProperty(d)&&a.maplabel[b.usermap][d].toggleCategory();for(d in a.usermap[b.usermap].map.marker)a.usermap[b.usermap].map.marker.hasOwnProperty(d)&&a.marker[b.usermap].hasOwnProperty(d)&&a.marker[b.usermap][d].toggleCategory();for(d in a.usermap[b.usermap].map.maplegend)a.usermap[b.usermap].map.maplegend.hasOwnProperty(d)&&
a.maplegend[b.usermap].hasOwnProperty(d)&&a.maplegend[b.usermap][d].toggleCategory()},U=function(b){"undefined"!=typeof a.usermap[b.usermap].map.geometry[b.geometry]&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[b.geometry].fill&&(a.heatmap[b.usermap].enable?"undefined"!=typeof a.usermap[b.usermap].map.geometry[b.geometry].disableHeatMap&&a.usermap[b.usermap].map.geometry[b.geometry].disableHeatMap?a.geometry[b.usermap].hasOwnProperty(b.geometry)&&a.geometry[b.usermap][b.geometry].setAttribute("fill",
a.usermap[b.usermap].map.geometry[b.geometry].fill):"continuous"==a.usermap[b.usermap].map.heatmap.heattype?a.geometry[b.usermap].hasOwnProperty(b.geometry)&&a.geometry[b.usermap][b.geometry].setAttribute("fill",fa(a.usermap[b.usermap].map.heatmap.continuous.startcolor,a.usermap[b.usermap].map.heatmap.continuous.endcolor,ha(a.heatmap[b.usermap].hmin,a.heatmap[b.usermap].hmax,a.usermap[b.usermap].map.geometry[b.geometry].heatvalue))):a.geometry[b.usermap].hasOwnProperty(b.geometry)&&a.geometry[b.usermap][b.geometry].setAttribute("fill",
ga(a.usermap[b.usermap].map.geometry[b.geometry].heatvalue,a.usermap[b.usermap].map.heatmap.discrete.rangeset.split(","),a.usermap[b.usermap].map.heatmap.discrete.colorset.split(","))):a.geometry[b.usermap].hasOwnProperty(b.geometry)&&a.geometry[b.usermap][b.geometry].setAttribute("fill",a.usermap[b.usermap].map.geometry[b.geometry].fill))},q=function(a){return document.createElementNS("http://www.w3.org/2000/svg",a)},ja=function(b){if("edit"==a.mode[b.usermap])for(var d in a.geometry[b.usermap])a.geometry[b.usermap].hasOwnProperty(d)&&
(a.geometry[b.usermap][d].style.cursor="pointer");else for(d in a.geometry[b.usermap])if(a.geometry[b.usermap].hasOwnProperty(d)){var h=a.geometry[b.usermap][d].id;a.geometry[b.usermap][d].style.cursor="undefined"!=typeof a.usermap[b.usermap].map.geometry[h]&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[h].link?"pointer":"auto"}},za=function(b){var d=a.usermap[b.usermap].map.id,h=a.usermap[b.usermap].map.lat,f=a.usermap[b.usermap].map.lng,g=a.usermap[b.usermap].map.zoom;a.zoom[b.usermap]=
{};a.zoom[b.usermap].initzoom="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.init?k(a.usermap[b.usermap].map.zoom_setting.init.zoom,a.precision):k(g,a.precision);a.zoom[b.usermap].initlat="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.init?k(a.usermap[b.usermap].map.zoom_setting.init.lat,a.precision):k(h,a.precision);a.zoom[b.usermap].initlng="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.init?k(a.usermap[b.usermap].map.zoom_setting.init.lng,a.precision):k(f,a.precision);
"undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.editing?(a.zoom[b.usermap].loadeditingsetting=!0,a.zoom[b.usermap].currentzoom=k(a.usermap[b.usermap].map.zoom_setting.editing.zoom,a.precision),a.zoom[b.usermap].currentx=k(a.usermap[b.usermap].map.zoom_setting.editing.x,a.precision),a.zoom[b.usermap].currenty=k(a.usermap[b.usermap].map.zoom_setting.editing.y,a.precision)):(a.zoom[b.usermap].loadeditingsetting=!1,a.zoom[b.usermap].currentzoom=k(g,a.precision),a.zoom[b.usermap].currentlat=
k(h,a.precision),a.zoom[b.usermap].currentlng=k(f,a.precision));a.zoom[b.usermap].currentzoomlevel=L(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom);a.div[b.usermap].style.width=a.usermap[b.usermap].div.style.width;a.div[b.usermap].style.height=a.usermap[b.usermap].div.style.height;a.div[b.usermap].style.position="relative";if(!a.touchdevices&&(a.div[b.usermap].onmousemove=function(c){if(null!=a.selectedOverlay[b.usermap])a.selectedOverlay[b.usermap].onmousemove(c);"marker"==a.mode[b.usermap]&&
(this.style.cursor="pointer",v(b,c,"Click to add a marker"));"maplabel"==a.mode[b.usermap]&&(this.style.cursor="pointer",v(b,c,"Click to add a map label"));if("mappath"==a.mode[b.usermap])if("undefined"!=typeof a.path[b.usermap][1]&&null!==a.path[b.usermap][1]){if("undefined"!=typeof a.coords[b.usermap]&&0<a.coords[b.usermap].length){this.style.cursor="pointer";v(b,c,"Right Click to end a map path");var e=a.svgcoord[b.usermap];e.x=c.clientX;e.y=c.clientY;e=y(e,a.g[b.usermap]);e.x/=a.map[d].precision/
a.factor[b.usermap];e.y/=a.map[d].precision/a.factor[b.usermap];var f=e.x,e=360*(Math.atan(Math.pow(Math.E,e.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI,e=z(e),f=E(f);a.path[b.usermap][1]._movingpoints=e+","+f;a.path[b.usermap][1].drawMapPath()}}else this.style.cursor="pointer",v(b,c,"Click to start a map path");"mappoly"==a.mode[b.usermap]&&("undefined"!=typeof a.poly[b.usermap][1]&&null!==a.poly[b.usermap][1]?"undefined"!=typeof a.coords[b.usermap]&&0<a.coords[b.usermap].length&&(this.style.cursor=
"pointer",1<a.coords[b.usermap].length&&v(b,c,"Right Click to end a polygon"),e=a.svgcoord[b.usermap],e.x=c.clientX,e.y=c.clientY,e=y(e,a.g[b.usermap]),e.x/=a.map[d].precision/a.factor[b.usermap],e.y/=a.map[d].precision/a.factor[b.usermap],f=e.x,e=360*(Math.atan(Math.pow(Math.E,e.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI,e=z(e),f=E(f),a.poly[b.usermap][1]._movingpoints=e+","+f,a.poly[b.usermap][1].drawMapPoly()):(this.style.cursor="pointer",v(b,c,"Click to start a polygon")));"maprect"==
a.mode[b.usermap]&&("undefined"!=typeof a.rect[b.usermap][1]&&null!==a.rect[b.usermap][1]?"undefined"!=typeof a.coords[b.usermap]&&1==a.coords[b.usermap].length&&(this.style.cursor="pointer",v(b,c,"Right Click to end a rectangle"),e=a.svgcoord[b.usermap],e.x=c.clientX,e.y=c.clientY,e=y(e,a.g[b.usermap]),e.x/=a.map[d].precision/a.factor[b.usermap],e.y/=a.map[d].precision/a.factor[b.usermap],f=e.x,e=360*(Math.atan(Math.pow(Math.E,e.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI,e=z(e),f=E(f),
a.rect[b.usermap][1]._movingpoints=e+","+f,a.rect[b.usermap][1].drawMapRect()):(this.style.cursor="pointer",v(b,c,"Click to start a rectangle")));"mapcurve"==a.mode[b.usermap]&&("undefined"!=typeof a.curve[b.usermap][1]&&null!==a.curve[b.usermap][1]?"undefined"!=typeof a.coords[b.usermap]&&0<a.coords[b.usermap].length&&(this.style.cursor="pointer",1<a.coords[b.usermap].length?v(b,c,"Right Click to confirm the curvature"):v(b,c,"Click to define the end point of a curve"),e=a.svgcoord[b.usermap],e.x=
c.clientX,e.y=c.clientY,e=y(e,a.g[b.usermap]),e.x/=a.map[d].precision/a.factor[b.usermap],e.y/=a.map[d].precision/a.factor[b.usermap],f=e.x,e=360*(Math.atan(Math.pow(Math.E,e.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI,e=z(e),f=E(f),a.curve[b.usermap][1]._movingpoints=e+","+f,a.curve[b.usermap][1].drawMapCurve()):(this.style.cursor="pointer",v(b,c,"Click to define the starting point of a curve")));c.preventDefault&&c.preventDefault();a.usermap[b.usermap].map.zoom_setting.draggable&&this._mousedown&&
(10<Math.abs(c.pageX-this._mousepositionx)||10<Math.abs(c.pageY-this._mousepositiony))&&(this._mapdragged=!0,f=(this._mousepositionx-c.pageX)/a.zoom[b.usermap].currentzoom,e=(this._mousepositiony-c.pageY)/a.zoom[b.usermap].currentzoom,this._mousepositionx=c.pageX,this._mousepositiony=c.pageY,a.zoom[b.usermap].currentx=k(a.zoom[b.usermap].currentx+f,a.precision),a.zoom[b.usermap].currenty=k(a.zoom[b.usermap].currenty-e,a.precision),C(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx))},
a.div[b.usermap].onmousedown=function(a){a.preventDefault&&a.preventDefault();this._mousepositionx=a.pageX;this._mousepositiony=a.pageY;this._mousedown=!0;this._mapdragged=!1},a.div[b.usermap].onmouseup=function(a){a.preventDefault&&a.preventDefault();this._mousedown=!1;this._mousepositiony=this._mousepositionx=0},a.div[b.usermap].onmousewheel=function(c){c.preventDefault&&c.preventDefault();if(a.usermap[b.usermap].map.zoom_setting.mouseWheel){a.zoom[b.usermap].prevzoom=a.zoom[b.usermap].currentzoom;
var e=a.zoom[b.usermap].currentzoom;c||(c=window.event);var f=L(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom);c.wheelDelta&&(0<c.wheelDelta?20>f&&(a.zoom[b.usermap].currentzoom=k(1.5*a.zoom[b.usermap].currentzoom,a.precision)):1<f&&(a.zoom[b.usermap].currentzoom=k(a.zoom[b.usermap].currentzoom/1.5,a.precision)));var g=a.svgcoord[b.usermap];g.x=c.clientX;g.y=c.clientY;for(var g=y(g,a.g[b.usermap]),h=this,r=0,l=0;h;)r+=h.offsetLeft,l+=h.offsetTop,h=h.offsetParent;g.x/=a.map[d].precision/
a.factor[b.usermap];g.y/=a.map[d].precision/a.factor[b.usermap];h=g.x;g=360*(Math.atan(Math.pow(Math.E,g.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI;P(g,h)?a.zoom[b.usermap].currentzoom=k(e,a.precision):0<c.wheelDelta?20>f&&(a.zoom[b.usermap].currentx=k(a.zoom[b.usermap].currentx-(parseFloat(this.style.width)/2-(c.pageX-r))/a.zoom[b.usermap].currentzoom*0.5,a.precision),a.zoom[b.usermap].currenty=k(a.zoom[b.usermap].currenty+(parseFloat(this.style.height)/2-(c.pageY-l))/a.zoom[b.usermap].currentzoom*
0.5,a.precision),C(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx)):1<f&&(a.zoom[b.usermap].currentx=k(a.zoom[b.usermap].currentx+(parseFloat(this.style.width)/2-(c.pageX-r))/a.zoom[b.usermap].currentzoom*(1-1/1.5),a.precision),a.zoom[b.usermap].currenty=k(a.zoom[b.usermap].currenty-(parseFloat(this.style.height)/2-(c.pageY-l))/a.zoom[b.usermap].currentzoom*(1-1/1.5),a.precision),C(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx))}},
a.div[b.usermap].addEventListener)){a.setMouseWheelEvent=function(a){c(a)};var c=function(c){c.preventDefault&&c.preventDefault();if(a.usermap[b.usermap].map.zoom_setting.mouseWheel){a.zoom[b.usermap].prevzoom=a.zoom[b.usermap].currentzoom;var e=a.zoom[b.usermap].currentzoom;c||(c=window.event);var f=L(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom);c.detail&&(0>c.detail?20>f&&(a.zoom[b.usermap].currentzoom=k(1.5*a.zoom[b.usermap].currentzoom,a.precision)):1<f&&(a.zoom[b.usermap].currentzoom=
k(a.zoom[b.usermap].currentzoom/1.5,a.precision)));var g=a.svgcoord[b.usermap];g.x=c.pageX;g.y=c.pageY;for(var g=y(g,a.g[b.usermap]),h=this,r=0,l=0;h;)r+=h.offsetLeft,l+=h.offsetTop,h=h.offsetParent;g.x/=a.map[d].precision/a.factor[b.usermap];g.y/=a.map[d].precision/a.factor[b.usermap];h=g.x;g=360*(Math.atan(Math.pow(Math.E,g.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI;P(g,h)?a.zoom[b.usermap].currentzoom=k(e,a.precision):0>c.detail?20>f&&(a.zoom[b.usermap].currentx=k(a.zoom[b.usermap].currentx-
(parseInt(this.style.width)/2-(c.pageX-r))/a.zoom[b.usermap].currentzoom*0.5,a.precision),a.zoom[b.usermap].currenty=k(a.zoom[b.usermap].currenty+(parseInt(this.style.height)/2-(c.pageY-l))/a.zoom[b.usermap].currentzoom*0.5,a.precision),C(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx)):1<f&&(a.zoom[b.usermap].currentx=k(a.zoom[b.usermap].currentx+(parseInt(this.style.width)/2-(c.pageX-r))/a.zoom[b.usermap].currentzoom*(1-1/1.5),a.precision),a.zoom[b.usermap].currenty=
k(a.zoom[b.usermap].currenty-(parseInt(this.style.height)/2-(c.pageY-l))/a.zoom[b.usermap].currentzoom*(1-1/1.5),a.precision),C(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx))}};a.div[b.usermap].addEventListener("DOMMouseScroll",c,!1)}a.touchdevices||(a.div[b.usermap].oncontextmenu=function(c){if("mappath"==a.mode[b.usermap]){if(0<a.coords[b.usermap].length){var e=a.svgcoord[b.usermap];e.x=c.clientX;e.y=c.clientY;e=y(e,a.g[b.usermap]);e.x/=a.map[d].precision/
a.factor[b.usermap];e.y/=a.map[d].precision/a.factor[b.usermap];c=e.x;e=360*(Math.atan(Math.pow(Math.E,e.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI;e=z(e);c=E(c);a.coords[b.usermap].push(k(e,a.precision)+","+k(c,a.precision));a.path[b.usermap][1]._movingpoints="";a.path[b.usermap][1].drawMapPath();c="";for(e=0;e<a.coords[b.usermap].length;e++)""!=c&&(c+=" "),c+=a.coords[b.usermap][e];var e=0,f;for(f in a.mappath[b.usermap])a.mappath[b.usermap].hasOwnProperty(f)&&"undefined"!==typeof a.mappath[b.usermap][f]&&
null!==a.mappath[b.usermap][f]&&a.mappath[b.usermap][f]._id>e&&(e=Number(a.mappath[b.usermap][f]._id));f={event:"newmappath",object:"mappath"};f.points=c;f.id=e+1;window.console&&console.log(JSON.stringify(f));a.coords[b.usermap].length=0;a.g[b.usermap].removeChild(a.path[b.usermap][1]);a.path[b.usermap][1]=null}return!1}if("mappoly"==a.mode[b.usermap]){if(1<a.coords[b.usermap].length){e=a.svgcoord[b.usermap];e.x=c.clientX;e.y=c.clientY;e=y(e,a.g[b.usermap]);e.x/=a.map[d].precision/a.factor[b.usermap];
e.y/=a.map[d].precision/a.factor[b.usermap];c=e.x;e=360*(Math.atan(Math.pow(Math.E,e.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI;e=z(e);c=E(c);a.coords[b.usermap].push(k(e,a.precision)+","+k(c,a.precision));a.poly[b.usermap][1]._movingpoints="";a.poly[b.usermap][1].drawMapPoly();c="";for(e=0;e<a.coords[b.usermap].length;e++)""!=c&&(c+=" "),c+=a.coords[b.usermap][e];e=0;for(f in a.mappoly[b.usermap])a.mappoly[b.usermap].hasOwnProperty(f)&&"undefined"!==typeof a.mappoly[b.usermap][f]&&null!==
a.mappoly[b.usermap][f]&&a.mappoly[b.usermap][f]._id>e&&(e=Number(a.mappoly[b.usermap][f]._id));e+=1;f={event:"newmappoly",object:"mappoly"};f.points=c;f.id=e;window.console&&console.log(JSON.stringify(f));a.coords[b.usermap].length=0;a.g[b.usermap].removeChild(a.poly[b.usermap][1]);a.poly[b.usermap][1]=null}return!1}if("maprect"==a.mode[b.usermap]){if(1==a.coords[b.usermap].length){e=a.svgcoord[b.usermap];e.x=c.clientX;e.y=c.clientY;e=y(e,a.g[b.usermap]);e.x/=a.map[d].precision/a.factor[b.usermap];
e.y/=a.map[d].precision/a.factor[b.usermap];c=e.x;e=360*(Math.atan(Math.pow(Math.E,e.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI;e=z(e);c=E(c);var g=a.coords[b.usermap][0].split(",")[0],h=a.coords[b.usermap][0].split(",")[1];a.coords[b.usermap].push(k(g,a.precision)+","+k(c,a.precision));a.coords[b.usermap].push(k(e,a.precision)+","+k(c,a.precision));a.coords[b.usermap].push(k(e,a.precision)+","+k(h,a.precision));a.rect[b.usermap][1]._movingpoints="";a.rect[b.usermap][1].drawMapRect();
c="";for(e=0;e<a.coords[b.usermap].length;e++)""!=c&&(c+=" "),c+=a.coords[b.usermap][e];e=0;for(f in a.maprect[b.usermap])a.maprect[b.usermap].hasOwnProperty(f)&&"undefined"!==typeof a.maprect[b.usermap][f]&&null!==a.maprect[b.usermap][f]&&a.maprect[b.usermap][f]._id>e&&(e=Number(a.maprect[b.usermap][f]._id));e+=1;f={event:"newmaprect",object:"maprect"};f.points=c;f.id=e;window.console&&console.log(JSON.stringify(f));a.coords[b.usermap].length=0;a.g[b.usermap].removeChild(a.rect[b.usermap][1]);a.rect[b.usermap][1]=
null}return!1}if("mapcurve"==a.mode[b.usermap]){if(1<a.coords[b.usermap].length){e=a.svgcoord[b.usermap];e.x=c.clientX;e.y=c.clientY;e=y(e,a.g[b.usermap]);e.x/=a.map[d].precision/a.factor[b.usermap];e.y/=a.map[d].precision/a.factor[b.usermap];c=e.x;e=360*(Math.atan(Math.pow(Math.E,e.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI;e=z(e);c=E(c);a.coords[b.usermap].push(k(e,a.precision)+","+k(c,a.precision));a.curve[b.usermap][1]._movingpoints="";a.curve[b.usermap][1].drawMapCurve();c="";for(e=
0;e<a.coords[b.usermap].length;e++)""!=c&&(c+=" "),c+=a.coords[b.usermap][e];e=0;for(f in a.mapcurve[b.usermap])a.mapcurve[b.usermap].hasOwnProperty(f)&&"undefined"!==typeof a.mapcurve[b.usermap][f]&&null!==a.mapcurve[b.usermap][f]&&a.mapcurve[b.usermap][f]._id>e&&(e=Number(a.mapcurve[b.usermap][f]._id));e+=1;f={event:"newmapcurve",object:"mapcurve"};f.points=c;f.id=e;window.console&&console.log(JSON.stringify(f));a.coords[b.usermap].length=0;a.g[b.usermap].removeChild(a.curve[b.usermap][1]);a.curve[b.usermap][1]=
null}return!1}},a.div[b.usermap].onclick=function(c){if(!this._mapdragged&&!this._transformed&&"normal"!=a.mode[b.usermap]&&"edit"!=a.mode[b.usermap]){if("marker"==a.mode[b.usermap]){var e=a.svgcoord[b.usermap];e.x=c.clientX;e.y=c.clientY;e=y(e,a.g[b.usermap]);e.x/=a.map[d].precision/a.factor[b.usermap];e.y/=a.map[d].precision/a.factor[b.usermap];var f=e.x,e=360*(Math.atan(Math.pow(Math.E,e.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI,e=z(e),f=E(f),g=0,h;for(h in a.marker[b.usermap])a.marker[b.usermap].hasOwnProperty(h)&&
"undefined"!==typeof a.marker[b.usermap][h]&&null!==a.marker[b.usermap][h]&&a.marker[b.usermap][h]._id>g&&(g=Number(a.marker[b.usermap][h]._id));var g=g+1,r={event:"newmarker",object:"marker"};r.lat=k(e,a.precision);r.lng=k(f,a.precision);r.id=g;window.console&&console.log(JSON.stringify(r))}if("maplabel"==a.mode[b.usermap]){e=a.svgcoord[b.usermap];e.x=c.clientX;e.y=c.clientY;e=y(e,a.g[b.usermap]);e.x/=a.map[d].precision/a.factor[b.usermap];e.y/=a.map[d].precision/a.factor[b.usermap];f=e.x;e=360*
(Math.atan(Math.pow(Math.E,e.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI;e=z(e);f=E(f);g=0;for(h in a.maplabel[b.usermap])a.maplabel[b.usermap].hasOwnProperty(h)&&"undefined"!==typeof a.maplabel[b.usermap][h]&&null!==a.maplabel[b.usermap][h]&&a.maplabel[b.usermap][h]._id>g&&(g=Number(a.maplabel[b.usermap][h]._id));g+=1;r={event:"newmaplabel",object:"maplabel"};r.lat=k(e,a.precision);r.lng=k(f,a.precision);r.id=g;window.console&&console.log(JSON.stringify(r))}"mappath"==a.mode[b.usermap]&&
(e=a.svgcoord[b.usermap],e.x=c.clientX,e.y=c.clientY,e=y(e,a.g[b.usermap]),e.x/=a.map[d].precision/a.factor[b.usermap],e.y/=a.map[d].precision/a.factor[b.usermap],f=e.x,e=360*(Math.atan(Math.pow(Math.E,e.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI,e=z(e),f=E(f),a.coords[b.usermap].push(k(e,a.precision)+","+k(f,a.precision)),"undefined"!=typeof a.path[b.usermap][1]&&null!==a.path[b.usermap][1]?a.path[b.usermap][1].addPoint(k(e,a.precision),k(f,a.precision)):(ua.points=k(e,a.precision)+
","+k(f,a.precision),a.path[b.usermap][1]=new aa(b,0,ua)),a.path[b.usermap][1].drawMapPath());"mappoly"==a.mode[b.usermap]&&(e=a.svgcoord[b.usermap],e.x=c.clientX,e.y=c.clientY,e=y(e,a.g[b.usermap]),e.x/=a.map[d].precision/a.factor[b.usermap],e.y/=a.map[d].precision/a.factor[b.usermap],f=e.x,e=360*(Math.atan(Math.pow(Math.E,e.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI,e=z(e),f=E(f),a.coords[b.usermap].push(k(e,a.precision)+","+k(f,a.precision)),"undefined"!=typeof a.poly[b.usermap][1]&&
null!==a.poly[b.usermap][1]?a.poly[b.usermap][1].addPoint(k(e,a.precision),k(f,a.precision)):(va.points=k(e,a.precision)+","+k(f,a.precision),a.poly[b.usermap][1]=new ba(b,0,va)),a.poly[b.usermap][1].drawMapPoly());"maprect"==a.mode[b.usermap]&&0==a.coords[b.usermap].length&&(e=a.svgcoord[b.usermap],e.x=c.clientX,e.y=c.clientY,e=y(e,a.g[b.usermap]),e.x/=a.map[d].precision/a.factor[b.usermap],e.y/=a.map[d].precision/a.factor[b.usermap],f=e.x,e=360*(Math.atan(Math.pow(Math.E,e.y.toFixed(a.precision)*
Math.PI/180))-Math.PI/4)/Math.PI,e=z(e),f=E(f),a.coords[b.usermap].push(k(e,a.precision)+","+k(f,a.precision)),wa.points=k(e,a.precision)+","+k(f,a.precision),a.rect[b.usermap][1]=new ca(b,0,wa),a.rect[b.usermap][1]._movingpoints=k(e,a.precision)+","+k(f,a.precision),a.rect[b.usermap][1].drawMapRect());"mapcurve"==a.mode[b.usermap]&&2>a.coords[b.usermap].length&&(e=a.svgcoord[b.usermap],e.x=c.clientX,e.y=c.clientY,e=y(e,a.g[b.usermap]),e.x/=a.map[d].precision/a.factor[b.usermap],e.y/=a.map[d].precision/
a.factor[b.usermap],f=e.x,e=360*(Math.atan(Math.pow(Math.E,e.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI,e=z(e),f=E(f),a.coords[b.usermap].push(k(e,a.precision)+","+k(f,a.precision)),"undefined"!=typeof a.curve[b.usermap][1]&&null!==a.curve[b.usermap][1]?a.curve[b.usermap][1].addPoint(k(e,a.precision),k(f,a.precision)):(xa.points=k(e,a.precision)+","+k(f,a.precision),a.curve[b.usermap][1]=new da(b,0,xa)),a.curve[b.usermap][1].drawMapCurve())}});a.touchdevices&&(a.div[b.usermap].ontouchstart=
function(a){a.preventDefault&&a.preventDefault();this._mousedown=!0;1==a.touches.length?(this._mousepositionx=a.touches[0].pageX,this._mousepositiony=a.touches[0].pageY,this._mapdragged=!1):2==a.touches.length&&(this._transformed=!0,this._pos={},this._pos.start=[],this._pos.start[0]={},this._pos.start[1]={},this._pos.start[0].x=a.touches[0].pageX,this._pos.start[0].y=a.touches[0].pageY,this._pos.start[1].x=a.touches[1].pageX,this._pos.start[1].y=a.touches[1].pageY)});a.touchdevices&&(a.div[b.usermap].ontouchmove=
function(c){var e;c.preventDefault&&c.preventDefault();if(!this._mousedown)return!1;if(1==c.touches.length){if(a.usermap[b.usermap].map.zoom_setting.draggable&&!this._transformed&&(10<Math.abs(c.touches[0].pageX-this._mousepositionx)||10<Math.abs(c.touches[0].pageY-this._mousepositiony))){this._mapdragged=!0;var f=(this._mousepositiony-c.touches[0].pageY)/a.zoom[b.usermap].currentzoom;a.zoom[b.usermap].currentx=k(a.zoom[b.usermap].currentx+(this._mousepositionx-c.touches[0].pageX)/a.zoom[b.usermap].currentzoom,
a.precision);a.zoom[b.usermap].currenty=k(a.zoom[b.usermap].currenty-f,a.precision);this._mousepositionx=c.touches[0].pageX;this._mousepositiony=c.touches[0].pageY;C(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx)}}else if(2==c.touches.length&&a.usermap[b.usermap].map.zoom_setting.mouseWheel){a.zoom[b.usermap].prevzoom=a.zoom[b.usermap].currentzoom;f=L(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom);this._pos.move=[];this._pos.move[0]={};this._pos.move[1]=
{};this._pos.move[0].x=c.touches[0].pageX;this._pos.move[0].y=c.touches[0].pageY;this._pos.move[1].x=c.touches[1].pageX;this._pos.move[1].y=c.touches[1].pageY;var g=ta(this._pos.move[0],this._pos.move[1]),h=ta(this._pos.start[0],this._pos.start[1]);k(a.zoom[b.usermap].currentzoom);e=this._pos.start[0];var r=this._pos.start[1];c=(e.x+r.x)/2;e=(r.y+e.y)/2;var l=a.svgcoord[b.usermap];l.x=c;l.y=e;for(var l=y(l,a.g[b.usermap]),s=this,q=r=0;s;)r+=s.offsetLeft,q+=s.offsetTop,s=s.offsetParent;l.x/=a.map[d].precision/
a.factor[b.usermap];l.y/=a.map[d].precision/a.factor[b.usermap];s=l.x;l=360*(Math.atan(Math.pow(Math.E,l.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI;50<Math.abs(g-h)&&(this._transformed=!0,P(l,s)||(g>h?20>f&&(a.zoom[b.usermap].currentzoom=k(1.5*a.zoom[b.usermap].currentzoom,a.precision),a.zoom[b.usermap].currentx=k(a.zoom[b.usermap].currentx-(parseInt(this.style.width)/2-(c-r))/a.zoom[b.usermap].currentzoom*0.5,a.precision),a.zoom[b.usermap].currenty=k(a.zoom[b.usermap].currenty+(parseInt(this.style.height)/
2-(e-q))/a.zoom[b.usermap].currentzoom*0.5,a.precision),C(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx)):1<f&&(a.zoom[b.usermap].currentzoom=k(a.zoom[b.usermap].currentzoom/1.5,a.precision),a.zoom[b.usermap].currentx=k(a.zoom[b.usermap].currentx+(parseInt(this.style.width)/2-(c-r))/a.zoom[b.usermap].currentzoom*(1-1/1.5),a.precision),a.zoom[b.usermap].currenty=k(a.zoom[b.usermap].currenty-(parseInt(this.style.height)/2-(e-q))/a.zoom[b.usermap].currentzoom*
(1-1/1.5),a.precision),C(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx)),this._pos.start[0].x=this._pos.move[0].x,this._pos.start[0].y=this._pos.move[0].y,this._pos.start[1].x=this._pos.move[1].x,this._pos.start[1].y=this._pos.move[1].y))}});a.touchdevices&&(a.div[b.usermap].ontouchend=function(a){a.preventDefault&&a.preventDefault();0==a.touches.length&&(this._mousedown=this._mapdragged=this._transformed=!1,this._mousepositiony=this._mousepositionx=0,this._pos=
{})});a.background[b.usermap]=document.createElement("div");for(var e in a.usermap[b.usermap].div.style)a.usermap[b.usermap].div.style.hasOwnProperty(e)&&("backgroundImage"==e?""!=a.usermap[b.usermap].div.style[e]&&(a.background[b.usermap].style[e]="url('"+a.base[b.usermap]+a.usermap[b.usermap].div.style[e]+"?"+Math.random(1E5)+"')"):a.background[b.usermap].style[e]=a.usermap[b.usermap].div.style[e]);a.background[b.usermap].style.position="absolute";a.background[b.usermap].style.top="0px";a.background[b.usermap].style.left=
"0px";a.background[b.usermap].style.width="100%";a.background[b.usermap].style.height="100%";a.div[b.usermap].appendChild(a.background[b.usermap]);a.foreground[b.usermap]=document.createElement("div");a.foreground[b.usermap].style.width="100%";a.foreground[b.usermap].style.height="100%";a.foreground[b.usermap].style.position="absolute";a.foreground[b.usermap].style.top=a.usermap[b.usermap].div.style.borderWidth;a.foreground[b.usermap].style.left=a.usermap[b.usermap].div.style.borderWidth;a.div[b.usermap].appendChild(a.foreground[b.usermap]);
a.zoomcontrol[b.usermap]=document.createElement("div");a.zoomcontrol[b.usermap].style.position="absolute";a.zoomcontrol[b.usermap].style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+5+"px";a.zoomcontrol[b.usermap].style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+5+"px";a.zoomcontrol[b.usermap].style.backgroundColor="rgba(0,0,0,0)";a.panhome[b.usermap]=document.createElement("div");a.panhome[b.usermap].style.width=a.touchdevices?"24px":"16px";a.panhome[b.usermap].style.height=
a.touchdevices?"24px":"16px";a.panhome[b.usermap].style.position="absolute";a.panhome[b.usermap].style.top="5px";a.panhome[b.usermap].style.left="5px";a.panhome[b.usermap].style.backgroundColor=a.usermap[b.usermap].map.zoom_setting.style.backgroundColor;a.panhome[b.usermap].style.borderWidth="1px";a.panhome[b.usermap].style.borderColor=a.usermap[b.usermap].map.zoom_setting.style.borderColor;a.panhome[b.usermap].style.borderStyle="solid";a.panhome[b.usermap].style.borderRadius="2px";a.panhome[b.usermap].unselectable=
"on";a.panhome[b.usermap].style.visibility="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.homeControl?a.usermap[b.usermap].map.zoom_setting.homeControl?"visible":"hidden":"visible";a.panhome[b.usermap].style.cursor="pointer";a.panhome[b.usermap].title="home";h=q("svg");h.setAttribute("xmlns","http://www.w3.org/2000/svg");h.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");h.setAttribute("version","1.1");a.touchdevices?(h.setAttribute("width","24px"),h.setAttribute("height","24px")):
(h.setAttribute("width","16px"),h.setAttribute("height","16px"));h.style.overflow="hidden";f=q("polyline");a.touchdevices?f.setAttribute("points","3,14 12,3 21,14"):f.setAttribute("points","2.5,9.5 8.5,3.5 14.5,9.5");f.style.fill="none";f.style.stroke=a.usermap[b.usermap].map.zoom_setting.style.symbolColor;f.style.strokeWidth=1.5;h.appendChild(f);f=q("polyline");a.touchdevices?f.setAttribute("points","4.5,14 4.5,22 19.5,22 19.5,14"):f.setAttribute("points","4.5,7.5 4.5,14.5 12.5,14.5 12.5,7.5");f.style.fill=
"none";f.style.stroke=a.usermap[b.usermap].map.zoom_setting.style.symbolColor;f.style.strokeWidth=1;h.appendChild(f);f=q("polyline");a.touchdevices?f.setAttribute("points","9.5,22 9.5,13.5 14.5,13.5 14.5,22"):f.setAttribute("points","6.5,14.5 6.5,9.5 10.5,9.5 10.5,14.5");f.style.fill="none";f.style.stroke=a.usermap[b.usermap].map.zoom_setting.style.symbolColor;f.style.strokeWidth=1;h.appendChild(f);a.panhome[b.usermap].appendChild(h);a.panhome[b.usermap].onmouseup=function(a){};a.panhome[b.usermap].onmousedown=
function(a){};a.panhome[b.usermap].onmousemove=function(a){};a.panhome[b.usermap].onmousewheel=function(a){};a.panhome[b.usermap].addEventListener&&a.panhome[b.usermap].addEventListener("DOMMouseScroll",function(a){},!1);a.touchdevices||(a.panhome[b.usermap].onclick=function(c){c.stopPropagation&&c.stopPropagation();Z(b,a.usermap[b.usermap].map.zoom,a.usermap[b.usermap].map.lat,a.usermap[b.usermap].map.lng)});a.touchdevices&&(a.panhome[b.usermap].ontouchstart=function(a){a.preventDefault&&a.preventDefault();
a.stopPropagation&&a.stopPropagation();this._touch=1==a.touches.length?!0:!1});a.touchdevices&&(a.panhome[b.usermap].ontouchend=function(c){this._touch&&Z(b,a.usermap[b.usermap].map.zoom,a.usermap[b.usermap].map.lat,a.usermap[b.usermap].map.lng)});a.zoomcontrol[b.usermap].appendChild(a.panhome[b.usermap]);a.zoomin[b.usermap]=document.createElement("div");a.zoomin[b.usermap].style.width=a.touchdevices?"24px":"16px";a.zoomin[b.usermap].style.height=a.touchdevices?"24px":"16px";a.zoomin[b.usermap].style.position=
"absolute";a.zoomin[b.usermap].style.top=a.touchdevices?"34px":"24px";a.zoomin[b.usermap].style.left="5px";a.zoomin[b.usermap].style.backgroundColor=a.usermap[b.usermap].map.zoom_setting.style.backgroundColor;a.zoomin[b.usermap].style.borderWidth="1px";a.zoomin[b.usermap].style.borderColor=a.usermap[b.usermap].map.zoom_setting.style.borderColor;a.zoomin[b.usermap].style.borderStyle="solid";a.zoomin[b.usermap].style.borderRadius="2px";a.zoomin[b.usermap].style.unselectable="on";a.zoomin[b.usermap].style.visibility=
"undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.zoomControl?a.usermap[b.usermap].map.zoom_setting.zoomControl?"visible":"hidden":"visible";a.zoomin[b.usermap].style.cursor="pointer";a.zoomin[b.usermap].title="zoom in";h=q("svg");h.setAttribute("xmlns","http://www.w3.org/2000/svg");h.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");h.setAttribute("version","1.1");a.touchdevices?(h.setAttribute("width","24px"),h.setAttribute("height","24px")):(h.setAttribute("width","16px"),h.setAttribute("height",
"16px"));h.style.overflow="hidden";f=q("polyline");a.touchdevices?f.setAttribute("points","4,12 20,12"):f.setAttribute("points","3,8 13,8");f.style.fill="none";f.style.stroke=a.usermap[b.usermap].map.zoom_setting.style.symbolColor;f.style.strokeWidth=2;h.appendChild(f);f=q("polyline");a.touchdevices?f.setAttribute("points","12,4 12,20"):f.setAttribute("points","8,3 8,13");f.style.fill="none";f.style.stroke=a.usermap[b.usermap].map.zoom_setting.style.symbolColor;f.style.strokeWidth=2;h.appendChild(f);
a.zoomin[b.usermap].appendChild(h);a.zoomin[b.usermap].onmouseup=function(a){};a.zoomin[b.usermap].onmousedown=function(a){};a.zoomin[b.usermap].onmousemove=function(a){};a.zoomin[b.usermap].onmousewheel=function(a){};a.zoomin[b.usermap].addEventListener&&a.zoomin[b.usermap].addEventListener("DOMMouseScroll",function(a){},!1);a.touchdevices||(a.zoomin[b.usermap].onclick=function(c){c.preventDefault&&c.preventDefault();c.stopPropagation&&c.stopPropagation();a.zoom[b.usermap].prevzoom=a.zoom[b.usermap].currentzoom;
20>L(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom)&&(a.zoom[b.usermap].currentzoom=k(1.5*a.zoom[b.usermap].currentzoom,a.precision),C(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx))});a.touchdevices&&(a.zoomin[b.usermap].ontouchstart=function(a){a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();this._touch=1==a.touches.length?!0:!1});a.touchdevices&&(a.zoomin[b.usermap].ontouchend=function(c){a.zoom[b.usermap].prevzoom=
a.zoom[b.usermap].currentzoom;c=L(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom);this._touch&&20>c&&(a.zoom[b.usermap].currentzoom=k(1.5*a.zoom[b.usermap].currentzoom,a.precision),C(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx))});a.zoomcontrol[b.usermap].appendChild(a.zoomin[b.usermap]);a.zoomout[b.usermap]=document.createElement("div");a.zoomout[b.usermap].style.width=a.touchdevices?"24px":"16px";a.zoomout[b.usermap].style.height=a.touchdevices?
"24px":"16px";a.zoomout[b.usermap].style.position="absolute";a.zoomout[b.usermap].style.top=a.touchdevices?"63px":"43px";a.zoomout[b.usermap].style.left="5px";a.zoomout[b.usermap].style.backgroundColor=a.usermap[b.usermap].map.zoom_setting.style.backgroundColor;a.zoomout[b.usermap].style.borderWidth="1px";a.zoomout[b.usermap].style.borderColor=a.usermap[b.usermap].map.zoom_setting.style.borderColor;a.zoomout[b.usermap].style.borderStyle="solid";a.zoomout[b.usermap].style.borderRadius="2px";a.zoomout[b.usermap].unselectable=
"on";a.zoomout[b.usermap].style.visibility="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.zoomControl?a.usermap[b.usermap].map.zoom_setting.zoomControl?"visible":"hidden":"visible";a.zoomout[b.usermap].style.cursor="pointer";a.zoomout[b.usermap].title="zoom out";h=q("svg");h.setAttribute("xmlns","http://www.w3.org/2000/svg");h.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");h.setAttribute("version","1.1");a.touchdevices?(h.setAttribute("width","24px"),h.setAttribute("height",
"24px")):(h.setAttribute("width","16px"),h.setAttribute("height","16px"));h.style.overflow="hidden";f=q("polyline");a.touchdevices?f.setAttribute("points","4,12 20,12"):f.setAttribute("points","3,8 13,8");f.style.fill="none";f.style.stroke=a.usermap[b.usermap].map.zoom_setting.style.symbolColor;f.style.strokeWidth=2;h.appendChild(f);a.zoomout[b.usermap].appendChild(h);a.zoomout[b.usermap].onmouseup=function(a){};a.zoomout[b.usermap].onmousedown=function(a){};a.zoomout[b.usermap].onmousemove=function(a){};
a.zoomout[b.usermap].onmousewheel=function(a){};a.zoomout[b.usermap].addEventListener&&a.zoomout[b.usermap].addEventListener("DOMMouseScroll",function(a){},!1);a.touchdevices||(a.zoomout[b.usermap].onclick=function(c){c.stopPropagation&&c.stopPropagation();a.zoom[b.usermap].prevzoom=a.zoom[b.usermap].currentzoom;1<L(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom)&&(a.zoom[b.usermap].currentzoom=k(a.zoom[b.usermap].currentzoom/1.5,a.precision),C(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,
a.zoom[b.usermap].currentx))});a.touchdevices&&(a.zoomout[b.usermap].ontouchstart=function(a){a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();this._touch=1==a.touches.length?!0:!1});a.touchdevices&&(a.zoomout[b.usermap].ontouchend=function(c){this._touch&&(a.zoom[b.usermap].prevzoom=a.zoom[b.usermap].currentzoom,1<L(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom)&&(a.zoom[b.usermap].currentzoom=k(a.zoom[b.usermap].currentzoom/1.5,a.precision),C(b,a.zoom[b.usermap].currentzoom,
a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx)))});a.zoomcontrol[b.usermap].appendChild(a.zoomout[b.usermap]);a.div[b.usermap].appendChild(a.zoomcontrol[b.usermap]);a.local&&(h=document.createElement("script"),h.type="application/javascript",h.src=b.base+"imap5map_"+a.usermap[b.usermap].map.id+".js?"+Math.random(1E5),h.onerror=function(){},h.onload=function(){Da(b)},document.body.appendChild(h))},Ea=function(b){var d=document.createElement("div");a.div[b.usermap].appendChild(d);d.style.position="absolute";d.style.bottom="-1px";d.style.right="1px";d.style.font="11px Verdana";d.style.backgroundColor="#ffffff";d.style.cursor="none";d.style.visibility="hidden"},Fa=function(b){var d=q("g");d.style.opacity=0.2;a.svg[b.usermap].appendChild(d);var h=q("text");h.style.cursor="default";h.style.fill="#FFFFFF";h.style.fontFamily=
"Arial";h.style.fontWeight="bold";h.style.pointerEvents="none";d.appendChild(h);h.setAttribute("x",-4096);h.setAttribute("y",-4096);var f=q("text");f.style.cursor="default";f.style.fill="#000000";f.style.fontFamily="Arial";f.style.fontWeight="bold";f.style.pointerEvents="none";d.appendChild(f);f.setAttribute("x",-4096);f.setAttribute("y",-4096);f.setAttribute("text-anchor","middle");d=parseInt(a.div[b.usermap].clientWidth/8);for(f.style.fontSize=
d+"px";f.getBBox().width>a.div[b.usermap].clientWidth;)d-=2,f.style.fontSize=d+"px";for(;f.getBBox().height>a.div[b.usermap].clientHeight;)d-=2,f.style.fontSize=d+"px";d-=2;f.style.fontSize=d+"px";f.setAttribute("x",a.div[b.usermap].clientWidth/2);f.setAttribute("y",a.div[b.usermap].clientHeight/2+parseInt(f.style.fontSize)/2);h.setAttribute("text-anchor","middle");h.style.fontSize=d+"px";h.setAttribute("x",a.div[b.usermap].clientWidth/2+3);h.setAttribute("y",a.div[b.usermap].clientHeight/2+parseInt(f.style.fontSize)/
2+3);var g=document.createElement("div");a.div[b.usermap].appendChild(g);g.style.position="absolute";g.style.bottom=0-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";g.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";g.style.font="11px Verdana";g.style.backgroundColor="#ffffff";g.style.padding="3px";g.style.opacity=0.5;g.style.cursor="pointer";g.onclick=function(){location.href="http://www.html5mapsoftware.com"};
a.touchdevices&&(g.ontouchstart=function(a){a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();this._touch=1==a.touches.length?!0:!1});a.touchdevices&&(g.ontouchend=function(a){this._touch&&(location.href="http://www.html5mapsoftware.com")});g.onmouseover=function(){g.style.opacity=1};g.onmouseout=function(){g.style.opacity=0.5}};a.zoomTo=function(a,d,h,f){Z(a,d,h,f)};var Z=function(a,d,h,f){h=z(h);h=Math.log(Math.tan(Math.PI/4+Math.PI*h/360))*(180/Math.PI);C(a,d,h,f)};a.zoomToXY=
function(a,d,h,f){C(a,d,h,f)};var C=function(b,d,h,f){var g=a.usermap[b.usermap].map.id,c=a.div[b.usermap].clientWidth,e=a.div[b.usermap].clientHeight;k(a.zoom[b.usermap].currentzoom,a.precision);a.zoom[b.usermap].currentzoom=k(d,a.precision);a.zoom[b.usermap].currentx=k(f,a.precision);a.zoom[b.usermap].currenty=k(h,a.precision);a.g[b.usermap].setAttribute("transform","translate("+k(c/2+-f*d,a.precision)+","+k(e/2+h*d,a.precision)+") scale("+k(d/(a.map[g].precision/a.factor[b.usermap]),a.precision)+
",-"+k(d/(a.map[g].precision/a.factor[b.usermap]),a.precision)+")");a.g[b.usermap].setAttribute("stroke-width",k(a.usermap[b.usermap].map.geometry_default.stroke_width/d*(a.map[g].precision/a.factor[b.usermap]),a.precision));window.console&&(c={event:"poschange",object:"map"},c.zoom=k(d,a.precision),c.x=k(f,a.precision),c.y=k(h,a.precision),window.console&&console.log(JSON.stringify(c)));for(var n in a.marker[b.usermap])a.marker[b.usermap].hasOwnProperty(n)&&a.marker[b.usermap][n].setAttribute("transform",
"translate("+k(a.marker[b.usermap][n]._lng,a.precision)+","+k(a.marker[b.usermap][n]._lat,a.precision)+") scale("+k(a.map[g].precision/a.factor[b.usermap]/d,a.precision)+")");for(n in a.maplabel[b.usermap])a.maplabel[b.usermap].hasOwnProperty(n)&&a.maplabel[b.usermap][n].setAttribute("transform","translate("+k(a.maplabel[b.usermap][n]._lng,a.precision)+","+k(a.maplabel[b.usermap][n]._lat,a.precision)+") scale("+k(a.map[g].precision/a.factor[b.usermap]/d,a.precision)+")");if(k(a.zoom[b.usermap].prevzoom,
a.precision)!=d){for(n in a.mapabbr[b.usermap])if(a.mapabbr[b.usermap].hasOwnProperty(n)){a.mapabbr[b.usermap][n].setAttribute("transform","translate("+k(a.mapabbr[b.usermap][n]._lng,a.precision)+","+k(a.mapabbr[b.usermap][n]._lat,a.precision)+") scale("+k(a.map[g].precision/a.factor[b.usermap]/d,a.precision)+")");h=k(a.map[g].precision/a.factor[b.usermap]/d,a.precision);var t=k(a.mapabbr[b.usermap][n]._lng/h,a.precision);h=k(a.mapabbr[b.usermap][n]._lat/h,a.precision);f=a.mapabbr[b.usermap][n].getBBox();
a.mapabbr[b.usermap][n]._bbox={};a.mapabbr[b.usermap][n]._bbox.x=parseFloat(t+f.x);a.mapabbr[b.usermap][n]._bbox.y=parseFloat(h+f.y);a.mapabbr[b.usermap][n]._bbox.width=f.width;a.mapabbr[b.usermap][n]._bbox.height=f.height;a.mapabbr[b.usermap][n].hide()}a.geoareasize[b.usermap].sort(function(a,b){return b.area-a.area});for(t=0;t<a.geoareasize[b.usermap].length;t++)if(a.geoareasize[b.usermap].hasOwnProperty(t)&&(n=a.geoareasize[b.usermap][t].id,a.mapabbr[b.usermap].hasOwnProperty(n))){h=a.mapabbr[b.usermap][n]._bbox;
a.mapabbr[b.usermap][n].show();for(var w in a.mapabbr[b.usermap])if(w!=n&&a.mapabbr[b.usermap].hasOwnProperty(w)&&"visible"==a.mapabbr[b.usermap][w].style.visibility&&(f=a.mapabbr[b.usermap][w]._bbox,Aa({x:h.x,y:h.y},{x:parseFloat(h.x+h.width),y:parseFloat(h.y+h.height)},{x:f.x,y:f.y},{x:parseFloat(f.x+f.width),y:parseFloat(f.y+f.height)}))){a.mapabbr[b.usermap][n].hide();break}}}else for(n in a.mapabbr[b.usermap])a.mapabbr[b.usermap].hasOwnProperty(n)&&a.mapabbr[b.usermap][n].setAttribute("transform",
"translate("+k(a.mapabbr[b.usermap][n]._lng,a.precision)+","+k(a.mapabbr[b.usermap][n]._lat,a.precision)+") scale("+k(a.map[g].precision/a.factor[b.usermap]/d,a.precision)+")");for(n in a.mappoly[b.usermap])if(a.mappoly[b.usermap].hasOwnProperty(n)){a.mappoly[b.usermap][n].getElementsByTagName("polygon")[0].setAttribute("stroke-width",k(a.mappoly[b.usermap][n]._options.style.strokeWidth/d*(a.map[g].precision/a.factor[b.usermap]),a.precision));if("undefined"!==typeof a.mappoly[b.usermap][n]._options.style.strokeDasharray&&
"none"!==a.mappoly[b.usermap][n]._options.style.strokeDasharray){w=a.mappoly[b.usermap][n]._options.style.strokeDasharray.split(",");h="";for(t=0;t<w.length;t++)""!=h&&(h+=","),h+=k(w[t]/a.zoom[b.usermap].currentzoom*(a.map[g].precision/a.factor[b.usermap]),a.precision);a.mappoly[b.usermap][n].getElementsByTagName("polygon")[0].setAttribute("stroke-dasharray",h)}for(t in a.mappoly[b.usermap][n]._mainvertices)a.mappoly[b.usermap][n]._mainvertices.hasOwnProperty(t)&&a.mappoly[b.usermap][n]._mainvertices[t].rescale();
for(t in a.mappoly[b.usermap][n]._subvertices)a.mappoly[b.usermap][n]._subvertices.hasOwnProperty(t)&&a.mappoly[b.usermap][n]._subvertices[t].rescale();a.mappoly[b.usermap][n].toggleCategory()}"mappoly"==a.mode[b.usermap]&&"undefined"!=typeof a.poly[b.usermap][1]&&null!=a.poly[b.usermap][1]&&(1<a.poly[b.usermap][1].count()?a.poly[b.usermap][1].getElementsByTagName("polygon")[0].setAttribute("stroke-width",k(a.poly[b.usermap][1]._options.style.strokeWidth/d*(a.map[g].precision/a.factor[b.usermap]),
a.precision)):a.poly[b.usermap][1].getElementsByTagName("polyline")[0].setAttribute("stroke-width",k(a.poly[b.usermap][1]._options.style.strokeWidth/d*(a.map[g].precision/a.factor[b.usermap]),a.precision)));for(n in a.maprect[b.usermap])if(a.maprect[b.usermap].hasOwnProperty(n)){a.maprect[b.usermap][n].getElementsByTagName("polygon")[0].setAttribute("stroke-width",k(a.maprect[b.usermap][n]._options.style.strokeWidth/d*(a.map[g].precision/a.factor[b.usermap]),a.precision));if("undefined"!==typeof a.maprect[b.usermap][n]._options.style.strokeDasharray&&
"none"!==a.maprect[b.usermap][n]._options.style.strokeDasharray){w=a.maprect[b.usermap][n]._options.style.strokeDasharray.split(",");h="";for(t=0;t<w.length;t++)""!=h&&(h+=","),h+=k(w[t]/a.zoom[b.usermap].currentzoom*(a.map[g].precision/a.factor[b.usermap]),a.precision);a.maprect[b.usermap][n].getElementsByTagName("polygon")[0].setAttribute("stroke-dasharray",h)}for(t in a.maprect[b.usermap][n]._mainvertices)a.maprect[b.usermap][n]._mainvertices.hasOwnProperty(t)&&a.maprect[b.usermap][n]._mainvertices[t].rescale();
a.maprect[b.usermap][n].toggleCategory()}"maprect"==a.mode[b.usermap]&&"undefined"!=typeof a.rect[b.usermap][1]&&null!=a.rect[b.usermap][1]&&a.rect[b.usermap][1].getElementsByTagName("polygon")[0].setAttribute("stroke-width",k(a.rect[b.usermap][1]._options.style.strokeWidth/d*(a.map[g].precision/a.factor[b.usermap]),a.precision));for(n in a.mappath[b.usermap])if(a.mappath[b.usermap].hasOwnProperty(n)){a.mappath[b.usermap][n].drawMapPath();for(t in a.mappath[b.usermap][n]._mainvertices)a.mappath[b.usermap][n]._mainvertices.hasOwnProperty(t)&&
a.mappath[b.usermap][n]._mainvertices[t].rescale();for(t in a.mappath[b.usermap][n]._subvertices)a.mappath[b.usermap][n]._subvertices.hasOwnProperty(t)&&a.mappath[b.usermap][n]._subvertices[t].rescale();a.mappath[b.usermap][n].toggleCategory()}"mappath"==a.mode[b.usermap]&&"undefined"!=typeof a.path[b.usermap][1]&&null!=a.path[b.usermap][1]&&a.path[b.usermap][1].getElementsByTagName("polyline")[0].setAttribute("stroke-width",k(a.path[b.usermap][1]._options.style.strokeWidth/d*(a.map[g].precision/
a.factor[b.usermap]),a.precision));for(n in a.mapcurve[b.usermap])if(a.mapcurve[b.usermap].hasOwnProperty(n)){a.mapcurve[b.usermap][n].drawMapCurve();for(t in a.mapcurve[b.usermap][n]._mainvertices)a.mapcurve[b.usermap][n]._mainvertices.hasOwnProperty(t)&&a.mapcurve[b.usermap][n]._mainvertices[t].rescale();a.mapcurve[b.usermap][n].toggleCategory()}"mapcurve"==a.mode[b.usermap]&&"undefined"!=typeof a.curve[b.usermap][1]&&null!=a.curve[b.usermap][1]&&a.curve[b.usermap][1].getElementsByTagName("path")[0].setAttribute("stroke-width",
k(a.curve[b.usermap][1]._options.style.strokeWidth/d*(a.map[g].precision/a.factor[b.usermap]),a.precision));for(n in a.mapbubble[b.usermap])a.mapbubble[b.usermap].hasOwnProperty(n)&&null!==a.mapbubble[b.usermap][n]&&a.mapbubble[b.usermap][n].rescale();for(n in a.piechart[b.usermap])a.piechart[b.usermap].hasOwnProperty(n)&&null!==a.piechart[b.usermap][n]&&a.piechart[b.usermap][n].rescale();a.center[b.usermap].setAttribute("transform","scale("+k(a.map[g].precision/a.factor[b.usermap]/d,a.precision)+
")");a.zoom[b.usermap].prevzoom=d};a.getLatLng=function(b){var d=a.zoom[b.usermap].currentzoom,h=360*(Math.atan(Math.pow(Math.E,a.zoom[b.usermap].currenty*Math.PI/180))-Math.PI/4)/Math.PI;b=a.zoom[b.usermap].currentx;var f={event:"getlatlng",object:"map"};f.lat=k(h,a.precision);f.lng=k(b,a.precision);f.zoom=k(d,a.precision);window.console&&console.log(JSON.stringify(f))};a.setZoom=function(b,d){var h=a.usermap[b.usermap].map.id;a.g[b.usermap].setAttribute("transform","translate("+(a.div[b.usermap].clientWidth/
2+-a.usermap[b.usermap].map.lng*d)+","+(a.div[b.usermap].clientHeight/2+a.usermap[b.usermap].map.lat*d)+") scale("+d/(a.map[h].precision/a.factor[b.usermap])+",-"+d/(a.map[h].precision/a.factor[b.usermap])+")");a.g[b.usermap].setAttribute("stroke-width",a.usermap[b.usermap].map.geometry_default.stroke_width/d*(a.map[h].precision/a.factor[b.usermap]))};var Da=function(b){var d=a.usermap[b.usermap].map.id,h=a.usermap[b.usermap].map.zoom,f=0;a.svg[b.usermap]=q("svg");a.svg[b.usermap].setAttribute("xmlns",
"http://www.w3.org/2000/svg");a.svg[b.usermap].setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");a.svg[b.usermap].setAttribute("width",a.div[b.usermap].clientWidth+"px");a.svg[b.usermap].setAttribute("height",a.div[b.usermap].clientHeight+"px");a.svg[b.usermap].style.overflow="hidden";a.foreground[b.usermap].appendChild(a.svg[b.usermap]);a.svgcoord[b.usermap]=a.svg[b.usermap].createSVGPoint();a.grouphighlight[b.usermap].enable="undefined"==typeof a.usermap[b.usermap].map.grouphighlight?!1:
a.usermap[b.usermap].map.grouphighlight.enable;a.fadeout[b.usermap].enable="undefined"==typeof a.usermap[b.usermap].map.fadeout?!0:a.usermap[b.usermap].map.fadeout.enable;a.heatmap[b.usermap].enable="undefined"==typeof a.usermap[b.usermap].map.heatmap?!1:a.usermap[b.usermap].map.heatmap.enable;if(a.heatmap[b.usermap].enable)if("continuous"==a.usermap[b.usermap].map.heatmap.heattype){var g={},g=sa(b);a.heatmap[b.usermap].hmin=g.hmin;a.heatmap[b.usermap].hmax=g.hmax}else{var g=a.usermap[b.usermap].map.heatmap.discrete.rangeset.split(",").length,
c=a.usermap[b.usermap].map.heatmap.discrete.colorset.split(",").length;0<g&&0<c&&c==g+1||(a.heatmap[b.usermap].enable=!1)}a.g[b.usermap]=q("g");a.g[b.usermap].setAttribute("stroke",a.usermap[b.usermap].map.geometry_default.stroke);a.g[b.usermap].setAttribute("stroke-width",a.usermap[b.usermap].map.geometry_default.stroke_width/h*(a.map[d].precision/a.factor[b.usermap]));a.g[b.usermap].setAttribute("stroke-linejoin",a.usermap[b.usermap].map.geometry_default.stroke_linejoin);a.svg[b.usermap].appendChild(a.g[b.usermap]);
var h=!0,e;for(e in a.map[d].geometry)if(a.map[d].geometry.hasOwnProperty(e)){var g=0,n=[],t=0,w=0,c=a.map[d].geometry[e].id;a.geometry[b.usermap][c]=q("g");a.g[b.usermap].appendChild(a.geometry[b.usermap][c]);a.geometry[b.usermap][c].setAttribute("id",a.map[d].geometry[e].id);a.geometry[b.usermap][c].fade={};a.geometry[b.usermap][c].fade.curColor={};a.geometry[b.usermap][c].fade.diffColor={};a.geometry[b.usermap][c].group={};a.geometry[b.usermap][c].group.id="undefined"==typeof a.usermap[b.usermap].map.geometry[c].group?
0:a.usermap[b.usermap].map.geometry[c].group;a.heatmap[b.usermap].enable&&(a.geometry[b.usermap][c].heatcolor="continuous"==a.usermap[b.usermap].map.heatmap.heattype?fa(a.usermap[b.usermap].map.heatmap.continuous.startcolor,a.usermap[b.usermap].map.heatmap.continuous.endcolor,ha(a.heatmap[b.usermap].hmin,a.heatmap[b.usermap].hmax,a.usermap[b.usermap].map.geometry[c].heatvalue)):ga(a.usermap[b.usermap].map.geometry[c].heatvalue,a.usermap[b.usermap].map.heatmap.discrete.rangeset.split(","),a.usermap[b.usermap].map.heatmap.discrete.colorset.split(",")));
"undefined"==typeof a.groupHL[b.usermap][a.geometry[b.usermap][c].group.id]&&(a.groupHL[b.usermap][a.geometry[b.usermap][c].group.id]=[]);a.groupHL[b.usermap][a.geometry[b.usermap][c].group.id].push(c);U({usermap:b.usermap,geometry:c});a.geometry[b.usermap][c].fadeTo=function(a,b){var c=this;this.fade.startcolor=this.getAttribute("fill");this.fade.endcolor=a;this.fade.curColor.r=I(this.fade.startcolor);this.fade.curColor.g=J(this.fade.startcolor);this.fade.curColor.b=K(this.fade.startcolor);this.fade.diffColor.r=
I(this.fade.endcolor)-I(this.fade.startcolor);this.fade.diffColor.g=J(this.fade.endcolor)-J(this.fade.startcolor);this.fade.diffColor.b=K(this.fade.endcolor)-K(this.fade.startcolor);this.fade.totalCount=1E3*b/20;this.fade.count=0;0<this.fade.totalCount?this.fade.interval=setInterval(function(){c.fade.count<c.fade.totalCount?(c.fade.curColor.r+=c.fade.diffColor.r/c.fade.totalCount,c.fade.curColor.g+=c.fade.diffColor.g/c.fade.totalCount,c.fade.curColor.b+=c.fade.diffColor.b/c.fade.totalCount,c.setAttribute("fill",
"#"+Q(c.fade.curColor.r,2)+Q(c.fade.curColor.g,2)+Q(c.fade.curColor.b,2)),c.fade.count++):(c.setAttribute("fill",c.fade.endcolor),clearInterval(c.fade.interval))},20):this.setAttribute("fill",a)};a.touchdevices||(a.geometry[b.usermap][c].onmouseover=function(c){"marker"==a.mode[b.usermap]&&(this.style.cursor="pointer");"maplabel"==a.mode[b.usermap]&&(this.style.cursor="pointer");"mappath"==a.mode[b.usermap]&&(this.style.cursor="pointer");"mappoly"==a.mode[b.usermap]&&(this.style.cursor="pointer");
"maprect"==a.mode[b.usermap]&&(this.style.cursor="pointer");"mapcurve"==a.mode[b.usermap]&&(this.style.cursor="pointer");if(0!=this.group.id&&a.grouphighlight[b.usermap].enable)for(var e in a.groupHL[b.usermap][this.group.id])a.groupHL[b.usermap][this.group.id].hasOwnProperty(e)&&clearInterval(a.geometry[b.usermap][a.groupHL[b.usermap][this.group.id][e]].fade.interval);else clearInterval(this.fade.interval);if(0!=this.group.id&&a.grouphighlight[b.usermap].enable)for(e in a.groupHL[b.usermap][this.group.id])a.groupHL[b.usermap][this.group.id].hasOwnProperty(e)&&
"undefined"!=typeof a.usermap[b.usermap].map.geometry[a.groupHL[b.usermap][this.group.id][e]]&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[a.groupHL[b.usermap][this.group.id][e]].fill_mouseover&&a.geometry[b.usermap][a.groupHL[b.usermap][this.group.id][e]].setAttribute("fill",R(b,a.groupHL[b.usermap][this.group.id][e]));else"undefined"!=typeof a.usermap[b.usermap].map.geometry[this.id]&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[this.id].fill_mouseover&&this.setAttribute("fill",
R(b,this.id));"normal"!=a.mode[b.usermap]||"onmouseover"!=a.usermap[b.usermap].infobox.show||"undefined"==typeof a.usermap[b.usermap].map.geometry[this.id]||"undefined"==typeof a.usermap[b.usermap].map.geometry[this.id].infobox||document.getElementById("imap5_"+b.usermap+"_infobox_geometry_"+this.id)||(e={},e.clientX=c.clientX,e.clientY=c.clientY,e.obj="geometry",e.infobox=a.usermap[b.usermap].map.geometry[this.id].infobox,this.infobox=new A(b,this.id,e))},a.geometry[b.usermap][c].onmouseout=function(c){"marker"==
a.mode[b.usermap]&&(this.style.cursor="auto");if(0!=this.group.id&&a.grouphighlight[b.usermap].enable)for(var e in a.groupHL[b.usermap][this.group.id])a.groupHL[b.usermap][this.group.id].hasOwnProperty(e)&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[a.groupHL[b.usermap][this.group.id][e]]&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[a.groupHL[b.usermap][this.group.id][e]].fill_mouseover&&(a.fadeout[b.usermap].enable?a.geometry[b.usermap][a.groupHL[b.usermap][this.group.id][e]].fadeTo(F(b,
a.groupHL[b.usermap][this.group.id][e]),0.2):a.geometry[b.usermap][a.groupHL[b.usermap][this.group.id][e]].fadeTo(F(b,a.groupHL[b.usermap][this.group.id][e]),0));else a.fadeout[b.usermap].enable?this.fadeTo(F(b,this.id),0.2):this.fadeTo(F(b,this.id),0);"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[this.id]&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[this.id].infobox&&(null==c.relatedTarget||c.relatedTarget.id!="imap5_"+b.usermap+
"_infobox_geometry_"+this.id)&&document.getElementById("imap5_"+b.usermap+"_infobox_geometry_"+this.id)&&this.infobox.remove()});a.touchdevices||(a.geometry[b.usermap][c].onclick=function(c){a.div[b.usermap]._mapdragged||a.div[b.usermap]._transformed||("edit"==a.mode[b.usermap]?(c={event:"click",object:"geometry"},c.id=this.id,window.console&&console.log(JSON.stringify(c))):"normal"==a.mode[b.usermap]&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[this.id]&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[this.id].link&&
("undefined"==typeof a.usermap[b.usermap].map.geometry[this.id].link_target?location.href=a.usermap[b.usermap].map.geometry[this.id].link:window.open(a.usermap[b.usermap].map.geometry[this.id].link,a.usermap[b.usermap].map.geometry[this.id].link_target)))});a.touchdevices||(a.geometry[b.usermap][c].onmousemove=function(c){c.preventDefault&&c.preventDefault();"normal"==a.mode[b.usermap]&&(a.div[b.usermap]._mousedown?document.getElementById("imap5_"+b.usermap+"_infobox_geometry_"+this.id)&&this.infobox.hide():
document.getElementById("imap5_"+b.usermap+"_infobox_geometry_"+this.id)&&(this.infobox.reposition(c.clientX,c.clientY),this.infobox.show()))});a.touchdevices&&(a.geometry[b.usermap][c].ontouchstart=function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)});a.touchdevices&&(a.geometry[b.usermap][c].ontouchmove=function(a){1==a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-this._posX)||10<Math.abs(a.touches[0].clientY-
this._posY))&&(this._move=!0):this._touch=!1});a.touchdevices&&(a.geometry[b.usermap][c].ontouchend=function(c){if(this._touch&&!this._move&&!a.div[b.usermap]._mapdragged){if("edit"==a.mode[b.usermap]){var e={event:"click",object:"geometry"};e.id=this.id;window.console&&console.log(JSON.stringify(e));return}"undefined"!=typeof a.usermap[b.usermap].map.geometry[this.id]&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[this.id].link&&("undefined"==typeof a.usermap[b.usermap].map.geometry[this.id].link_target?
location.href=a.usermap[b.usermap].map.geometry[this.id].link:window.open(a.usermap[b.usermap].map.geometry[this.id].link,a.usermap[b.usermap].map.geometry[this.id].link_target));if(0<a.selected[b.usermap].length){if(this.id==a.selected[b.usermap][0]){if(0!=this.group.id&&a.grouphighlight[b.usermap].enable)for(e in a.groupHL[b.usermap][this.group.id])a.groupHL[b.usermap][this.group.id].hasOwnProperty(e)&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[a.groupHL[b.usermap][this.group.id][e]]&&
"undefined"!=typeof a.usermap[b.usermap].map.geometry[a.groupHL[b.usermap][this.group.id][e]].fill_mouseover&&(a.fadeout[b.usermap].enable?a.geometry[b.usermap][a.groupHL[b.usermap][this.group.id][e]].fadeTo(F(b,a.groupHL[b.usermap][this.group.id][e]),0.2):a.geometry[b.usermap][a.groupHL[b.usermap][this.group.id][e]].fadeTo(F(b,a.groupHL[b.usermap][this.group.id][e]),0));else a.fadeout[b.usermap].enable?this.fadeTo(F(b,this.id),0.2):this.fadeTo(F(b,this.id),0);a.selected[b.usermap].pop();0<a.infobox[b.usermap].length&&
(document.getElementById("imap5_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)&&a.div[b.usermap].removeChild(document.getElementById("imap5_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)),a.infobox[b.usermap].pop());return}c=a.geometry[b.usermap][a.selected[b.usermap][0]].group.id;if(0!=c&&a.grouphighlight[b.usermap].enable)for(e in a.groupHL[b.usermap][c])a.groupHL[b.usermap][c].hasOwnProperty(e)&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[a.groupHL[b.usermap][c][e]]&&
"undefined"!=typeof a.usermap[b.usermap].map.geometry[a.groupHL[b.usermap][c][e]].fill_mouseover&&(a.fadeout[b.usermap].enable?a.geometry[b.usermap][a.groupHL[b.usermap][c][e]].fadeTo(F(b,a.groupHL[b.usermap][c][e]),0.2):a.geometry[b.usermap][a.groupHL[b.usermap][c][e]].fadeTo(F(b,a.groupHL[b.usermap][c][e]),0));else a.fadeout[b.usermap].enable?a.geometry[b.usermap][a.selected[b.usermap][0]].fadeTo(F(b,a.selected[b.usermap][0]),0.2):a.geometry[b.usermap][a.selected[b.usermap][0]].fadeTo(F(b,a.selected[b.usermap][0]),
0);a.selected[b.usermap].pop()}if("undefined"!=typeof a.usermap[b.usermap].map.geometry[this.id]&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[this.id].fill_mouseover)if(0!=this.group.id&&a.grouphighlight[b.usermap].enable)for(e in a.groupHL[b.usermap][this.group.id])a.groupHL[b.usermap][this.group.id].hasOwnProperty(e)&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[a.groupHL[b.usermap][this.group.id][e]]&&"undefined"!=typeof a.usermap[b.usermap].map.geometry[a.groupHL[b.usermap][this.group.id][e]].fill_mouseover&&
(a.fadeout[b.usermap].enable?a.geometry[b.usermap][a.groupHL[b.usermap][this.group.id][e]].fadeTo(R(b,a.groupHL[b.usermap][this.group.id][e]),0.2):a.geometry[b.usermap][a.groupHL[b.usermap][this.group.id][e]].fadeTo(R(b,a.groupHL[b.usermap][this.group.id][e]),0));else a.fadeout[b.usermap].enable?this.fadeTo(R(b,this.id),0.2):this.fadeTo(R(b,this.id),0);if("edit"==a.mode[b.usermap])return;a.selected[b.usermap].push(this.id);0<a.infobox[b.usermap].length&&(document.getElementById("imap5_"+b.usermap+
"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)&&a.div[b.usermap].removeChild(document.getElementById("imap5_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)),a.infobox[b.usermap].pop());"undefined"==typeof a.usermap[b.usermap].map.geometry[this.id]||"undefined"==typeof a.usermap[b.usermap].map.geometry[this.id].infobox||document.getElementById("imap5_"+b.usermap+"_infobox_geometry_"+this.id)||(e={},e.clientX=this._posX,e.clientY=this._posY,
e.obj="geometry",e.infobox=a.usermap[b.usermap].map.geometry[this.id].infobox,this.infobox=new A(b,this.id,e))}this._move=this._touch=!1});"undefined"==typeof a.usermap[b.usermap].map.geometry[a.map[d].geometry[e].id]||"undefined"==typeof a.usermap[b.usermap].map.geometry[a.map[d].geometry[e].id].title||"undefined"!=typeof a.usermap[b.usermap].map.geometry_default.disableTooltip&&a.usermap[b.usermap].map.geometry_default.disableTooltip||(t=q("title"),t.appendChild(document.createTextNode(a.usermap[b.usermap].map.geometry[a.map[d].geometry[e].id].title)),
a.geometry[b.usermap][c].appendChild(t));for(var m in a.map[d].geometry[e].polygons){var p,r,l,s=[];if(a.map[d].geometry[e].polygons.hasOwnProperty(m)){var u=q("path");a.geometry[b.usermap][c].appendChild(u);var v="",B;for(B in a.map[d].geometry[e].polygons[m]){if(a.map[d].geometry[e].polygons[m].hasOwnProperty(B)){var v=v+"M",x=0,y=0,z=!0;l=0;t=-90;w=-180;p=90;r=180;var s=[],D;for(D in a.map[d].geometry[e].polygons[m][B])a.map[d].geometry[e].polygons[m][B].hasOwnProperty(D)&&(z||(v+=" L"),h&&(a.factor[b.usermap]=
Ca(a.map[d].geometry[e].polygons[m][B][D][0],a.map[d].geometry[e].polygons[m][B][D][1]),h=!1),x+=a.map[d].geometry[e].polygons[m][B][D][0]/a.factor[b.usermap],f++,null!=a.map[d].geometry[e].polygons[m][B][D][1]&&(y+=a.map[d].geometry[e].polygons[m][B][D][1]/a.factor[b.usermap],f--),lat2=Math.log(Math.tan(Math.PI/4+y/(a.map[d].precision/a.factor[b.usermap])*Math.PI/360))*(180/Math.PI)*(a.map[d].precision/a.factor[b.usermap]),v+=k(x,a.precision)+" "+k(lat2,a.precision),z=!1,l+=1,t=y*a.factor[b.usermap]/
a.map[d].precision>t?y*a.factor[b.usermap]/a.map[d].precision:t,w=x*a.factor[b.usermap]/a.map[d].precision>w?x*a.factor[b.usermap]/a.map[d].precision:w,p=y*a.factor[b.usermap]/a.map[d].precision<p?y*a.factor[b.usermap]/a.map[d].precision:p,r=x*a.factor[b.usermap]/a.map[d].precision<r?x*a.factor[b.usermap]/a.map[d].precision:r,s[l-1]={},s[l-1].lat=y*a.factor[b.usermap]/a.map[d].precision,s[l-1].lng=x*a.factor[b.usermap]/a.map[d].precision);(t-p)*(w-r)>=g&&(g=(t-p)*(w-r),n.length=0,n=s.slice(),s.length=
0);v+=" Z "}u.setAttribute("d",v)}}}t=n.length;n[t]={};n[t].lat=n[0].lat;n[t].lng=n[0].lng;n=Ba(n);t=n.lat;w=n.lng;a.geometry[b.usermap][c].centroid={};a.geometry[b.usermap][c].centroid.lat=t;a.geometry[b.usermap][c].centroid.lng=w;a.geoareasize[b.usermap].push({id:c,area:g})}m=q("g");a.g[b.usermap].appendChild(m);m.setAttribute("id","imap5_"+b.usermap+"_centerref");B=q("g");D=q("circle");B.appendChild(D);m.appendChild(B);D.setAttribute("cx",0);D.setAttribute("cy",0);D.setAttribute("r",0);D.setAttribute("stroke",
"#006600");D.setAttribute("stroke-width",0);D.setAttribute("fill","#ff0000");B.setAttribute("transform","scale(1,-1)");a.center[b.usermap]=m;a.center[b.usermap].setAttribute("transform","scale("+k(a.map[d].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")");if("undefined"!=typeof a.usermap[b.usermap].map.geometry_default.geometryAbbreviation&&"undefined"!=typeof a.usermap[b.usermap].map.geometry_default.geometryAbbreviation.enable&&a.usermap[b.usermap].map.geometry_default.geometryAbbreviation.enable)for(e in ia.label.style=
a.usermap[b.usermap].map.geometry_default.geometryAbbreviation.style,a.geometry[b.usermap])!a.geometry[b.usermap].hasOwnProperty(e)||"undefined"!=typeof a.usermap[b.usermap].map.geometry[e].hideAbbreviation&&a.usermap[b.usermap].map.geometry[e].hideAbbreviation||(m={},m.name=ia.name,m.lat=a.geometry[b.usermap][e].centroid.lat,m.lng=a.geometry[b.usermap][e].centroid.lng,m.label={},m.label.text="undefined"==typeof a.usermap[b.usermap].map.geometry[e].title?"":a.usermap[b.usermap].map.geometry[e].title,
m.label.style={},m.label.style=Object(ia.label.style),a.mapabbr[b.usermap][e]=new Ga(b,e,m));if("undefined"!=typeof a.usermap[b.usermap].map.bubblemap&&"undefined"!=typeof a.usermap[b.usermap].map.bubblemap.enable&&a.usermap[b.usermap].map.bubblemap.enable){m=0;for(e in a.geometry[b.usermap])a.mapbubblesize[b.usermap].push({id:a.geometry[b.usermap][e].id,bubblesize:Math.abs(a.usermap[b.usermap].map.geometry[e].bubblevalue)}),Math.abs(a.usermap[b.usermap].map.geometry[e].bubblevalue)>=m&&(m=Math.abs(a.usermap[b.usermap].map.geometry[e].bubblevalue));
a.mapbubblesize[b.usermap].sort(function(a,b){return b.bubblesize-a.bubblesize});a.usermap[b.usermap].map.bubblemap.maxbubble=m;for(m=0;m<a.mapbubblesize[b.usermap].length;m++)a.mapbubblesize[b.usermap].hasOwnProperty(m)&&(e=a.mapbubblesize[b.usermap][m].id,a.geometry[b.usermap].hasOwnProperty(e)&&(B={},B.lat=a.geometry[b.usermap][e].centroid.lat,B.lng=a.geometry[b.usermap][e].centroid.lng,B.bubblevalue=a.usermap[b.usermap].map.geometry[e].bubblevalue,a.mapbubble[b.usermap][e]=new na(b,e,B)))}if("undefined"!=
typeof a.usermap[b.usermap].map.piechart&&"undefined"!=typeof a.usermap[b.usermap].map.piechart.enable&&a.usermap[b.usermap].map.piechart.enable)for(e in a.geometry[b.usermap])a.geometry[b.usermap].hasOwnProperty(e)&&(m={},m.lat=a.geometry[b.usermap][e].centroid.lat,m.lng=a.geometry[b.usermap][e].centroid.lng,m.pievalue=a.usermap[b.usermap].map.geometry[e].pievalue,a.piechart[b.usermap][e]=new oa(b,e,m));for(e in a.usermap[b.usermap].map.mappoly)a.usermap[b.usermap].map.mappoly.hasOwnProperty(e)&&
(a.mappoly[b.usermap][e]=new ba(b,e,a.usermap[b.usermap].map.mappoly[e]));for(e in a.usermap[b.usermap].map.maprect)a.usermap[b.usermap].map.maprect.hasOwnProperty(e)&&(a.maprect[b.usermap][e]=new ca(b,e,a.usermap[b.usermap].map.maprect[e]));for(e in a.usermap[b.usermap].map.mappath)a.usermap[b.usermap].map.mappath.hasOwnProperty(e)&&(a.mappath[b.usermap][e]=new aa(b,e,a.usermap[b.usermap].map.mappath[e]));for(e in a.usermap[b.usermap].map.mapcurve)a.usermap[b.usermap].map.mapcurve.hasOwnProperty(e)&&
(a.mapcurve[b.usermap][e]=new da(b,e,a.usermap[b.usermap].map.mapcurve[e]));for(e in a.usermap[b.usermap].map.maplabel)a.usermap[b.usermap].map.maplabel.hasOwnProperty(e)&&(a.maplabel[b.usermap][e]=new qa(b,e,a.usermap[b.usermap].map.maplabel[e]));for(e in a.usermap[b.usermap].map.marker)a.usermap[b.usermap].map.marker.hasOwnProperty(e)&&(a.marker[b.usermap][e]=new pa(b,e,a.usermap[b.usermap].map.marker[e]));for(e in a.usermap[b.usermap].map.maplegend)a.usermap[b.usermap].map.maplegend.hasOwnProperty(e)&&
(a.maplegend[b.usermap][e]=new ra(b,e,a.usermap[b.usermap].map.maplegend[e]));"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&"undefined"!=typeof a.usermap[b.usermap].map.categorylegend.enable&&a.usermap[b.usermap].map.categorylegend.enable&&(a.categorylegend[b.usermap]=new la(b,a.usermap[b.usermap].map.categorylegend),S(b));"undefined"!=typeof a.usermap[b.usermap].map.maptitle&&(a.maptitle[b.usermap]=new ma(b,a.usermap[b.usermap].map.maptitle));f+a.map[d].precision!=a.map[d].point&&
Fa(b);Ea(b);ja(b);a.zoom[b.usermap].loadeditingsetting?C(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx):Z(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currentlat,a.zoom[b.usermap].currentlng)},y=function(a,d){var h=d.getScreenCTM();return a.matrixTransform(h.inverse())},u=function(a){return Math.log(Math.tan(Math.PI/4+Math.PI*a/360))*(180/Math.PI)},O=function(b){return 360*(Math.atan(Math.pow(Math.E,b.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI},
ua={name:"Path 1",points:"",style:{stroke:"#000000",strokeWidth:"2",strokeOpacity:"1"}},ia={name:"Label 1",label:{text:"",style:{fontSize:"12px",fontColor:"#000000",fontFamily:"Arial",fontStyle:"italic",fontWeight:"bold"}}},va={name:"Polygon 1",points:"",fill:"#000000",fillOpacity:0.5,style:{stroke:"#000000",strokeWidth:"2",strokeOpacity:"1"}},wa={name:"Rectangle 1",points:"",fill:"#000000",fillOpacity:0.5,style:{stroke:"#000000",strokeWidth:"2",strokeOpacity:"1"}},xa={name:"Curve 1",points:"",style:{stroke:"#000000",
strokeWidth:"2",strokeOpacity:"1"}},pa=function(b,d,h){var f=a.usermap[b.usermap].map.id,g=q("g");a.g[b.usermap].appendChild(g);g._options=h;g._id=d;g.setAttribute("id","imap5_"+b.usermap+"_marker_"+d);g._lat=h.lat;g._lng=h.lng;g._dx=a.map[f].precision/a.factor[b.usermap]*g._lng;g._dy=u(g._lat)*(a.map[f].precision/a.factor[b.usermap]);g._show=!0;g.setPosition=function(c){this._lat=a.usermap[b.usermap].map.marker[this._id].lat=c.lat;this._lng=a.usermap[b.usermap].map.marker[this._id].lng=c.lng;this._dy=
u(this._lat)*(a.map[f].precision/a.factor[b.usermap]);this._dx=a.map[f].precision/a.factor[b.usermap]*this._lng;g.setAttribute("transform","translate("+k(this._dx,a.precision)+","+k(this._dy,a.precision)+") scale("+k(a.map[f].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")};g.getPosition=function(){var a={};a.lat=this._lat;a.lng=this._lng;return a};g.setIcon=function(a){this._options.icon=a;this.drawMarker()};g.setOptions=function(a){this._options=a};g.setLabel=function(a){this._options.label=
a;this.drawMarker()};g.hide=function(){this.style.visibility="hidden";this._show=!1};g.show=function(){this.style.visibility="visible";this._show=!0};g.toggleCategory=function(){"normal"==a.mode[b.usermap]?"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&a.usermap[b.usermap].map.categorylegend.enable?0!=this._options.categoryid&&("undefined"!=typeof a.categorylegend[b.usermap]?-1!=a.categorylegend[b.usermap].visiblelist.indexOf(this._options.categoryid)?this.show():this.hide():this.show()):
this.show():this.show()};g.drawMarker=function(){var c=this.getElementsByTagName("g")[0];"undefined"!=typeof c&&this.removeChild(c);c=this.getElementsByTagName("text")[0];"undefined"!=typeof c&&this.removeChild(c);var c=q("g"),e=q("image");c.appendChild(e);this.appendChild(c);"local"==this._options.icon.type?e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a.base[b.usermap]+this._options.icon.path):e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this._options.icon.path);e.setAttribute("x",
this._options.icon.anchorx);e.setAttribute("y",this._options.icon.anchory);e.setAttribute("width",this._options.icon.width);e.setAttribute("height",this._options.icon.height);c.setAttribute("transform","scale(1,-1)");if(""!=this._options.label.text){e=q("text");this.appendChild(e);var d=document.createTextNode(this._options.label.text);e.appendChild(d);e.setAttribute("style","stroke-width:0;pointer-events:none");e.style.strokeOpacity=0;e.style.fontFamily=this._options.label.style.fontFamily;e.style.fill=
this._options.label.style.fontColor;e.style.fontSize=this._options.label.style.fontSize;e.style.fontStyle="undefined"!==typeof this._options.label.style.fontStyle?this._options.label.style.fontStyle:"normal";e.style.fontWeight="undefined"!==typeof this._options.label.style.fontWeight?this._options.label.style.fontWeight:"normal";var d="middle",g=0,h=0;switch(this._options.label.position){case "right":d="start";g=c.getBBox().width/2+parseInt(this._options.label.offsetX);h=parseInt(e.style.fontSize)/
2-(e.getBBox().height+e.getBBox().y)/2+parseInt(this._options.label.offsetY);break;case "top":d="middle";g=0+parseInt(this._options.label.offsetX);h=-c.getBBox().height/2-(e.getBBox().height+e.getBBox().y)/2+parseInt(this._options.label.offsetY);break;case "left":d="end";g=c.getBBox().x+parseInt(this._options.label.offsetX);h=parseInt(e.style.fontSize)/2-(e.getBBox().height+e.getBBox().y)/2+parseInt(this._options.label.offsetY);break;case "bottom":d="middle";g=0+parseInt(this._options.label.offsetX);
h=c.getBBox().height/2+parseInt(e.style.fontSize)-(e.getBBox().height+e.getBBox().y)/2+parseInt(this._options.label.offsetY);break;case "center":d="middle",g=0+parseInt(this._options.label.offsetX),h=parseInt(e.style.fontSize)/2-(e.getBBox().height+e.getBBox().y)/2+parseInt(this._options.label.offsetY)}e.setAttribute("x",g);e.setAttribute("y",h);e.setAttribute("transform","scale(1,-1)");e.setAttribute("text-anchor",d)}c=Math.log(Math.tan(Math.PI/4+Math.PI*this._options.lat/360))*(180/Math.PI);e=this._options.lng;
this._lat=a.map[f].precision/a.factor[b.usermap]*c;this._lng=a.map[f].precision/a.factor[b.usermap]*e;this.setAttribute("transform","translate("+k(a.map[f].precision/a.factor[b.usermap]*e,a.precision)+","+k(a.map[f].precision/a.factor[b.usermap]*c,a.precision)+") scale("+k(a.map[f].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")};g.onmouseover=function(c){if("marker"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="pointer";"edit"==a.mode[b.usermap]&&
null==a.selectedOverlay[b.usermap]&&v(b,c,"<strong>[Click]</strong> to select or <strong>[Drag]</strong> to change position");if(!a.touchdevices&&"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.marker[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id].link&&(this.style.cursor="pointer"),"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id].infobox&&
!document.getElementById("imap5_"+b.usermap+"_infobox_marker_"+this._id))){var e={};e.clientX=c.clientX;e.clientY=c.clientY;e.obj="marker";e.infobox=a.usermap[b.usermap].map.marker[this._id].infobox;this.infobox=new A(b,this._id,e)}};g.onmouseout=function(c){if("marker"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="auto";"edit"==a.mode[b.usermap]&&G(b);"normal"==a.mode[b.usermap]&&(this.style.cursor="auto","onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id]&&
"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id].infobox&&(null==c.relatedTarget||c.relatedTarget.id!="imap5_"+b.usermap+"_infobox_marker_"+this._id)&&document.getElementById("imap5_"+b.usermap+"_infobox_marker_"+this._id)&&this.infobox.remove())};g.onmousedown=function(c){c.preventDefault&&c.preventDefault();"edit"==a.mode[b.usermap]&&(c.stopPropagation&&c.stopPropagation(),this._mousedown=!0,this._mapdragged=!1,this._x=c.clientX,this._y=c.clientY,a.selectedOverlay[b.usermap]=this)};
g.onmousemove=function(c){c.preventDefault&&c.preventDefault();if("edit"==a.mode[b.usermap])if(a.selectedOverlay[b.usermap]==this){if(c.stopPropagation&&c.stopPropagation(),this._mousedown&&(2<Math.abs(c.clientX-this._x)||2<Math.abs(c.clientY-this._y))){this._mapdragged=!0;this._x=c.clientX;this._y=c.clientY;var e=a.svgcoord[b.usermap];e.x=c.clientX;e.y=c.clientY;e=y(e,a.g[b.usermap]);e.x/=a.map[f].precision/a.factor[b.usermap];e.y/=a.map[f].precision/a.factor[b.usermap];var d=e.x,g=360*(Math.atan(Math.pow(Math.E,
e.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI;P(g,d)||(this._lat=a.map[f].precision/a.factor[b.usermap]*e.y,this._lng=a.map[f].precision/a.factor[b.usermap]*e.x,this.setAttribute("transform","translate("+k(this._lng,a.precision)+","+k(this._lat,a.precision)+") scale("+k(a.map[f].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")"))}}else if(null!=a.selectedOverlay[b.usermap])a.selectedOverlay[b.usermap].onmousemove(c);"normal"==a.mode[b.usermap]&&(a.div[b.usermap]._mousedown?
document.getElementById("imap5_"+b.usermap+"_infobox_marker_"+this._id)&&this.infobox.hide():document.getElementById("imap5_"+b.usermap+"_infobox_marker_"+this._id)&&(this.infobox.reposition(c.clientX,c.clientY),this.infobox.show()))};g.onmouseup=function(c){c.preventDefault&&c.preventDefault();if("edit"==a.mode[b.usermap])if(a.selectedOverlay[b.usermap]==this)c.stopPropagation&&c.stopPropagation(),a.selectedOverlay[b.usermap]=null,c={event:"poschange",object:"marker"},c.id=Number(this._id),c.lat=
k(360*(Math.atan(Math.pow(Math.E,this._lat/(a.map[f].precision/a.factor[b.usermap])*Math.PI/180))-Math.PI/4)/Math.PI,a.precision),c.lng=k(this._lng/(a.map[f].precision/a.factor[b.usermap]),a.precision),window.console&&console.log(JSON.stringify(c)),this._mousedown=!1;else if(null!=a.selectedOverlay[b.usermap])a.selectedOverlay[b.usermap].onmouseup(c)};g.onclick=function(c){this._mapdragged||this._transformed||a.div[b.usermap]._mapdragged||("edit"==a.mode[b.usermap]?(c={event:"click",object:"marker"},
c.id=Number(this._id),window.console&&console.log(JSON.stringify(c))):"normal"==a.mode[b.usermap]&&"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id].link&&("undefined"==typeof a.usermap[b.usermap].map.marker[this._id].link_target?location.href=a.usermap[b.usermap].map.marker[this._id].link:window.open(a.usermap[b.usermap].map.marker[this._id].link,a.usermap[b.usermap].map.marker[this._id].link_target)))};a.touchdevices&&(g.ontouchstart=
function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)},g.ontouchmove=function(a){1==a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-this._posX)||10<Math.abs(a.touches[0].clientY-this._posY))&&(this._move=!0):this._touch=!1},g.ontouchend=function(c){if(this._touch&&!this._move&&!a.div[b.usermap]._mapdragged){if("edit"==a.mode[b.usermap]){c={event:"click",object:"marker"};c.id=this._id;window.console&&console.log(JSON.stringify(c));
return}"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id].link&&("undefined"==typeof a.usermap[b.usermap].map.marker[this._id].link_target?location.href=a.usermap[b.usermap].map.marker[this._id].link:window.open(a.usermap[b.usermap].map.marker[this._id].link,a.usermap[b.usermap].map.marker[this._id].link_target));if("edit"==a.mode[b.usermap])return;0<a.infobox[b.usermap].length&&(document.getElementById("imap5_"+b.usermap+"_infobox_"+
a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)&&a.div[b.usermap].removeChild(document.getElementById("imap5_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)),a.infobox[b.usermap].pop());"undefined"==typeof a.usermap[b.usermap].map.marker[this._id]||"undefined"==typeof a.usermap[b.usermap].map.marker[this._id].infobox||document.getElementById("imap5_"+b.usermap+"_infobox_marker_"+this._id)||(c={},c.clientX=this._posX,c.clientY=this._posY,c.obj=
"marker",c.infobox=a.usermap[b.usermap].map.marker[this._id].infobox,this.infobox=new A(b,this._id,c))}this._move=this._touch=!1});g.remove=function(){a.g[b.usermap].removeChild(this);a.marker[b.usermap][this._id]=null};g.drawMarker();return g},qa=function(b,d,h){var f=a.usermap[b.usermap].map.id,g=q("g");a.g[b.usermap].appendChild(g);g._options=h;g._id=d;g.setAttribute("id","imap5_"+b.usermap+"_maplabel_"+d);g._lat=h.lat;g._lng=h.lng;g._dx=a.map[f].precision/a.factor[b.usermap]*g._lng;g._dy=u(g._lat)*
(a.map[f].precision/a.factor[b.usermap]);g._show=!0;g.setPosition=function(c){this._lat=a.usermap[b.usermap].map.maplabel[this._id].lat=c.lat;this._lng=a.usermap[b.usermap].map.maplabel[this._id].lng=c.lng;this._dy=u(this._lat)*(a.map[f].precision/a.factor[b.usermap]);this._dx=a.map[f].precision/a.factor[b.usermap]*this._lng;g.setAttribute("transform","translate("+k(this._dx,a.precision)+","+k(this._dy,a.precision)+") scale("+k(a.map[f].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,
a.precision)+")")};g.getPosition=function(){var a={};a.lat=this._lat;a.lng=this._lng;return a};g.setOptions=function(a){this._options=a};g.setLabel=function(a){this._options.label=a;this.drawMapLabel()};g.hide=function(){this.style.visibility="hidden";this._show=!1};g.show=function(){this.style.visibility="visible";this._show=!0};g.toggleCategory=function(){"normal"==a.mode[b.usermap]?"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&a.usermap[b.usermap].map.categorylegend.enable?0!=this._options.categoryid&&
("undefined"!=typeof a.categorylegend[b.usermap]?-1!=a.categorylegend[b.usermap].visiblelist.indexOf(this._options.categoryid)?this.show():this.hide():this.show()):this.show():this.show()};g.drawMapLabel=function(){if(this.hasChildNodes())for(;1<=this.childNodes.length;)this.removeChild(this.firstChild);if(""!=this._options.label.text){var c=q("text");this.appendChild(c);var e=q("text");this.appendChild(e);var d=document.createTextNode(this._options.label.text);e.appendChild(d);e.setAttribute("style",
"stroke-width:0");e.style.strokeOpacity=0;e.style.fontFamily=this._options.label.style.fontFamily;e.style.fill=this._options.label.style.fontColor;e.style.fontSize=this._options.label.style.fontSize;e.style.fontStyle=this._options.label.style.fontStyle;e.style.fontWeight=this._options.label.style.fontWeight;"normal"==a.mode[b.usermap]&&(e.style.pointerEvents="none");d=0+parseInt(e.style.fontSize)/2-(e.getBBox().height+e.getBBox().y)/2;e.setAttribute("x",0);e.setAttribute("y",d);e.setAttribute("transform",
"scale(1,-1)");e.setAttribute("text-anchor","middle");e=document.createTextNode(this._options.label.text);c.appendChild(e);c.setAttribute("style","stroke-width:0");c.style.strokeOpacity=0;c.style.fontFamily=this._options.label.style.fontFamily;c.style.fill="undefined"==typeof this._options.label.style.shadowColor?"#ffffff":this._options.label.style.shadowColor;c.style.fontSize=this._options.label.style.fontSize;c.style.fontStyle=this._options.label.style.fontStyle;c.style.fontWeight=this._options.label.style.fontWeight;
c.style.pointerEvents="none";c.setAttribute("x",1);c.setAttribute("y",d+1);c.setAttribute("transform","scale(1,-1)");c.setAttribute("text-anchor","middle");c.style.fillOpacity="undefined"==typeof this._options.label.style.shadowOpacity?0.7:this._options.label.style.shadowOpacity}c=Math.log(Math.tan(Math.PI/4+Math.PI*this._options.lat/360))*(180/Math.PI);e=this._options.lng;this._lat=a.map[f].precision/a.factor[b.usermap]*c;this._lng=a.map[f].precision/a.factor[b.usermap]*e;this.setAttribute("transform",
"translate("+k(a.map[f].precision/a.factor[b.usermap]*e,a.precision)+","+k(a.map[f].precision/a.factor[b.usermap]*c,a.precision)+") scale("+k(a.map[f].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")};g.onmouseover=function(c){if("maplabel"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="pointer";"edit"==a.mode[b.usermap]&&null==a.selectedOverlay[b.usermap]&&v(b,c,"<strong>[Click]</strong> to select or <strong>[Drag]</strong> to change position")};g.onmouseout=
function(c){if("maplabel"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="auto";"edit"==a.mode[b.usermap]&&G(b);"normal"==a.mode[b.usermap]&&(this.style.cursor="auto")};g.onmousedown=function(c){c.preventDefault&&c.preventDefault();"edit"==a.mode[b.usermap]&&(c.stopPropagation&&c.stopPropagation(),this._mousedown=!0,this._mapdragged=!1,this._x=c.clientX,this._y=c.clientY,a.selectedOverlay[b.usermap]=this)};g.onmousemove=function(c){c.preventDefault&&c.preventDefault();if("edit"==
a.mode[b.usermap])if(a.selectedOverlay[b.usermap]==this){if(c.stopPropagation&&c.stopPropagation(),this._mousedown&&(2<Math.abs(c.clientX-this._x)||2<Math.abs(c.clientY-this._y))){this._mapdragged=!0;this._x=c.clientX;this._y=c.clientY;var e=a.svgcoord[b.usermap];e.x=c.clientX;e.y=c.clientY;e=y(e,a.g[b.usermap]);e.x/=a.map[f].precision/a.factor[b.usermap];e.y/=a.map[f].precision/a.factor[b.usermap];c=e.x;var d=360*(Math.atan(Math.pow(Math.E,e.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI;
P(d,c)||(this._lat=a.map[f].precision/a.factor[b.usermap]*e.y,this._lng=a.map[f].precision/a.factor[b.usermap]*e.x,this.setAttribute("transform","translate("+k(this._lng,a.precision)+","+k(this._lat,a.precision)+") scale("+k(a.map[f].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")"))}}else if(null!=a.selectedOverlay[b.usermap])a.selectedOverlay[b.usermap].onmousemove(c)};g.onmouseup=function(c){c.preventDefault&&c.preventDefault();if("edit"==a.mode[b.usermap])if(a.selectedOverlay[b.usermap]==
this)c.stopPropagation&&c.stopPropagation(),a.selectedOverlay[b.usermap]=null,c={event:"poschange",object:"maplabel"},c.id=Number(this._id),c.lat=k(360*(Math.atan(Math.pow(Math.E,this._lat/(a.map[f].precision/a.factor[b.usermap])*Math.PI/180))-Math.PI/4)/Math.PI,a.precision),c.lng=k(this._lng/(a.map[f].precision/a.factor[b.usermap]),a.precision),window.console&&console.log(JSON.stringify(c)),this._mousedown=!1;else if(null!=a.selectedOverlay[b.usermap])a.selectedOverlay[b.usermap].onmouseup(c)};g.onclick=
function(c){this._mapdragged||this._transformed||"edit"!=a.mode[b.usermap]||(c={event:"click",object:"maplabel"},c.id=Number(this._id),window.console&&console.log(JSON.stringify(c)))};a.touchdevices&&(g.ontouchstart=function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)},g.ontouchmove=function(a){1==a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-this._posX)||10<Math.abs(a.touches[0].clientY-this._posY))&&(this._move=
!0):this._touch=!1},g.ontouchend=function(c){!this._touch||this._move||a.div[b.usermap]._mapdragged||"edit"!=a.mode[b.usermap]?this._move=this._touch=!1:(c={event:"click",object:"maplabel"},c.id=this._id,window.console&&console.log(JSON.stringify(c)))});g.remove=function(){a.g[b.usermap].removeChild(this);a.maplabel[b.usermap][this._id]=null};g.drawMapLabel();return g},aa=function(b,d,h){var f=a.usermap[b.usermap].map.id,g=q("g");a.g[b.usermap].appendChild(g);g._options=h;g._id=d;g.setAttribute("id",
"imap5_"+b.usermap+"_mappath_"+d);g._show=!0;g._points=h.points;g._movingpoints="";g._mainvertices=[];g._subvertices=[];g.updateVertices=function(b,e,f){var d=this._points.split(" ");d[b-1]=k(e,a.precision)+","+k(f,a.precision);b="";for(e=0;e<d.length;e++)""!=b&&(b+=" "),b=b+d[e].split(",")[0]+","+d[e].split(",")[1];this._points=this._options.points=b;this.drawMapPath()};g.addVertices=function(b,e,f){for(var d=this._points.split(" "),g="",h=0;h<d.length;h++)""!=g&&(g+=" "),h==b&&(g=g+k(e,a.precision)+
","+k(f,a.precision)+" "),g=g+d[h].split(",")[0]+","+d[h].split(",")[1];this._points=this._options.points=g;this.drawMapPath();this.postPosChange()};g.removeVertices=function(a){var b=this._points.split(" ");if(2<b.length){for(var f="",d=0;d<b.length;d++)d!=a-1&&(""!=f&&(f+=" "),f=f+b[d].split(",")[0]+","+b[d].split(",")[1]);this._points=this._options.points=f;this.drawMapPath();this.postPosChange()}};g.postPosChange=function(){this.createVertices();var a={event:"poschange",object:"mappath"};a.id=
Number(this._id);a.points=this._points;window.console&&console.log(JSON.stringify(a))};g.setPosition=function(c){this._points=a.usermap[b.usermap].map.mappath[this._id].points=c.points;this.drawMapPath()};g.getPosition=function(){var a={};a.points=this._points;return a};g.setOptions=function(a){this._options=a};g.addPoint=function(a,b){var f=this._options.points;this._options.points=this._points=f+" "+a+","+b;this.drawMapPath()};g.hide=function(){this.style.visibility="hidden";this._show=!1};g.show=
function(){this.style.visibility="visible";this._show=!0};g.toggleCategory=function(){"normal"==a.mode[b.usermap]?"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&a.usermap[b.usermap].map.categorylegend.enable?0!=this._options.categoryid&&("undefined"!=typeof a.categorylegend[b.usermap]?-1!=a.categorylegend[b.usermap].visiblelist.indexOf(this._options.categoryid)?this.show():this.hide():this.show()):this.show():this.show()};g.drawMapPath=function(){if(this.hasChildNodes())for(;1<=this.childNodes.length;)this.removeChild(this.firstChild);
var c,e,d,g,h,m,p,r;h=q("polyline");this.appendChild(h);h.setAttribute("fill","none");h.setAttribute("stroke",this._options.style.stroke);h.setAttribute("stroke-width",k(this._options.style.strokeWidth/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision));if("undefined"!=typeof this._options.style.strokeDasharray&&"none"!==this._options.style.strokeDasharray){p=this._options.style.strokeDasharray.split(",");c="";for(m=0;m<p.length;m++)""!=c&&(c+=","),c+=k(p[m]/a.zoom[b.usermap].currentzoom*
(a.map[f].precision/a.factor[b.usermap]),a.precision);h.setAttribute("stroke-dasharray",c)}p=this._options.points.split(" ");c="";for(m=0;m<p.length;m++)""!=c&&(c+=" "),d=p[m].split(","),e=u(d[0])*(a.map[f].precision/a.factor[b.usermap]),d=a.map[f].precision/a.factor[b.usermap]*d[1],c=c+k(d,a.precision)+","+k(e,a.precision);""!=this._movingpoints&&(d=this._movingpoints.split(","),e=u(d[0])*(a.map[f].precision/a.factor[b.usermap]),d=a.map[f].precision/a.factor[b.usermap]*d[1],""!=c&&(c+=" "),c=c+k(d,
a.precision)+","+k(e,a.precision));h.setAttribute("points",c);h.setAttribute("stroke-opacity",this._options.style.strokeOpacity);h.setAttribute("stroke-linejoin","round");r=c.split(" ");var l=r.length;if(1<l){c=parseFloat(r[0].split(",")[0]);e=parseFloat(r[0].split(",")[1]);d=parseFloat(r[1].split(",")[0]);g=parseFloat(r[1].split(",")[1]);h=parseFloat(r[l-2].split(",")[0]);m=parseFloat(r[l-2].split(",")[1]);p=parseFloat(r[l-1].split(",")[0]);r=parseFloat(r[l-1].split(",")[1]);switch("undefined"==
typeof this._options.style.arrowStartType?0:this._options.style.arrowStartType){case 1:var l=parseInt(this._options.style.strokeWidth)+4,s=q("polygon");this.appendChild(s);s.setAttribute("fill",this._options.style.stroke);s.setAttribute("fill-opacity",this._options.style.strokeOpacity);s.setAttribute("stroke",this._options.style.stroke);s.setAttribute("stroke-width",0);s.setAttribute("points",V(c,e,k(l/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision),H(c,e,d,g,0)));
break;case 2:l=parseInt(this._options.style.strokeWidth)+2;s=q("path");this.appendChild(s);s.setAttribute("fill","none");s.setAttribute("stroke",this._options.style.stroke);s.setAttribute("stroke-opacity",this._options.style.strokeOpacity);s.setAttribute("stroke-width",k(parseInt(this._options.style.strokeWidth)/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision));s.setAttribute("d",W(c,e,k(l/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision),
H(c,e,d,g,0)));s.setAttribute("stroke-linejoin","round");s.setAttribute("stroke-linecap","round");break;case 3:l=parseInt(this._options.style.strokeWidth)+2,s=q("circle"),this.appendChild(s),s.setAttribute("cx",c),s.setAttribute("cy",e),s.setAttribute("r",k(l/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision)),s.setAttribute("stroke","#EEEEEE"),s.setAttribute("stroke-width",0),s.setAttribute("fill",this._options.style.stroke),s.setAttribute("fill-opacity",this._options.style.strokeOpacity)}switch("undefined"==
typeof this._options.style.arrowEndType?0:this._options.style.arrowEndType){case 1:l=parseInt(this._options.style.strokeWidth)+4;c=q("polygon");this.appendChild(c);c.setAttribute("fill",this._options.style.stroke);c.setAttribute("fill-opacity",this._options.style.strokeOpacity);c.setAttribute("stroke",this._options.style.stroke);c.setAttribute("stroke-width",0);c.setAttribute("points",V(p,r,k(l/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision),H(h,m,p,r,1)));break;
case 2:l=parseInt(this._options.style.strokeWidth)+2;c=q("path");this.appendChild(c);c.setAttribute("fill","none");c.setAttribute("stroke",this._options.style.stroke);c.setAttribute("stroke-opacity",this._options.style.strokeOpacity);c.setAttribute("stroke-width",k(parseInt(this._options.style.strokeWidth)/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision));c.setAttribute("d",W(p,r,k(l/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision),
H(h,m,p,r,1)));c.setAttribute("stroke-linejoin","round");c.setAttribute("stroke-linecap","round");break;case 3:l=parseInt(this._options.style.strokeWidth)+2,c=q("circle"),this.appendChild(c),c.setAttribute("cx",p),c.setAttribute("cy",r),c.setAttribute("r",k(l/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision)),c.setAttribute("stroke","#EEEEEE"),c.setAttribute("stroke-width",0),c.setAttribute("fill",this._options.style.stroke),c.setAttribute("fill-opacity",this._options.style.strokeOpacity)}}};
g.onmouseover=function(c){if("mappath"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="pointer";"edit"==a.mode[b.usermap]&&v(b,c,"Click to select");if(!a.touchdevices&&"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id].link&&(this.style.cursor="pointer"),"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id]&&"undefined"!=
typeof a.usermap[b.usermap].map.mappath[this._id].infobox&&!document.getElementById("imap5_"+b.usermap+"_infobox_mappath_"+this._id))){var e={};e.clientX=c.clientX;e.clientY=c.clientY;e.obj="mappath";e.infobox=a.usermap[b.usermap].map.mappath[this._id].infobox;this.infobox=new A(b,this._id,e)}};g.onmouseout=function(c){if("mappath"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="auto";"edit"==a.mode[b.usermap]&&G(b);"normal"==a.mode[b.usermap]&&(this.style.cursor="auto","onmouseover"==
a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id].infobox&&(null==c.relatedTarget||c.relatedTarget.id!="imap5_"+b.usermap+"_infobox_mappath_"+this._id)&&document.getElementById("imap5_"+b.usermap+"_infobox_mappath_"+this._id)&&this.infobox.remove())};g.onmousemove=function(c){c.preventDefault&&c.preventDefault();"normal"==a.mode[b.usermap]&&(a.div[b.usermap]._mousedown?document.getElementById("imap5_"+
b.usermap+"_infobox_mappath_"+this._id)&&this.infobox.hide():document.getElementById("imap5_"+b.usermap+"_infobox_mappath_"+this._id)&&(this.infobox.reposition(c.clientX,c.clientY),this.infobox.show()))};g.createVertices=function(){null!=a.selectedVerticesObj[b.usermap]&&a.selectedVerticesObj[b.usermap]!=this&&a.selectedVerticesObj[b.usermap].deleteVertices();a.selectedVerticesObj[b.usermap]=this;for(var c in this._mainvertices)this._mainvertices.hasOwnProperty(c)&&this._mainvertices[c].remove();
this._mainvertices.length=0;for(var e in this._subvertices)this._subvertices.hasOwnProperty(e)&&this._subvertices[e].remove();this._subvertices.length=0;var f=this._points.split(" "),d={};for(c=0;c<f.length;c++)e=f[c].split(","),d.lat=e[0],d.lng=e[1],d.type=0,d.removable=!0,this._mainvertices[c+1]=new N(b,c+1,this,d),d={};var g,d={};for(e=0;e<f.length-1;e++)c=f[e].split(","),g=f[e+1].split(","),d.lat=k(O((u(c[0])+u(g[0]))/2),a.precision),d.lng=k((parseFloat(c[1])+parseFloat(g[1]))/2,a.precision),
d.type=1,d.removable=!1,this._subvertices[e+1]=new N(b,e+1,this,d),d={}};g.deleteVertices=function(){for(var a in this._mainvertices)this._mainvertices.hasOwnProperty(a)&&this._mainvertices[a].remove();this._mainvertices.length=0;for(var b in this._subvertices)this._subvertices.hasOwnProperty(b)&&this._subvertices[b].remove();this._subvertices.length=0};g.hideSubVertices=function(){for(var a in this._subvertices)this._subvertices.hasOwnProperty(a)&&this._subvertices[a].hide()};g.showSubVertices=function(){for(var a in this._subvertices)this._subvertices.hasOwnProperty(a)&&
this._subvertices[a].show()};g.onclick=function(c){this._mapdragged||this._transformed||a.div[b.usermap]._mapdragged||("edit"==a.mode[b.usermap]?(this.createVertices(),c={event:"click",object:"mappath"},c.id=Number(this._id),window.console&&console.log(JSON.stringify(c))):"normal"==a.mode[b.usermap]&&"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id].link&&("undefined"==typeof a.usermap[b.usermap].map.mappath[this._id].link_target?
location.href=a.usermap[b.usermap].map.mappath[this._id].link:window.open(a.usermap[b.usermap].map.mappath[this._id].link,a.usermap[b.usermap].map.mappath[this._id].link_target)))};a.touchdevices&&(g.ontouchstart=function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)},g.ontouchmove=function(a){1==a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-this._posX)||10<Math.abs(a.touches[0].clientY-this._posY))&&(this._move=
!0):this._touch=!1},g.ontouchend=function(c){if(this._touch&&!this._move&&!a.div[b.usermap]._mapdragged){if("edit"==a.mode[b.usermap]){c={event:"click",object:"mappath"};c.id=this._id;window.console&&console.log(JSON.stringify(c));return}"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id].link&&("undefined"==typeof a.usermap[b.usermap].map.mappath[this._id].link_target?location.href=a.usermap[b.usermap].map.mappath[this._id].link:
window.open(a.usermap[b.usermap].map.mappath[this._id].link,a.usermap[b.usermap].map.mappath[this._id].link_target));if("edit"==a.mode[b.usermap])return;0<a.infobox[b.usermap].length&&(document.getElementById("imap5_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)&&a.div[b.usermap].removeChild(document.getElementById("imap5_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)),a.infobox[b.usermap].pop());"undefined"==typeof a.usermap[b.usermap].map.mappath[this._id]||
"undefined"==typeof a.usermap[b.usermap].map.mappath[this._id].infobox||document.getElementById("imap5_"+b.usermap+"_infobox_mappath_"+this._id)||(c={},c.clientX=this._posX,c.clientY=this._posY,c.obj="mappath",c.infobox=a.usermap[b.usermap].map.mappath[this._id].infobox,this.infobox=new A(b,this._id,c))}this._move=this._touch=!1});g.remove=function(){for(var c in this._mainvertices)this._mainvertices.hasOwnProperty(c)&&this._mainvertices[c].remove();for(c in this._subvertices)this._subvertices.hasOwnProperty(c)&&
this._subvertices[c].remove();a.g[b.usermap].removeChild(this);a.mappath[b.usermap][this._id]=null};g.drawMapPath();return g},ba=function(b,d,h){var f=a.usermap[b.usermap].map.id,g=q("g");a.g[b.usermap].appendChild(g);g._options=h;g._id=d;g.setAttribute("id","imap5_"+b.usermap+"_mappoly_"+d);g._points=h.points;g._movingpoints="";g._mainvertices=[];g._subvertices=[];g.ishighlight=!1;g._show=!0;g.updateVertices=function(b,e,f){var d=this._points.split(" ");d[b-1]=k(e,a.precision)+","+k(f,a.precision);
b="";for(e=0;e<d.length;e++)""!=b&&(b+=" "),b=b+d[e].split(",")[0]+","+d[e].split(",")[1];this._points=this._options.points=b;this.drawMapPoly()};g.addVertices=function(b,e,f){for(var d=this._points.split(" "),g="",h=0;h<d.length;h++)""!=g&&(g+=" "),h==b&&(g=g+k(e,a.precision)+","+k(f,a.precision)+" "),g=g+d[h].split(",")[0]+","+d[h].split(",")[1];b==d.length&&(""!=g&&(g+=" "),g=g+k(e,a.precision)+","+k(f,a.precision));this._points=this._options.points=g;this.drawMapPoly();this.postPosChange()};g.removeVertices=
function(a){var b=this._points.split(" ");if(3<b.length){for(var f="",d=0;d<b.length;d++)d!=a-1&&(""!=f&&(f+=" "),f=f+b[d].split(",")[0]+","+b[d].split(",")[1]);this._points=this._options.points=f;this.drawMapPoly();this.postPosChange()}};g.postPosChange=function(){this.createVertices();var a={event:"poschange",object:"mappoly"};a.id=Number(this._id);a.points=this._points;window.console&&console.log(JSON.stringify(a))};g.setPosition=function(c){this._points=a.usermap[b.usermap].map.mappoly[this._id].points=
c.points;this.drawMapPoly()};g.getPosition=function(){var a={};a.points=this._points;return a};g.setOptions=function(a){this._options=a;this._points=a.points};g.addPoint=function(a,b){var f=this._options.points;this._options.points=this._points=f+" "+a+","+b;this.drawMapPoly()};g.hide=function(){this.style.visibility="hidden";this._show=!1};g.show=function(){this.style.visibility="visible";this._show=!0};g.toggleCategory=function(){"normal"==a.mode[b.usermap]?"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&
a.usermap[b.usermap].map.categorylegend.enable?0!=this._options.categoryid&&("undefined"!=typeof a.categorylegend[b.usermap]?-1!=a.categorylegend[b.usermap].visiblelist.indexOf(this._options.categoryid)?this.show():this.hide():this.show()):this.show():this.show()};g.count=function(){return this._options.points.split(" ").length};g.drawMapPoly=function(){var c=this.getElementsByTagName("polygon")[0];"undefined"!=typeof c&&this.removeChild(c);c=this.getElementsByTagName("polyline")[0];"undefined"!=
typeof c&&this.removeChild(c);c=1>=this.count()?q("polyline"):q("polygon");this.appendChild(c);c.setAttribute("fill",this._options.fill);c.setAttribute("fill-opacity",this._options.fillOpacity);c.setAttribute("stroke",this._options.style.stroke);c.setAttribute("stroke-width",k(this._options.style.strokeWidth/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision));if("undefined"!=typeof this._options.style.strokeDasharray&&"none"!==this._options.style.strokeDasharray){for(var e=
this._options.style.strokeDasharray.split(","),d="",g=0;g<e.length;g++)""!=d&&(d+=","),d+=k(e[g]/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision);c.setAttribute("stroke-dasharray",d)}for(var e=this._options.points.split(" "),d="",h,m,g=0;g<e.length;g++)""!=d&&(d+=" "),h=e[g].split(","),m=u(h[0])*(a.map[f].precision/a.factor[b.usermap]),h=a.map[f].precision/a.factor[b.usermap]*h[1],d=d+k(h,a.precision)+","+k(m,a.precision);""!=this._movingpoints&&(h=this._movingpoints.split(","),
m=u(h[0])*(a.map[f].precision/a.factor[b.usermap]),h=a.map[f].precision/a.factor[b.usermap]*h[1],""!=d&&(d+=" "),d=d+k(h,a.precision)+","+k(m,a.precision));c.setAttribute("points",d);c.setAttribute("stroke-opacity",this._options.style.strokeOpacity);c.setAttribute("stroke-linejoin","round")};a.touchdevices||(g.onmouseover=function(c){if("mappoly"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="pointer";"edit"==a.mode[b.usermap]&&null==a.selectedOverlay[b.usermap]&&(v(b,c,"<strong>[Click]</strong> to select and <strong>[Drag]</strong> to change position"),
this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fillHighlight),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillHighlightOpacity));if(!a.touchdevices&&"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id].link&&(this.style.cursor="pointer"),this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fillHighlight),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",
this._options.fillHighlightOpacity),"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id].infobox&&!document.getElementById("imap5_"+b.usermap+"_infobox_mappoly_"+this._id))){var e={};e.clientX=c.clientX;e.clientY=c.clientY;e.obj="mappoly";e.infobox=a.usermap[b.usermap].map.mappoly[this._id].infobox;this.infobox=new A(b,this._id,e)}});a.touchdevices||(g.onmouseout=function(c){if("mappoly"==
a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="auto";"edit"==a.mode[b.usermap]&&(G(b),this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fill),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillOpacity));"normal"==a.mode[b.usermap]&&(this.style.cursor="auto",this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fill),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillOpacity),
"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id].infobox&&(null==c.relatedTarget||c.relatedTarget.id!="imap5_"+b.usermap+"_infobox_mappoly_"+this._id)&&document.getElementById("imap5_"+b.usermap+"_infobox_mappoly_"+this._id)&&this.infobox.remove())});g.onmousedown=function(c){c.preventDefault&&c.preventDefault();"edit"==a.mode[b.usermap]&&(c.stopPropagation&&c.stopPropagation(),
this._mousedown=!0,this._mapdragged=!1,this._x=c.clientX,this._y=c.clientY,a.selectedOverlay[b.usermap]=this)};g.onmouseup=function(c){c.preventDefault&&c.preventDefault();if("edit"==a.mode[b.usermap])if(a.selectedOverlay[b.usermap]==this)c.stopPropagation&&c.stopPropagation(),a.selectedOverlay[b.usermap]=null,this.createVertices(),c={event:"poschange",object:"mappoly"},c.id=Number(this._id),c.points=this._points,window.console&&console.log(JSON.stringify(c)),this._mousedown=!1;else if(null!=a.selectedOverlay[b.usermap])a.selectedOverlay[b.usermap].onmouseup(c)};
g.onmousemove=function(c){c.preventDefault&&c.preventDefault();if("edit"==a.mode[b.usermap])if(a.selectedOverlay[b.usermap]==this){if(this._mousedown&&(c.stopPropagation&&c.stopPropagation(),2<Math.abs(c.clientX-this._x)||2<Math.abs(c.clientY-this._y))){this._mapdragged=!0;var e=k((c.clientX-this._x)/a.zoom[b.usermap].currentzoom,a.precision),f=k((c.clientY-this._y)/a.zoom[b.usermap].currentzoom,a.precision),d=this._points.split(" "),g,h;for(h in d)d.hasOwnProperty(h)&&(g=d[h].split(","),d[h]=k(O(u(parseFloat(g[0]))-
f),a.precision)+","+k(parseFloat(g[1])+e,a.precision));e="";for(h=0;h<d.length;h++)""!=e&&(e+=" "),e=e+d[h].split(",")[0]+","+d[h].split(",")[1];this._points=this._options.points=e;this.deleteVertices();this.drawMapPoly();this.createVertices();this._x=c.clientX;this._y=c.clientY}}else if(null!=a.selectedOverlay[b.usermap])a.selectedOverlay[b.usermap].onmousemove(c);"normal"==a.mode[b.usermap]&&(a.div[b.usermap]._mousedown?document.getElementById("imap5_"+b.usermap+"_infobox_mappoly_"+this._id)&&this.infobox.hide():
document.getElementById("imap5_"+b.usermap+"_infobox_mappoly_"+this._id)&&(this.infobox.reposition(c.clientX,c.clientY),this.infobox.show()))};g.createVertices=function(){null!=a.selectedVerticesObj[b.usermap]&&a.selectedVerticesObj[b.usermap]!=this&&a.selectedVerticesObj[b.usermap].deleteVertices();a.selectedVerticesObj[b.usermap]=this;for(var c in this._mainvertices)this._mainvertices.hasOwnProperty(c)&&this._mainvertices[c].remove();this._mainvertices.length=0;for(var e in this._subvertices)this._subvertices.hasOwnProperty(c)&&
this._subvertices[e].remove();this._subvertices.length=0;var f=this._points.split(" "),d={};for(c=0;c<f.length;c++)e=f[c].split(","),d.lat=e[0],d.lng=e[1],d.type=0,d.removable=!0,this._mainvertices[c+1]=new N(b,c+1,this,d),d={};var g,d={};for(e=0;e<f.length-1;e++)c=f[e].split(","),g=f[e+1].split(","),d.lat=k(O((u(c[0])+u(g[0]))/2),a.precision),d.lng=k((parseFloat(c[1])+parseFloat(g[1]))/2,a.precision),d.type=1,d.removable=!1,this._subvertices[e+1]=new N(b,e+1,this,d),d={};e=f.length-1;c=f[e].split(",");
g=f[0].split(",");d.lat=k(O((u(c[0])+u(g[0]))/2),a.precision);d.lng=k((parseFloat(c[1])+parseFloat(g[1]))/2,a.precision);d.type=1;d.removable=!1;this._subvertices[e+1]=new N(b,e+1,this,d)};g.deleteVertices=function(){for(var a in this._mainvertices)this._mainvertices.hasOwnProperty(a)&&this._mainvertices[a].remove();this._mainvertices.length=0;for(var b in this._subvertices)this._subvertices.hasOwnProperty(b)&&this._subvertices[b].remove();this._subvertices.length=0};g.hideSubVertices=function(){for(var a in this._subvertices)this._subvertices.hasOwnProperty(a)&&
this._subvertices[a].hide()};g.showSubVertices=function(){for(var a in this._subvertices)this._subvertices.hasOwnProperty(a)&&this._subvertices[a].show()};g.onclick=function(c){this._mapdragged||this._transformed||a.div[b.usermap]._mapdragged||("edit"==a.mode[b.usermap]?(this.createVertices(),c={event:"click",object:"mappoly"},c.id=Number(this._id),window.console&&console.log(JSON.stringify(c))):"normal"==a.mode[b.usermap]&&"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id]&&"undefined"!=
typeof a.usermap[b.usermap].map.mappoly[this._id].link&&("undefined"==typeof a.usermap[b.usermap].map.mappoly[this._id].link_target?location.href=a.usermap[b.usermap].map.mappoly[this._id].link:window.open(a.usermap[b.usermap].map.mappoly[this._id].link,a.usermap[b.usermap].map.mappoly[this._id].link_target)))};a.touchdevices&&(g.ontouchstart=function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)},g.ontouchmove=function(a){1==
a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-this._posX)||10<Math.abs(a.touches[0].clientY-this._posY))&&(this._move=!0):this._touch=!1},g.ontouchend=function(c){if(this._touch&&!this._move&&!a.div[b.usermap]._mapdragged){if("edit"==a.mode[b.usermap]){c={event:"click",object:"mappoly"};c.id=this._id;window.console&&console.log(JSON.stringify(c));return}"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id].link&&
("undefined"==typeof a.usermap[b.usermap].map.mappoly[this._id].link_target?location.href=a.usermap[b.usermap].map.mappoly[this._id].link:window.open(a.usermap[b.usermap].map.mappoly[this._id].link,a.usermap[b.usermap].map.mappoly[this._id].link_target));if("edit"==a.mode[b.usermap])return;this.ishighlight?(this.ishighlight=!1,this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fill),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillOpacity)):
(this.ishighlight=!0,this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fillHighlight),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillHighlightOpacity));0<a.infobox[b.usermap].length&&(document.getElementById("imap5_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)&&a.div[b.usermap].removeChild(document.getElementById("imap5_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)),
a.infobox[b.usermap].pop());"undefined"==typeof a.usermap[b.usermap].map.mappoly[this._id]||"undefined"==typeof a.usermap[b.usermap].map.mappoly[this._id].infobox||document.getElementById("imap5_"+b.usermap+"_infobox_mappoly_"+this._id)||(c={},c.clientX=this._posX,c.clientY=this._posY,c.obj="mappoly",c.infobox=a.usermap[b.usermap].map.mappoly[this._id].infobox,this.infobox=new A(b,this._id,c))}this._move=this._touch=!1});g.remove=function(){for(var c in this._mainvertices)this._mainvertices.hasOwnProperty(c)&&
this._mainvertices[c].remove();for(c in this._subvertices)this._subvertices.hasOwnProperty(c)&&this._subvertices[c].remove();a.g[b.usermap].removeChild(this);a.mappoly[b.usermap][this._id]=null};g.drawMapPoly();return g},ca=function(b,d,h){var f=a.usermap[b.usermap].map.id,g=q("g");a.g[b.usermap].appendChild(g);g._options=h;g._id=d;g.setAttribute("id","imap5_"+b.usermap+"_maprect_"+d);g._points=h.points;g._movingpoints="";g._mainvertices=[];g.ishighlight=!1;g._show=!0;g.setOptions=function(a){this._options=
a;this._points=a.points};g.hide=function(){this.style.visibility="hidden";this._show=!1};g.show=function(){this.style.visibility="visible";this._show=!0};g.toggleCategory=function(){"normal"==a.mode[b.usermap]?"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&a.usermap[b.usermap].map.categorylegend.enable?0!=this._options.categoryid&&("undefined"!=typeof a.categorylegend[b.usermap]?-1!=a.categorylegend[b.usermap].visiblelist.indexOf(this._options.categoryid)?this.show():this.hide():this.show()):
this.show():this.show()};g.createVertices=function(){null!=a.selectedVerticesObj[b.usermap]&&a.selectedVerticesObj[b.usermap]!=this&&a.selectedVerticesObj[b.usermap].deleteVertices();a.selectedVerticesObj[b.usermap]=this;for(var c in this._mainvertices)this._mainvertices.hasOwnProperty(c)&&this._mainvertices[c].remove();this._mainvertices.length=0;var e=this._points.split(" "),f,d={};for(c=0;c<e.length;c++)f=e[c].split(","),d.lat=f[0],d.lng=f[1],d.type=0,d.removable=!1,this._mainvertices[c+1]=new N(b,
c+1,this,d),d={}};g.deleteVertices=function(){for(var a in this._mainvertices)this._mainvertices.hasOwnProperty(a)&&this._mainvertices[a].remove();this._mainvertices.length=0};g.postPosChange=function(){this.createVertices();var a={event:"poschange",object:"maprect"};a.id=Number(this._id);a.points=this._points;window.console&&console.log(JSON.stringify(a))};g.updateVertices=function(b,e,f){var d=this._points.split(" ");d[b-1]=k(e,a.precision)+","+k(f,a.precision);d[b-1].split(",");var g=d[(b-1+2)%
4].split(",");d[(b-1+1)%4]=k(g[0],a.precision)+","+k(f,a.precision);d[(b-1+2)%4]=k(g[0],a.precision)+","+k(g[1],a.precision);d[(b-1+3)%4]=k(e,a.precision)+","+k(g[1],a.precision);for(var h="",h="",p=0;p<d.length;p++)""!=h&&(h+=" "),h=h+d[p].split(",")[0]+","+d[p].split(",")[1];this._points=this._options.points=h;d={};d.lat=g[0];d.lng=f;d.type=0;d.removable=!1;this._mainvertices[(b-1+1)%4+1].setOptions(d);this._mainvertices[(b-1+1)%4+1].drawVerticesObj();d={};d.lat=e;d.lng=g[1];d.type=0;d.removable=
!1;this._mainvertices[(b-1+3)%4+1].setOptions(d);this._mainvertices[(b-1+3)%4+1].drawVerticesObj();this.drawMapRect()};g.hideSubVertices=function(){};g.showSubVertices=function(){};g.drawMapRect=function(){var c=this.getElementsByTagName("polygon")[0];"undefined"!=typeof c&&this.removeChild(c);c=q("polygon");this.appendChild(c);c.setAttribute("fill",this._options.fill);c.setAttribute("fill-opacity",this._options.fillOpacity);c.setAttribute("stroke",this._options.style.stroke);c.setAttribute("stroke-width",
k(this._options.style.strokeWidth/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision));if("undefined"!=typeof this._options.style.strokeDasharray&&"none"!==this._options.style.strokeDasharray){for(var e=this._options.style.strokeDasharray.split(","),d="",g=0;g<e.length;g++)""!=d&&(d+=","),d+=k(e[g]/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision);c.setAttribute("stroke-dasharray",d)}var e=this._options.points.split(" "),d="",h,m;m=
g="";if(1==e.length)g=e[0].split(","),m=""==this._movingpoints?g:this._movingpoints.split(","),d=d+k(a.map[f].precision/a.factor[b.usermap]*g[1],a.precision)+",",d=d+k(u(g[0])*(a.map[f].precision/a.factor[b.usermap]),a.precision)+" ",d=d+k(a.map[f].precision/a.factor[b.usermap]*m[1],a.precision)+",",d=d+k(u(g[0])*(a.map[f].precision/a.factor[b.usermap]),a.precision)+" ",d=d+k(a.map[f].precision/a.factor[b.usermap]*m[1],a.precision)+",",d=d+k(u(m[0])*(a.map[f].precision/a.factor[b.usermap]),a.precision)+
" ",d=d+k(a.map[f].precision/a.factor[b.usermap]*g[1],a.precision)+",",d+=k(u(m[0])*(a.map[f].precision/a.factor[b.usermap]),a.precision);else for(g=0;g<e.length;g++)""!=d&&(d+=" "),h=e[g].split(","),m=u(h[0])*(a.map[f].precision/a.factor[b.usermap]),h=a.map[f].precision/a.factor[b.usermap]*h[1],d=d+k(h,a.precision)+","+k(m,a.precision);c.setAttribute("points",d);c.setAttribute("stroke-opacity",this._options.style.strokeOpacity);c.setAttribute("stroke-linejoin","round")};g.onclick=function(c){this._mapdragged||
this._transformed||a.div[b.usermap]._mapdragged||("edit"==a.mode[b.usermap]?(this.createVertices(),c={event:"click",object:"maprect"},c.id=Number(this._id),window.console&&console.log(JSON.stringify(c))):"normal"==a.mode[b.usermap]&&"undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id].link&&("undefined"==typeof a.usermap[b.usermap].map.maprect[this._id].link_target?location.href=a.usermap[b.usermap].map.maprect[this._id].link:
window.open(a.usermap[b.usermap].map.maprect[this._id].link,a.usermap[b.usermap].map.maprect[this._id].link_target)))};a.touchdevices||(g.onmouseover=function(c){if("maprect"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="pointer";"edit"==a.mode[b.usermap]&&null==a.selectedOverlay[b.usermap]&&(v(b,c,"<strong>[Click]</strong> to select and <strong>[Drag]</strong> to change position"),this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fillHighlight),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",
this._options.fillHighlightOpacity));if(!a.touchdevices&&"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id].link&&(this.style.cursor="pointer"),this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fillHighlight),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillHighlightOpacity),"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=
typeof a.usermap[b.usermap].map.maprect[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id].infobox&&!document.getElementById("imap5_"+b.usermap+"_infobox_maprect_"+this._id))){var e={};e.clientX=c.clientX;e.clientY=c.clientY;e.obj="maprect";e.infobox=a.usermap[b.usermap].map.maprect[this._id].infobox;this.infobox=new A(b,this._id,e)}});a.touchdevices||(g.onmouseout=function(c){if("maprect"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="auto";"edit"==a.mode[b.usermap]&&
(G(b),this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fill),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillOpacity));"normal"==a.mode[b.usermap]&&(this.style.cursor="auto",this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fill),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillOpacity),"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id]&&
"undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id].infobox&&(null==c.relatedTarget||c.relatedTarget.id!="imap5_"+b.usermap+"_infobox_maprect_"+this._id)&&document.getElementById("imap5_"+b.usermap+"_infobox_maprect_"+this._id)&&this.infobox.remove())});g.onmousedown=function(c){c.preventDefault&&c.preventDefault();"edit"==a.mode[b.usermap]&&(c.stopPropagation&&c.stopPropagation(),this._mousedown=!0,this._mapdragged=!1,this._x=c.clientX,this._y=c.clientY,a.selectedOverlay[b.usermap]=this)};
g.onmouseup=function(c){c.preventDefault&&c.preventDefault();if("edit"==a.mode[b.usermap])if(a.selectedOverlay[b.usermap]==this)c.stopPropagation&&c.stopPropagation(),a.selectedOverlay[b.usermap]=null,this.createVertices(),c={event:"poschange",object:"maprect"},c.id=Number(this._id),c.points=this._points,window.console&&console.log(JSON.stringify(c)),this._mousedown=!1;else if(null!=a.selectedOverlay[b.usermap])a.selectedOverlay[b.usermap].onmouseup(c)};g.onmousemove=function(c){c.preventDefault&&
c.preventDefault();if("edit"==a.mode[b.usermap])if(a.selectedOverlay[b.usermap]==this){if(this._mousedown&&(c.stopPropagation&&c.stopPropagation(),2<Math.abs(c.clientX-this._x)||2<Math.abs(c.clientY-this._y))){this._mapdragged=!0;var e=k((c.clientX-this._x)/a.zoom[b.usermap].currentzoom,a.precision),d=k((c.clientY-this._y)/a.zoom[b.usermap].currentzoom,a.precision),f=this._points.split(" "),g,h;for(h in f)f.hasOwnProperty(h)&&(g=f[h].split(","),f[h]=k(O(u(parseFloat(g[0]))-d),a.precision)+","+k(parseFloat(g[1])+
e,a.precision));e="";for(h=0;h<f.length;h++)""!=e&&(e+=" "),e=e+f[h].split(",")[0]+","+f[h].split(",")[1];this._points=this._options.points=e;this.deleteVertices();this.drawMapRect();this.createVertices();this._x=c.clientX;this._y=c.clientY}}else if(null!=a.selectedOverlay[b.usermap])a.selectedOverlay[b.usermap].onmousemove(c);"normal"==a.mode[b.usermap]&&(a.div[b.usermap]._mousedown?document.getElementById("imap5_"+b.usermap+"_infobox_maprect_"+this._id)&&this.infobox.hide():document.getElementById("imap5_"+
b.usermap+"_infobox_maprect_"+this._id)&&(this.infobox.reposition(c.clientX,c.clientY),this.infobox.show()))};a.touchdevices&&(g.ontouchstart=function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)},g.ontouchmove=function(a){1==a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-this._posX)||10<Math.abs(a.touches[0].clientY-this._posY))&&(this._move=!0):this._touch=!1},g.ontouchend=function(c){if(this._touch&&!this._move&&
!a.div[b.usermap]._mapdragged){if("edit"==a.mode[b.usermap]){c={event:"click",object:"maprect"};c.id=this._id;window.console&&console.log(JSON.stringify(c));return}"undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id].link&&("undefined"==typeof a.usermap[b.usermap].map.maprect[this._id].link_target?location.href=a.usermap[b.usermap].map.maprect[this._id].link:window.open(a.usermap[b.usermap].map.maprect[this._id].link,a.usermap[b.usermap].map.maprect[this._id].link_target));
if("edit"==a.mode[b.usermap])return;this.ishighlight?(this.ishighlight=!1,this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fill),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillOpacity)):(this.ishighlight=!0,this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fillHighlight),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillHighlightOpacity));0<a.infobox[b.usermap].length&&(document.getElementById("imap5_"+
b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)&&a.div[b.usermap].removeChild(document.getElementById("imap5_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)),a.infobox[b.usermap].pop());"undefined"==typeof a.usermap[b.usermap].map.maprect[this._id]||"undefined"==typeof a.usermap[b.usermap].map.maprect[this._id].infobox||document.getElementById("imap5_"+b.usermap+"_infobox_maprect_"+this._id)||(c={},c.clientX=this._posX,c.clientY=
this._posY,c.obj="maprect",c.infobox=a.usermap[b.usermap].map.maprect[this._id].infobox,this.infobox=new A(b,this._id,c))}this._move=this._touch=!1});g.remove=function(){for(var c in this._mainvertices)this._mainvertices.hasOwnProperty(c)&&this._mainvertices[c].remove();a.g[b.usermap].removeChild(this);a.maprect[b.usermap][this._id]=null};g.drawMapRect();return g},da=function(b,d,h){var f=a.usermap[b.usermap].map.id,g=q("g");a.g[b.usermap].appendChild(g);g._options=h;g._id=d;g.setAttribute("id","imap5_"+
b.usermap+"_mapcurve_"+d);g._points=h.points;g._movingpoints="";g._mainvertices=[];g._show=!0;g.updateVertices=function(b,e,d){var f=this._points.split(" ");f[b-1]=k(e,a.precision)+","+k(d,a.precision);b="";for(e=0;e<f.length;e++)""!=b&&(b+=" "),b=b+f[e].split(",")[0]+","+f[e].split(",")[1];this._points=this._options.points=b;this.drawMapCurve()};g.postPosChange=function(){this.createVertices();var a={event:"poschange",object:"mapcurve"};a.id=Number(this._id);a.points=this._points;window.console&&
console.log(JSON.stringify(a))};g.setPosition=function(c){this._points=a.usermap[b.usermap].map.mapcurve[this._id].points=c.points;this.drawMapCurve()};g.getPosition=function(){var a={};a.points=this._points;return a};g.setOptions=function(a){this._options=a};g.count=function(){return this._options.points.split(" ").length};g.addPoint=function(a,b){var d=this._options.points;this._options.points=this._points=d+" "+a+","+b;this.drawMapCurve()};g.hide=function(){this.style.visibility="hidden";this._show=
!1};g.show=function(){this.style.visibility="visible";this._show=!0};g.toggleCategory=function(){"normal"==a.mode[b.usermap]?"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&a.usermap[b.usermap].map.categorylegend.enable?0!=this._options.categoryid&&("undefined"!=typeof a.categorylegend[b.usermap]?-1!=a.categorylegend[b.usermap].visiblelist.indexOf(this._options.categoryid)?this.show():this.hide():this.show()):this.show():this.show()};g.createVertices=function(){null!=a.selectedVerticesObj[b.usermap]&&
a.selectedVerticesObj[b.usermap]!=this&&a.selectedVerticesObj[b.usermap].deleteVertices();a.selectedVerticesObj[b.usermap]=this;for(var c in this._mainvertices)this._mainvertices.hasOwnProperty(c)&&this._mainvertices[c].remove();this._mainvertices.length=0;var e=this._points.split(" "),d,f={};for(c=0;c<e.length;c++)d=e[c].split(","),f.lat=d[0],f.lng=d[1],f.type=0,f.removable=!1,this._mainvertices[c+1]=new N(b,c+1,this,f),f={}};g.deleteVertices=function(){for(var a in this._mainvertices)this._mainvertices.hasOwnProperty(a)&&
this._mainvertices[a].remove();this._mainvertices.length=0};g.hideSubVertices=function(){};g.showSubVertices=function(){};g.drawMapCurve=function(){if(this.hasChildNodes())for(;1<=this.childNodes.length;)this.removeChild(this.firstChild);var c,e,d,g,h,m,p,r;h=q("path");this.appendChild(h);h.setAttribute("fill","none");h.setAttribute("stroke",this._options.style.stroke);h.setAttribute("stroke-width",k(this._options.style.strokeWidth/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),
a.precision));if("undefined"!=typeof this._options.style.strokeDasharray&&"none"!==this._options.style.strokeDasharray){m=this._options.style.strokeDasharray.split(",");p="";for(c=0;c<m.length;c++)""!=p&&(p+=","),p+=k(m[c]/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision);h.setAttribute("stroke-dasharray",p)}m=this._options.points.split(" ");p="";1==this.count()?(e=m[0].split(","),c=u(e[0])*(a.map[f].precision/a.factor[b.usermap]),e=a.map[f].precision/a.factor[b.usermap]*
e[1],p=p+"M"+k(e,a.precision)+","+k(c,a.precision),""!=this._movingpoints&&(e=this._movingpoints.split(","),c=u(e[0])*(a.map[f].precision/a.factor[b.usermap]),e=a.map[f].precision/a.factor[b.usermap]*e[1],""!=p&&(p+=" L"),p=p+k(e,a.precision)+","+k(c,a.precision))):2==this.count()?(e=m[0].split(","),c=u(e[0])*(a.map[f].precision/a.factor[b.usermap]),e=a.map[f].precision/a.factor[b.usermap]*e[1],p=p+"M"+k(e,a.precision)+","+k(c,a.precision),""!=this._movingpoints&&(e=this._movingpoints.split(","),
c=u(e[0])*(a.map[f].precision/a.factor[b.usermap]),e=a.map[f].precision/a.factor[b.usermap]*e[1],""!=p&&(p+=" "),p=p+"Q"+k(e,a.precision)+","+k(c,a.precision)),e=m[1].split(","),c=u(e[0])*(a.map[f].precision/a.factor[b.usermap]),e=a.map[f].precision/a.factor[b.usermap]*e[1],p=p+" "+k(e,a.precision)+","+k(c,a.precision)):3==this.count()&&(e=m[0].split(","),c=u(e[0])*(a.map[f].precision/a.factor[b.usermap]),e=a.map[f].precision/a.factor[b.usermap]*e[1],p=p+"M"+k(e,a.precision)+","+k(c,a.precision),
""!=p&&(p+=" "),e=m[2].split(","),c=u(e[0])*(a.map[f].precision/a.factor[b.usermap]),e=a.map[f].precision/a.factor[b.usermap]*e[1],p=p+"Q"+k(e,a.precision)+","+k(c,a.precision),""!=p&&(p+=" "),e=m[1].split(","),c=u(e[0])*(a.map[f].precision/a.factor[b.usermap]),e=a.map[f].precision/a.factor[b.usermap]*e[1],p=p+k(e,a.precision)+","+k(c,a.precision));h.setAttribute("d",p);h.setAttribute("stroke-opacity",this._options.style.strokeOpacity);h.setAttribute("stroke-linejoin","round");if(3==this.count()){r=
p.split(" ");c=parseFloat(r[0].substring(1).split(",")[0]);e=parseFloat(r[0].substring(1).split(",")[1]);d=parseFloat(r[1].substring(1).split(",")[0]);g=parseFloat(r[1].substring(1).split(",")[1]);h=parseFloat(r[1].substring(1).split(",")[0]);m=parseFloat(r[1].substring(1).split(",")[1]);p=parseFloat(r[2].split(",")[0]);r=parseFloat(r[2].split(",")[1]);switch("undefined"==typeof this._options.style.arrowStartType?0:this._options.style.arrowStartType){case 1:var l=parseInt(this._options.style.strokeWidth)+
4,s=q("polygon");this.appendChild(s);s.setAttribute("fill",this._options.style.stroke);s.setAttribute("fill-opacity",this._options.style.strokeOpacity);s.setAttribute("stroke",this._options.style.stroke);s.setAttribute("stroke-width",0);s.setAttribute("points",V(c,e,k(l/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision),H(c,e,d,g,0)));break;case 2:l=parseInt(this._options.style.strokeWidth)+2;s=q("path");this.appendChild(s);s.setAttribute("fill","none");s.setAttribute("stroke",
this._options.style.stroke);s.setAttribute("stroke-opacity",this._options.style.strokeOpacity);s.setAttribute("stroke-width",k(parseInt(this._options.style.strokeWidth)/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision));s.setAttribute("d",W(c,e,k(l/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision),H(c,e,d,g,0)));s.setAttribute("stroke-linejoin","round");s.setAttribute("stroke-linecap","round");break;case 3:l=parseInt(this._options.style.strokeWidth)+
2,s=q("circle"),this.appendChild(s),s.setAttribute("cx",c),s.setAttribute("cy",e),s.setAttribute("r",k(l/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision)),s.setAttribute("stroke","#EEEEEE"),s.setAttribute("stroke-width",0),s.setAttribute("fill",this._options.style.stroke),s.setAttribute("fill-opacity",this._options.style.strokeOpacity)}switch("undefined"==typeof this._options.style.arrowEndType?0:this._options.style.arrowEndType){case 1:l=parseInt(this._options.style.strokeWidth)+
4;c=q("polygon");this.appendChild(c);c.setAttribute("fill",this._options.style.stroke);c.setAttribute("fill-opacity",this._options.style.strokeOpacity);c.setAttribute("stroke",this._options.style.stroke);c.setAttribute("stroke-width",0);c.setAttribute("points",V(p,r,k(l/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision),H(h,m,p,r,1)));break;case 2:l=parseInt(this._options.style.strokeWidth)+2;c=q("path");this.appendChild(c);c.setAttribute("fill","none");c.setAttribute("stroke",
this._options.style.stroke);c.setAttribute("stroke-opacity",this._options.style.strokeOpacity);c.setAttribute("stroke-width",k(parseInt(this._options.style.strokeWidth)/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision));c.setAttribute("d",W(p,r,k(l/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision),H(h,m,p,r,1)));c.setAttribute("stroke-linejoin","round");c.setAttribute("stroke-linecap","round");break;case 3:l=parseInt(this._options.style.strokeWidth)+
2,c=q("circle"),this.appendChild(c),c.setAttribute("cx",p),c.setAttribute("cy",r),c.setAttribute("r",k(l/a.zoom[b.usermap].currentzoom*(a.map[f].precision/a.factor[b.usermap]),a.precision)),c.setAttribute("stroke","#EEEEEE"),c.setAttribute("stroke-width",0),c.setAttribute("fill",this._options.style.stroke),c.setAttribute("fill-opacity",this._options.style.strokeOpacity)}}};g.onmouseover=function(c){if("mapcurve"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="pointer";"edit"==a.mode[b.usermap]&&
v(b,c,"Click to select");if(!a.touchdevices&&"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id].link&&(this.style.cursor="pointer"),"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id].infobox&&!document.getElementById("imap5_"+b.usermap+"_infobox_mapcurve_"+this._id))){var e=
{};e.clientX=c.clientX;e.clientY=c.clientY;e.obj="mapcurve";e.infobox=a.usermap[b.usermap].map.mapcurve[this._id].infobox;this.infobox=new A(b,this._id,e)}};g.onmouseout=function(c){if("mapcurve"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="auto";"edit"==a.mode[b.usermap]&&G(b);"normal"==a.mode[b.usermap]&&(this.style.cursor="auto","onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id].infobox&&
(null==c.relatedTarget||c.relatedTarget.id!="imap5_"+b.usermap+"_infobox_mapcurve_"+this._id)&&document.getElementById("imap5_"+b.usermap+"_infobox_mapcurve_"+this._id)&&this.infobox.remove())};g.onmousemove=function(c){c.preventDefault&&c.preventDefault();"normal"==a.mode[b.usermap]&&(a.div[b.usermap]._mousedown?document.getElementById("imap5_"+b.usermap+"_infobox_mapcurve_"+this._id)&&this.infobox.hide():document.getElementById("imap5_"+b.usermap+"_infobox_mapcurve_"+this._id)&&(this.infobox.reposition(c.clientX,
c.clientY),this.infobox.show()))};g.onclick=function(c){this._mapdragged||this._transformed||a.div[b.usermap]._mapdragged||("edit"==a.mode[b.usermap]?(this.createVertices(),c={event:"click",object:"mapcurve"},c.id=Number(this._id),window.console&&console.log(JSON.stringify(c))):"normal"==a.mode[b.usermap]&&"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id].link&&("undefined"==typeof a.usermap[b.usermap].map.mapcurve[this._id].link_target?
location.href=a.usermap[b.usermap].map.mapcurve[this._id].link:window.open(a.usermap[b.usermap].map.mapcurve[this._id].link,a.usermap[b.usermap].map.mapcurve[this._id].link_target)))};a.touchdevices&&(g.ontouchstart=function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)},g.ontouchmove=function(a){1==a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-this._posX)||10<Math.abs(a.touches[0].clientY-this._posY))&&(this._move=
!0):this._touch=!1},g.ontouchend=function(c){if(this._touch&&!this._move&&!a.div[b.usermap]._mapdragged){if("edit"==a.mode[b.usermap]){c={event:"click",object:"mapcurve"};c.id=this._id;window.console&&console.log(JSON.stringify(c));return}"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id].link&&("undefined"==typeof a.usermap[b.usermap].map.mapcurve[this._id].link_target?location.href=a.usermap[b.usermap].map.mapcurve[this._id].link:
window.open(a.usermap[b.usermap].map.mapcurve[this._id].link,a.usermap[b.usermap].map.mapcurve[this._id].link_target));if("edit"==a.mode[b.usermap])return;0<a.infobox[b.usermap].length&&(document.getElementById("imap5_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)&&a.div[b.usermap].removeChild(document.getElementById("imap5_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)),a.infobox[b.usermap].pop());"undefined"==typeof a.usermap[b.usermap].map.mapcurve[this._id]||
"undefined"==typeof a.usermap[b.usermap].map.mapcurve[this._id].infobox||document.getElementById("imap5_"+b.usermap+"_infobox_mapcurve_"+this._id)||(c={},c.clientX=this._posX,c.clientY=this._posY,c.obj="mapcurve",c.infobox=a.usermap[b.usermap].map.mapcurve[this._id].infobox,this.infobox=new A(b,this._id,c))}this._move=this._touch=!1});g.remove=function(){for(var c in this._mainvertices)this._mainvertices.hasOwnProperty(c)&&this._mainvertices[c].remove();a.g[b.usermap].removeChild(this);a.mapcurve[b.usermap][this._id]=
null};g.drawMapCurve();return g},na=function(b,d,h){var f=q("g"),g=a.usermap[b.usermap].map.id;a.g[b.usermap].appendChild(f);f._options=h;f._id=d;f.setAttribute("id","imap5_"+b.usermap+"_mapbubble_"+d);f.hide=function(){this.style.visibility="hidden"};f.show=function(){this.style.visibility="visible"};f.drawMapBubble=function(){if(this.hasChildNodes())for(;1<=this.childNodes.length;)this.removeChild(this.firstChild);var c=q("g"),e=q("circle");c.appendChild(e);this.appendChild(c);e.setAttribute("cx",
0);e.setAttribute("cy",0);e.setAttribute("r",Math.abs(this._options.bubblevalue/a.usermap[b.usermap].map.bubblemap.maxbubble)*a.usermap[b.usermap].map.bubblemap.radius);e.setAttribute("stroke","#EEEEEE");e.setAttribute("stroke-width",0);0<this._options.bubblevalue?e.setAttribute("fill",a.usermap[b.usermap].map.bubblemap.poscolor):e.setAttribute("fill",a.usermap[b.usermap].map.bubblemap.negcolor);e.setAttribute("fill-opacity",a.usermap[b.usermap].map.bubblemap.opacity);c.setAttribute("transform","scale(1,-1)");
c=Math.log(Math.tan(Math.PI/4+Math.PI*h.lat/360))*(180/Math.PI);e=h.lng;this._lat=a.map[g].precision/a.factor[b.usermap]*c;this._lng=a.map[g].precision/a.factor[b.usermap]*e;this.setAttribute("transform","translate("+k(a.map[g].precision/a.factor[b.usermap]*e,a.precision)+","+k(a.map[g].precision/a.factor[b.usermap]*c,a.precision)+") scale("+k(a.map[g].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")};f.onmouseover=function(c){if("normal"==a.mode[b.usermap]){var e=this.getElementsByTagName("g")[0].getElementsByTagName("circle")[0];
e.setAttribute("stroke","#EEEEEE");e.setAttribute("stroke-width",2);if(a.usermap[b.usermap].map.bubblemap.showdetails&&!document.getElementById("imap5_"+b.usermap+"_infobox_mapbubble_"+this._id)){var e=a.usermap[b.usermap].map.bubblemap.contentformat.replace(/__TITLE__/g,a.usermap[b.usermap].map.geometry[this._id].title).replace(/__DATA__/g,this._options.bubblevalue),d={};d.clientX=c.clientX;d.clientY=c.clientY;d.obj="mapbubble";d.infobox=e;this.infobox=new A(b,this._id,d)}}};f.onmouseout=function(c){if("normal"==
a.mode[b.usermap]){var e=this.getElementsByTagName("g")[0].getElementsByTagName("circle")[0];e.setAttribute("stroke","#EEEEEE");e.setAttribute("stroke-width",0);(null==c.relatedTarget||c.relatedTarget.id!="imap5_"+b.usermap+"_infobox_mapbubble_"+this._id)&&document.getElementById("imap5_"+b.usermap+"_infobox_mapbubble_"+this._id)&&this.infobox.remove()}};f.onmousemove=function(c){c.preventDefault&&c.preventDefault();"normal"==a.mode[b.usermap]&&(a.div[b.usermap]._mousedown?document.getElementById("imap5_"+
b.usermap+"_infobox_mapbubble_"+this._id)&&this.infobox.hide():document.getElementById("imap5_"+b.usermap+"_infobox_mapbubble_"+this._id)&&(this.infobox.reposition(c.clientX,c.clientY),this.infobox.show()))};a.touchdevices&&(f.ontouchstart=function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)},f.ontouchmove=function(a){1==a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-this._posX)||10<Math.abs(a.touches[0].clientY-
this._posY))&&(this._move=!0):this._touch=!1},f.ontouchend=function(c){if(this._touch&&!this._move&&!a.div[b.usermap]._mapdragged){if("edit"==a.mode[b.usermap])return;this.ishighlight?(this.ishighlight=!1,c=this.getElementsByTagName("g")[0],c=c.getElementsByTagName("circle")[0],c.setAttribute("stroke","#EEEEEE"),c.setAttribute("stroke-width",0)):(this.ishighlight=!0,c=this.getElementsByTagName("g")[0],c=c.getElementsByTagName("circle")[0],c.setAttribute("stroke","#EEEEEE"),c.setAttribute("stroke-width",
2));0<a.infobox[b.usermap].length&&(document.getElementById("imap5_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)&&a.div[b.usermap].removeChild(document.getElementById("imap5_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)),a.infobox[b.usermap].pop());if(!document.getElementById("imap5_"+b.usermap+"_infobox_mapbubble_"+this._id)){c=a.usermap[b.usermap].map.bubblemap.contentformat.replace(/__TITLE__/g,a.usermap[b.usermap].map.geometry[this._id].title).replace(/__DATA__/g,
this._options.bubblevalue);var e={};e.clientX=this._posX;e.clientY=this._posY;e.obj="mapbubble";e.infobox=c;this.infobox=new A(b,this._id,e)}}this._move=this._touch=!1});f.rescale=function(){this.setAttribute("transform","translate("+k(this._lng,a.precision)+","+k(this._lat,a.precision)+") scale("+k(a.map[g].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")};f.remove=function(){a.g[b.usermap].removeChild(this);a.mapbubble[b.usermap][this._id]=null};f.drawMapBubble();return f},
oa=function(b,d,h){var f=q("g"),g=a.usermap[b.usermap].map.id;a.g[b.usermap].appendChild(f);f._options=h;f._id=d;f.setAttribute("id","imap5_"+b.usermap+"_piechart_"+d);f.hide=function(){this.style.visibility="hidden"};f.show=function(){this.style.visibility="visible"};f.drawPieChart=function(){if(this.hasChildNodes())for(;1<=this.childNodes.length;)this.removeChild(this.firstChild);for(var c=a.usermap[b.usermap].map.piechart.radius,e=c/2,d=a.usermap[b.usermap].map.piechart.colorset.split(","),f=this._options.pievalue.split(","),
w=0,m=a.usermap[b.usermap].map.piechart.series,p=0;p<m;p++)f.hasOwnProperty(p)&&(w+=parseFloat(f[p]));var r=[];if(0>=w)this.style.visibility="hidden",r=[0,0,0,0,0,0,0,0];else for(this.style.visibility="true",p=0;p<m;p++)f.hasOwnProperty(p)&&r.push(2*Math.PI*parseFloat(f[p])/w);for(var f=q("g"),l=0,p=0;p<m;p++){var w=l+r[p],s=k(0+2*c*Math.sin(l),6),u=k(0-c*Math.cos(l),6),v=k(0+2*c*Math.sin(w),6),y=k(0-c*Math.cos(w),6),x=0,z=0;w-l>=Math.PI&&(x=1);if(l!=w){if(w-l==2*Math.PI)z=1;else var A="M 0,0 L "+
s+","+u+" A "+2*c+","+c+" 0 "+x+" 1 "+v+","+y+" Z";z?(x=q("ellipse"),x.setAttribute("cx",0),x.setAttribute("cy",0),x.setAttribute("rx",2*c),x.setAttribute("ry",c)):(x=q("path"),x.setAttribute("d",A));x.setAttribute("fill",d[p]);x.setAttribute("fill-opacity",a.usermap[b.usermap].map.piechart.opacity);x.setAttribute("stroke",a.usermap[b.usermap].map.piechart.stroke);x.setAttribute("stroke-width",a.usermap[b.usermap].map.piechart.strokeWidth);x.setAttribute("stroke-opacity",a.usermap[b.usermap].map.piechart.strokeOpacity);
f.appendChild(x)}s=l;u=w;if(l>=Math.PI/2&&l<=3*Math.PI/2||w>=Math.PI/2&&w<=3*Math.PI/2||l<=Math.PI/2&&w>=3*Math.PI/2)w>=3*Math.PI/2&&(u=3*Math.PI/2),l<=Math.PI/2&&(s=Math.PI/2),x=0,u-s>Math.PI&&(x=1),l=k(0+2*c*Math.sin(s),6),v=k(0-c*Math.cos(s),6),y=k(0+2*c*Math.sin(u),6),z=k(0-c*Math.cos(u),6),s!=u&&(A="M "+l+","+v+" L "+l+","+(v+e)+" A "+2*c+","+c+" 0 "+x+" 1 "+y+","+(z+e)+" L "+y+","+z+" A "+2*c+","+c+" 0 "+x+" 0 "+l+","+v+" Z ",x=q("path"),x.setAttribute("d",A),x.setAttribute("fill",d[p]),x.setAttribute("fill-opacity",
a.usermap[b.usermap].map.piechart.opacity),x.setAttribute("stroke",a.usermap[b.usermap].map.piechart.stroke),x.setAttribute("stroke-width",a.usermap[b.usermap].map.piechart.strokeWidth),x.setAttribute("stroke-opacity",a.usermap[b.usermap].map.piechart.strokeOpacity),f.appendChild(x));l=w}f.setAttribute("transform","scale(1,-1)");this.appendChild(f);c=Math.log(Math.tan(Math.PI/4+Math.PI*h.lat/360))*(180/Math.PI);e=h.lng;this._lat=a.map[g].precision/a.factor[b.usermap]*c;this._lng=a.map[g].precision/
a.factor[b.usermap]*e;this.setAttribute("transform","translate("+k(a.map[g].precision/a.factor[b.usermap]*e,a.precision)+","+k(a.map[g].precision/a.factor[b.usermap]*c,a.precision)+") scale("+k(a.map[g].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")};f.onmouseover=function(c){if("normal"==a.mode[b.usermap]){for(var e=this.getElementsByTagName("g")[0],d=e.getElementsByTagName("path"),f=0;f<d.length;f++)d.hasOwnProperty(f)&&d[f].setAttribute("stroke",a.usermap[b.usermap].map.piechart.strokeHover);
e=e.getElementsByTagName("ellipse");for(f=0;f<e.length;f++)e.hasOwnProperty(f)&&e[f].setAttribute("stroke",a.usermap[b.usermap].map.piechart.strokeHover);if(a.usermap[b.usermap].map.piechart.showdetails&&!document.getElementById("imap5_"+b.usermap+"_infobox_piechart_"+this._id)){for(var e=a.usermap[b.usermap].map.piechart.contentformat.replace(/__TITLE__/g,a.usermap[b.usermap].map.geometry[this._id].title),d=this._options.pievalue.split(","),g=0,h=a.usermap[b.usermap].map.piechart.series,f=0;f<h;f++)d.hasOwnProperty(f)&&
(g+=parseFloat(d[f]));e=e.replace(/__DATA1__/g,d[0]);e=e.replace(/__DATA2__/g,d[1]);e=e.replace(/__DATA3__/g,d[2]);e=e.replace(/__DATA4__/g,d[3]);e=e.replace(/__DATA5__/g,d[4]);e=e.replace(/__DATA6__/g,d[5]);e=e.replace(/__DATA7__/g,d[6]);e=e.replace(/__DATA8__/g,d[7]);e=e.replace(/__PERCENT1__/g,k(parseFloat(d[0])/g*100,2));e=e.replace(/__PERCENT2__/g,k(parseFloat(d[1])/g*100,2));e=e.replace(/__PERCENT3__/g,k(parseFloat(d[2])/g*100,2));e=e.replace(/__PERCENT4__/g,k(parseFloat(d[3])/g*100,2));e=e.replace(/__PERCENT5__/g,
k(parseFloat(d[4])/g*100,2));e=e.replace(/__PERCENT6__/g,k(parseFloat(d[5])/g*100,2));e=e.replace(/__PERCENT7__/g,k(parseFloat(d[6])/g*100,2));e=e.replace(/__PERCENT8__/g,k(parseFloat(d[7])/g*100,2));f={};f.clientX=c.clientX;f.clientY=c.clientY;f.obj="piechart";f.infobox=e;this.infobox=new A(b,this._id,f)}}};f.onmouseout=function(c){if("normal"==a.mode[b.usermap]){for(var e=this.getElementsByTagName("g")[0],d=e.getElementsByTagName("path"),f=0;f<d.length;f++)d.hasOwnProperty(f)&&d[f].setAttribute("stroke",
a.usermap[b.usermap].map.piechart.stroke);e=e.getElementsByTagName("ellipse");for(f=0;f<e.length;f++)e.hasOwnProperty(f)&&e[f].setAttribute("stroke",a.usermap[b.usermap].map.piechart.stroke);(null==c.relatedTarget||c.relatedTarget.id!="imap5_"+b.usermap+"_infobox_piechart_"+this._id)&&document.getElementById("imap5_"+b.usermap+"_infobox_piechart_"+this._id)&&this.infobox.remove()}};f.onmousemove=function(c){c.preventDefault&&c.preventDefault();"normal"==a.mode[b.usermap]&&(a.div[b.usermap]._mousedown?
document.getElementById("imap5_"+b.usermap+"_infobox_piechart_"+this._id)&&this.infobox.hide():document.getElementById("imap5_"+b.usermap+"_infobox_piechart_"+this._id)&&(this.infobox.reposition(c.clientX,c.clientY),this.infobox.show()))};a.touchdevices&&(f.ontouchstart=function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)},f.ontouchmove=function(a){1==a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-this._posX)||
10<Math.abs(a.touches[0].clientY-this._posY))&&(this._move=!0):this._touch=!1},f.ontouchend=function(c){if(this._touch&&!this._move&&!a.div[b.usermap]._mapdragged){if("edit"==a.mode[b.usermap])return;if(this.ishighlight)for(this.ishighlight=!1,c=this.getElementsByTagName("g")[0],e=c.getElementsByTagName("path"),c=0;c<e.length;c++)e.hasOwnProperty(c)&&e[c].setAttribute("stroke",a.usermap[b.usermap].map.piechart.stroke);else{this.ishighlight=!0;c=this.getElementsByTagName("g")[0];var e=c.getElementsByTagName("path");
for(c=0;c<e.length;c++)e.hasOwnProperty(c)&&e[c].setAttribute("stroke",a.usermap[b.usermap].map.piechart.strokeHover)}0<a.infobox[b.usermap].length&&(document.getElementById("imap5_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)&&a.div[b.usermap].removeChild(document.getElementById("imap5_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)),a.infobox[b.usermap].pop());if(!document.getElementById("imap5_"+b.usermap+"_infobox_piechart_"+
this._id)){var e=a.usermap[b.usermap].map.piechart.contentformat.replace(/__TITLE__/g,a.usermap[b.usermap].map.geometry[this._id].title),d=this._options.pievalue.split(","),f=0,g=a.usermap[b.usermap].map.piechart.series;for(c=0;c<g;c++)d.hasOwnProperty(c)&&(f+=parseFloat(d[c]));e=e.replace(/__DATA1__/g,d[0]);e=e.replace(/__DATA2__/g,d[1]);e=e.replace(/__DATA3__/g,d[2]);e=e.replace(/__DATA4__/g,d[3]);e=e.replace(/__DATA5__/g,d[4]);e=e.replace(/__DATA6__/g,d[5]);e=e.replace(/__DATA7__/g,d[6]);e=e.replace(/__DATA8__/g,
d[7]);e=e.replace(/__PERCENT1__/g,k(parseFloat(d[0])/f*100,2));e=e.replace(/__PERCENT2__/g,k(parseFloat(d[1])/f*100,2));e=e.replace(/__PERCENT3__/g,k(parseFloat(d[2])/f*100,2));e=e.replace(/__PERCENT4__/g,k(parseFloat(d[3])/f*100,2));e=e.replace(/__PERCENT5__/g,k(parseFloat(d[4])/f*100,2));e=e.replace(/__PERCENT6__/g,k(parseFloat(d[5])/f*100,2));e=e.replace(/__PERCENT7__/g,k(parseFloat(d[6])/f*100,2));e=e.replace(/__PERCENT8__/g,k(parseFloat(d[7])/f*100,2));c={};c.clientX=this._posX;c.clientY=this._posY;
c.obj="piechart";c.infobox=e;this.infobox=new A(b,this._id,c)}}this._move=this._touch=!1});f.rescale=function(){this.setAttribute("transform","translate("+k(this._lng,a.precision)+","+k(this._lat,a.precision)+") scale("+k(a.map[g].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")};f.remove=function(){a.g[b.usermap].removeChild(this);a.piechart[b.usermap][this._id]=null};f.drawPieChart();return f},Ga=function(b,d,h){var f=a.usermap[b.usermap].map.id,g=q("g");a.g[b.usermap].appendChild(g);
g._options=h;g._id=d;g.setAttribute("id","imap5_"+b.usermap+"_mapabbr_"+d);g._lat=h.lat;g._lng=h.lng;g._dx=a.map[f].precision/a.factor[b.usermap]*g._lng;g._dy=u(g._lat)*(a.map[f].precision/a.factor[b.usermap]);g._show=!0;g.setPosition=function(c){this._lat=a.usermap[b.usermap].map.mapabbr[this._id].lat=c.lat;this._lng=a.usermap[b.usermap].map.mapabbr[this._id].lng=c.lng;this._dy=u(this._lat)*(a.map[f].precision/a.factor[b.usermap]);this._dx=a.map[f].precision/a.factor[b.usermap]*this._lng;g.setAttribute("transform",
"translate("+k(this._dx,a.precision)+","+k(this._dy,a.precision)+") scale("+k(a.map[f].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")};g.getPosition=function(){var a={};a.lat=this._lat;a.lng=this._lng;return a};g.setOptions=function(a){this._options=a};g.setLabel=function(a){this._options.label.text=a;this.drawMapAbbr()};g.hide=function(){this.style.visibility="hidden";this._show=!1};g.show=function(){this.style.visibility="visible";this._show=!0};g.drawMapAbbr=function(){if(this.hasChildNodes())for(;1<=
this.childNodes.length;)this.removeChild(this.firstChild);if(""!=this._options.label.text){var c=q("text");this.appendChild(c);var e=q("text");this.appendChild(e);var d=document.createTextNode(this._options.label.text);e.appendChild(d);e.setAttribute("style","stroke-width:0");e.style.strokeOpacity=0;e.style.fontFamily=this._options.label.style.fontFamily;e.style.fill=this._options.label.style.fontColor;e.style.fontSize=this._options.label.style.fontSize;e.style.fontStyle=this._options.label.style.fontStyle;
e.style.fontWeight=this._options.label.style.fontWeight;e.style.pointerEvents="none";d=0+parseInt(e.style.fontSize)/2-(e.getBBox().height+e.getBBox().y)/2;e.setAttribute("x",0);e.setAttribute("y",d);e.setAttribute("transform","scale(1,-1)");e.setAttribute("text-anchor","middle");e=document.createTextNode(this._options.label.text);c.appendChild(e);c.setAttribute("style","stroke-width:0");c.style.strokeOpacity=0;c.style.fontFamily=this._options.label.style.fontFamily;c.style.fill="undefined"==typeof this._options.label.style.shadowColor?
"#ffffff":this._options.label.style.shadowColor;c.style.fontSize=this._options.label.style.fontSize;c.style.fontStyle=this._options.label.style.fontStyle;c.style.fontWeight=this._options.label.style.fontWeight;c.style.pointerEvents="none";c.setAttribute("x",1);c.setAttribute("y",d+1);c.setAttribute("transform","scale(1,-1)");c.setAttribute("text-anchor","middle");c.style.fillOpacity="undefined"==typeof this._options.label.style.shadowOpacity?0.7:this._options.label.style.shadowOpacity}c=Math.log(Math.tan(Math.PI/
4+Math.PI*this._options.lat/360))*(180/Math.PI);e=this._options.lng;this._lat=a.map[f].precision/a.factor[b.usermap]*c;this._lng=a.map[f].precision/a.factor[b.usermap]*e;this.setAttribute("transform","translate("+k(a.map[f].precision/a.factor[b.usermap]*e,a.precision)+","+k(a.map[f].precision/a.factor[b.usermap]*c,a.precision)+") scale("+k(a.map[f].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")};g.remove=function(){a.g[b.usermap].removeChild(this);a.mapabbr[b.usermap][this._id]=
null};g.drawMapAbbr();return g},N=function(b,d,h,f){var g=this,c=a.usermap[b.usermap].map.id,e=q("g");a.g[b.usermap].appendChild(e);e._options=f;e._id=d;0==f.type?e.setAttribute("id","imap5_"+b.usermap+"_verticesobj_"+d):e.setAttribute("id","imap5_"+b.usermap+"_subverticesobj_"+d);e._lat=f.lat;e._lng=f.lng;e._type=f.type;e._removable=f.removeable;this._parentnode=h;e._dx=a.map[c].precision/a.factor[b.usermap]*e._lng;e._dy=u(e._lat)*(a.map[c].precision/a.factor[b.usermap]);e.setOptions=function(a){this._options=
a;this._lat=a.lat;this._lng=a.lng;this._type=a.type;this._removable=a.removable};e.hide=function(){this.style.visibility="hidden"};e.show=function(){this.style.visibility="visible"};e.onmouseover=function(c){"edit"==a.mode[b.usermap]&&(this.style.cursor="pointer");"edit"==a.mode[b.usermap]&&(0==f.type?f.removable?v(b,c,"<strong>[Drag]</strong> to change position. <strong>[Right Click]</strong> to delete."):v(b,c,"<strong>[Drag]</strong> to change position."):v(b,c,"<strong>[Click]</strong> to split the line segment"))};
e.onmouseout=function(c){"edit"==a.mode[b.usermap]&&(this.style.cursor="auto");"edit"==a.mode[b.usermap]&&G(b);"normal"==a.mode[b.usermap]&&(this.style.cursor="auto")};e.onmousedown=function(c){c.preventDefault&&c.preventDefault();"edit"==a.mode[b.usermap]&&(c.stopPropagation&&c.stopPropagation(),this._mousedown=!0,this._mapdragged=!1,this._x=c.clientX,this._y=c.clientY,0==f.type?(a.selectedOverlay[b.usermap]=this,g._parentnode.hideSubVertices()):g._parentnode.addVertices(d,this._options.lat,this._options.lng))};
0==f.type&&(e.onmousemove=function(e){e.preventDefault&&e.preventDefault();if("edit"==a.mode[b.usermap]&&(e.stopPropagation&&e.stopPropagation(),this._mousedown&&0==f.type&&(2<Math.abs(e.clientX-this._x)||2<Math.abs(e.clientY-this._y)))){this._mapdragged=!0;this._x=e.clientX;this._y=e.clientY;var h=a.svgcoord[b.usermap];h.x=e.clientX;h.y=e.clientY;h=y(h,a.g[b.usermap]);h.x/=a.map[c].precision/a.factor[b.usermap];h.y/=a.map[c].precision/a.factor[b.usermap];e=h.x;var q=360*(Math.atan(Math.pow(Math.E,
h.y.toFixed(a.precision)*Math.PI/180))-Math.PI/4)/Math.PI;P(q,e)||(this._lat=a.map[c].precision/a.factor[b.usermap]*h.y,this._lng=a.map[c].precision/a.factor[b.usermap]*h.x,this.setAttribute("transform","translate("+k(this._lng,a.precision)+","+k(this._lat,a.precision)+") scale("+k(a.map[c].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")"),g._parentnode.updateVertices(d,q,e))}},e.onmouseup=function(c){c.preventDefault&&c.preventDefault();"edit"==a.mode[b.usermap]&&0==f.type&&
(c.stopPropagation&&c.stopPropagation(),a.selectedOverlay[b.usermap]==this&&(a.selectedOverlay[b.usermap]=null),g._parentnode.postPosChange(),this._mousedown=!1)},e.oncontextmenu=function(c){c.preventDefault&&c.preventDefault();"edit"==a.mode[b.usermap]&&(c.stopPropagation&&c.stopPropagation(),0==f.type&&f.removable&&g._parentnode.removeVertices(d))});e.drawVerticesObj=function(){var e=this.getElementsByTagName("g")[0];"undefined"!=typeof e&&this.removeChild(e);var e=q("g"),d=q("circle");e.appendChild(d);
this.appendChild(e);d.setAttribute("cx",0);d.setAttribute("cy",0);d.setAttribute("r",5);d.setAttribute("stroke","#000000");d.setAttribute("stroke-width",1);1==this._type?(d.setAttribute("fill","#CCCCCC"),d.setAttribute("fill-opacity",0.5)):(d.setAttribute("fill","#FFFFFF"),d.setAttribute("fill-opacity",1));e.setAttribute("transform","scale(1,-1)");e=Math.log(Math.tan(Math.PI/4+Math.PI*this._options.lat/360))*(180/Math.PI);d=this._options.lng;this._lat=a.map[c].precision/a.factor[b.usermap]*e;this._lng=
a.map[c].precision/a.factor[b.usermap]*d;this.setAttribute("transform","translate("+k(a.map[c].precision/a.factor[b.usermap]*d,a.precision)+","+k(a.map[c].precision/a.factor[b.usermap]*e,a.precision)+") scale("+k(a.map[c].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")};e.rescale=function(){this.setAttribute("transform","translate("+k(this._lng,a.precision)+","+k(this._lat,a.precision)+") scale("+k(a.map[c].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,
a.precision)+")")};e.remove=function(){a.g[b.usermap].removeChild(this)};e.drawVerticesObj();return e},A=function(b,d,h){var f=document.createElement("div");f.id="imap5_"+b.usermap+"_infobox_"+h.obj+"_"+d;f.options=h;f.style.position="fixed";f.style.top=h.clientY+3+"px";f.style.left=h.clientX+3+"px";for(var g in a.usermap[b.usermap].infobox.style)"backgroundColor"!=g&&"opacity"!=g&&(f.style[g]=a.usermap[b.usermap].infobox.style[g]);f.style.backgroundColor="rgba("+ +I(a.usermap[b.usermap].infobox.style.backgroundColor)+
","+J(a.usermap[b.usermap].infobox.style.backgroundColor)+","+K(a.usermap[b.usermap].infobox.style.backgroundColor)+","+a.usermap[b.usermap].infobox.style.opacity+")";f.innerHTML=h.infobox.replace(/%_BASE_%/g,a.base[b.usermap]);a.div[b.usermap].appendChild(f);f.onmouseout=function(a){for(var b=a.relatedTarget;null!=b;){if(b==this)return;b=b.parentNode}null!=a.relatedTarget&&this.id.split("_")[4]!=a.relatedTarget.parentNode.id&&this.remove()};f.onmouseup=function(a){a.stopPropagation&&a.stopPropagation()};
f.onmousedown=function(a){a.stopPropagation&&a.stopPropagation()};f.onmousewheel=function(a){a.stopPropagation&&a.stopPropagation()};a.div[b.usermap].addEventListener&&f.addEventListener("DOMMouseScroll",function(a){a.stopPropagation&&a.stopPropagation()},!1);f.show=function(){this.style.display="block"};f.hide=function(){this.style.display="none"};f.reposition=function(c,e,d){var f;f="undefined"!=typeof a.usermap[b.usermap].infobox.style.sensitivity?a.usermap[b.usermap].infobox.style.sensitivity:
15;var g=document.body.offsetHeight,h=document.body.offsetWidth,k=2*parseInt(a.usermap[b.usermap].infobox.style.padding);if(d||Math.sqrt((this.options.clientX-c)*(this.options.clientX-c)+(this.options.clientY-e)*(this.options.clientY-e))>f)this.options.clientX=c,this.options.clientY=e,"undefined"!=typeof a.usermap[b.usermap].infobox.style.width?(d=parseInt(a.usermap[b.usermap].infobox.style.width),d>h?(this.style.width=h-k+"px",this.style.left=0):(f=Math.max(c,h-c)-k,d>f?(h=h-c-d-k,0<h&&(h=0),this.style.width=
d+"px",this.style.left=c+h+"px"):(this.style.width=d+"px",this.style.left=(d>h-c?c-d-k:c)+"px"))):c>3*h/5?(this.style.width="auto",this.style.left="0px",d=parseFloat(window.getComputedStyle(document.getElementById(this.id),null).getPropertyValue("width")),d>h/2?(this.style.width=h/2+"px",this.style.left=c-h/2-k+"px"):(this.style.width=d+"px",this.style.left=c-d-k+"px")):(this.style.width="auto",this.style.left=c+"px"),"undefined"!=typeof a.usermap[b.usermap].infobox.style.height?(c=parseInt(a.usermap[b.usermap].infobox.style.height),
h=Math.max(e,g-e)-k,c>h?(this.style.height=h+"px",this.style.top=(e>g/2?0:e)+"px"):(this.style.height=c+"px",this.style.top=(c>g-e?e-c-k:e)+"px")):e>3*g/5?(this.style.height="auto",c=parseFloat(window.getComputedStyle(document.getElementById(this.id),null).getPropertyValue("height")),c>g/2?(this.style.height=g/2+"px",this.style.top=e-g/2-k+"px"):(this.style.height=c+"px",this.style.top=e-c-k+"px")):(this.style.height="auto",c=parseFloat(window.getComputedStyle(document.getElementById(this.id),null).getPropertyValue("height")),
this.style.height=c>g-e-k-3?g-e-k-3+"px":"auto",this.style.top=e+"px")};f.remove=function(){a.div[b.usermap].removeChild(document.getElementById(this.id));a.infobox[b.usermap].pop()};a.touchdevices&&(f.ontouchstart=f.ontouchmove=f.ontouchend=function(a){a.stopPropagation&&a.stopPropagation()});g={};g.object=h.obj;g.id=d;a.infobox[b.usermap].push(g);f.reposition(h.clientX,h.clientY);return f},ra=function(b,d,h){var f=document.createElement("div");f.id="imap5_"+b.usermap+"_maplegend_"+d;f.options=h;
f.style.position="fixed";f._show=!0;a.div[b.usermap].appendChild(f);f.setOptions=function(a){this.options=a};f.hide=function(){this.style.display="none";this._show=!1};f.show=function(){this.style.display="block";this._show=!0};f.toggleCategory=function(){"normal"==a.mode[b.usermap]?"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&a.usermap[b.usermap].map.categorylegend.enable?0!=this.options.categoryid&&("undefined"!=typeof a.categorylegend[b.usermap]?-1!=a.categorylegend[b.usermap].visiblelist.indexOf(this.options.categoryid)?
this.show():this.hide():this.show()):this.show():this.show()};f.drawMapLegend=function(){if(this.hasChildNodes())for(;1<=this.childNodes.length;)this.removeChild(this.firstChild);for(var d in h.style)"backgroundColor"!=d&&"opacity"!=d&&(this.style[d]=this.options.style[d]);this.style.backgroundColor="rgba("+ +I(this.options.style.backgroundColor)+","+J(this.options.style.backgroundColor)+","+K(this.options.style.backgroundColor)+","+this.options.style.opacity+")";var c=0,e=this.options.columnsPerRow,
f=parseInt(this.options.columnWidth)*e,k=parseInt(this.options.columnWidth)*e-6,q=parseInt(this.options.icon.width),m=parseInt(this.options.icon.height),p=parseInt(this.options.columnWidth)-(q+6)-6,r=parseInt(this.options.columnWidth),l=new M;l.style.width=f+"px";this.appendChild(l);for(d in this.options.items)if(this.options.items.hasOwnProperty(d)){switch(this.options.items[d].type){case 1:l={};l.text=this.options.items[d].text;l.width=k;l.fontFamily=this.options.style.fontFamily;l.fontSize=this.options.style.fontSize;
l.fontColor=this.options.style.fontColor;c=new ya(l);this.appendChild(c);c=0;break;case 2:l={};l.text=this.options.items[d].text;l.image=this.options.items[d].image;l.basepath=a.base[b.usermap];l.iconWidth=q;l.iconHeight=m;l.legendTextWidth=p;l.width=r;l.fontFamily=this.options.style.fontFamily;l.fontSize=this.options.style.fontSize;l.fontColor=this.options.style.fontColor;l.columnsPerRow=this.options.columnsPerRow;l=new Ha(l);this.appendChild(l);c+=1;break;case 3:l={};l.text=this.options.items[d].text;
l.fill=this.options.items[d].fill;l.opacity="undefined"!==typeof this.options.items[d].opacity?this.options.items[d].opacity:1;l.iconWidth=q;l.iconHeight=m;l.legendTextWidth=p;l.width=r;l.fontFamily=this.options.style.fontFamily;l.fontSize=this.options.style.fontSize;l.fontColor=this.options.style.fontColor;l.columnsPerRow=this.options.columnsPerRow;l=new Ia(l);this.appendChild(l);c+=1;break;case 4:l={},l.text=this.options.items[d].text,l.stroke=this.options.items[d].stroke,l.opacity="undefined"!==
typeof this.options.items[d].opacity?this.options.items[d].opacity:1,l.iconWidth=q,l.iconHeight=m,l.legendTextWidth=p,l.width=r,l.fontFamily=this.options.style.fontFamily,l.fontSize=this.options.style.fontSize,l.fontColor=this.options.style.fontColor,l.columnsPerRow=this.options.columnsPerRow,l=new Ja(l),this.appendChild(l),c+=1}if(c==e||"1"==this.options.items[d].type)l=new M,l.style.width=f+"px",this.appendChild(l),c=0}this.style.position="absolute";this.style.display="table";this.style.width=f+
"px";switch(this.options.anchor){case 1:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.bottom="auto";this.style.right="auto";break;case 2:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.width)-parseInt(this.offsetWidth))/2+"px";this.style.bottom=
"auto";this.style.right="auto";break;case 3:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.bottom="auto";this.style.left="auto";break;case 4:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.height)-parseInt(this.offsetHeight))/2+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.bottom=
"auto";this.style.right="auto";break;case 5:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.height)-parseInt(this.offsetHeight))/2+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.width)-parseInt(this.offsetWidth))/2+"px";this.style.bottom="auto";this.style.right="auto";break;case 6:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.height)-
parseInt(this.offsetHeight))/2+"px";this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.bottom="auto";this.style.left="auto";break;case 7:this.style.bottom=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.top="auto";this.style.right="auto";break;case 8:this.style.bottom=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+
(parseInt(a.usermap[b.usermap].div.style.width)-parseInt(this.offsetWidth))/2+"px";this.style.top="auto";this.style.right="auto";break;case 9:this.style.bottom=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.top="auto";this.style.left="auto";break;default:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px",this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+
"px",this.style.bottom="auto",this.style.left="auto"}};f.remove=function(){a.div[b.usermap].removeChild(document.getElementById(this.id))};f.onmouseup=function(a){};f.onmousedown=function(a){};f.onmouseover=function(d){if("maplegend"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="pointer";"edit"==a.mode[b.usermap]&&v(b,d,"Click to select")};f.onmouseout=function(d){if("maplegend"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="auto";"edit"==a.mode[b.usermap]&&G(b)};
f.onmousewheel=function(a){};a.div[b.usermap].addEventListener&&f.addEventListener("DOMMouseScroll",function(a){},!1);f.onclick=function(f){f.stopPropagation&&f.stopPropagation();this._mapdragged||this._transformed||a.div[b.usermap]._mapdragged||"edit"!=a.mode[b.usermap]||(f={event:"click",object:"maplegend"},f.id=Number(d),window.console&&console.log(JSON.stringify(f)))};a.touchdevices&&(f.ontouchstart=f.ontouchmove=f.ontouchend=function(a){a.stopPropagation&&a.stopPropagation()});f.drawMapLegend();
return f},ya=function(a){var d=document.createElement("div");d.style.cssFloat="left";d.style.overflow="hidden";d.style.textOverflow="ellipsis";d.style.whiteSpace="nowrap";d.style.padding="3px";d.style.fontFamily=a.fontFamily;d.style.fontSize=a.fontSize;d.style.color=a.fontColor;d.style.width=a.width+"px";d.style.fontWeight="bold";d.innerHTML=a.text;return d},T=function(a){var d=document.createElement("div");d.style.cssFloat="left";d.style.overflow="hidden";d.style.textOverflow="ellipsis";d.style.whiteSpace=
"nowrap";d.style.width=a.width+"px";d.style.padding="3px";d.style.fontFamily=a.fontFamily;d.style.fontSize=a.fontSize;d.style.color=a.fontColor;d.style.border="0px";d.innerHTML=a.text;return d},Ha=function(a){var d=document.createElement("div"),h=document.createElement("div");h.style.cssFloat="left";h.style.padding="3px";h.style.width=a.iconWidth+"px";h.style.height=a.iconHeight+"px";var f=document.createElement("img");f.setAttribute("src",a.basepath+a.image);f.setAttribute("width",a.iconWidth+"px");
f.setAttribute("height",a.iconHeight+"px");h.appendChild(f);f={};f.width=a.legendTextWidth;f.fontFamily=a.fontFamily;f.fontSize=a.fontSize;f.fontColor=a.fontColor;f.text=a.text;var f=new T(f),g=new M;d.style.width=a.width+"px";d.style.height="auto";d.style.cssFloat="left";d.style.padding="0px";d.appendChild(h);d.appendChild(f);d.appendChild(g);return d},Ia=function(a){var d=document.createElement("div"),h=document.createElement("div");h.style.cssFloat="left";h.style.margin="3px";h.style.width=a.iconWidth+
"px";h.style.height=a.iconHeight+"px";h.style.backgroundColor=a.fill;h.style.opacity=a.opacity;var f={};f.width=a.legendTextWidth;f.fontFamily=a.fontFamily;f.fontSize=a.fontSize;f.fontColor=a.fontColor;f.text=a.text;var f=new T(f),g=new M;d.style.width=a.width+"px";d.style.height="auto";d.style.cssFloat="left";d.style.padding="0px";d.appendChild(h);d.appendChild(f);d.appendChild(g);return d},Ja=function(a){var d=document.createElement("div"),h=document.createElement("div");h.style.cssFloat="left";
h.style.padding="3px";h.style.width=a.iconWidth+"px";h.style.height=a.iconHeight+"px";h.style.backgroundColor=a.fill;var f=q("svg");f.setAttribute("xmlns","http://www.w3.org/2000/svg");f.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");f.setAttribute("version","1.1");f.setAttribute("width",a.iconWidth+"px");f.setAttribute("height",a.iconHeight+"px");f.style.overflow="hidden";var g=q("polyline");g.setAttribute("points","1,"+a.iconHeight/2+" "+(a.iconWidth-1)+","+a.iconHeight/2);g.style.fill=
"none";g.style.stroke=a.stroke;g.style.strokeOpacity=a.opacity;g.style.strokeWidth=2;f.appendChild(g);h.appendChild(f);f={};f.width=a.legendTextWidth;f.fontFamily=a.fontFamily;f.fontSize=a.fontSize;f.fontColor=a.fontColor;f.text=a.text;f=new T(f);g=new M;g.style.width=a.width+"px";d.style.width=a.width+"px";d.style.height="auto";d.style.cssFloat="left";d.style.padding="0px";d.appendChild(h);d.appendChild(f);d.appendChild(g);return d},M=function(){var a=document.createElement("div");a.style.clear=
"both";return a},Ka=function(b){var d={};d.width=b.legendTextWidth;d.fontFamily=b.fontFamily;d.fontSize=b.fontSize;d.fontColor=b.fontColor;d.text=b.text;d=new T(d);d.style.cursor="pointer";a.touchdevices||(d.onmouseover=function(){imap5.categorylegend[b.usermap].visiblelist.length=0;imap5.categorylegend[b.usermap].visiblelist.push(b.categoryid);var a={};a.usermap=b.usermap;imap5.updateCategoryLegend(a);this.style.textDecoration="underline"},d.onmouseout=function(){this.style.textDecoration="none"});
a.touchdevices&&(d.onclick=function(){"undefined"!==typeof imap5.categorylegend[b.usermap].touchlist&&null!==imap5.categorylegend[b.usermap].touchlist&&"undefined"!==typeof imap5.categorylegend[b.usermap].touchlist.style&&(imap5.categorylegend[b.usermap].touchlist.style.textDecoration="none");imap5.categorylegend[b.usermap].visiblelist.length=0;imap5.categorylegend[b.usermap].visiblelist.push(b.categoryid);imap5.categorylegend[b.usermap].touchlist=this;this.style.textDecoration="underline";var a=
{};a.usermap=b.usermap;imap5.updateCategoryLegend(a)});a.touchdevices&&(d.ontouchstart=function(a){a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();this._touch=1==a.touches.length?!0:!1});a.touchdevices&&(d.ontouchend=function(a){this._touch&&(a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),"undefined"!==typeof imap5.categorylegend[b.usermap].touchlist&&null!==imap5.categorylegend[b.usermap].touchlist&&"undefined"!==typeof imap5.categorylegend[b.usermap].touchlist.style&&
(imap5.categorylegend[b.usermap].touchlist.style.textDecoration="none"),imap5.categorylegend[b.usermap].visiblelist.length=0,imap5.categorylegend[b.usermap].visiblelist.push(b.categoryid),imap5.categorylegend[b.usermap].touchlist=this,this.style.textDecoration="underline",a={},a.usermap=b.usermap,imap5.updateCategoryLegend(a))});return d},La=function(b){var d=document.createElement("div"),h=document.createElement("div");h.style.cssFloat="left";h.style.width="16px";h.style.height="16px";var f=document.createElement("input");
f.setAttribute("type","checkbox");f.checked=b.checked;f.setAttribute("width","16px");f.setAttribute("height","16px");h.appendChild(f);f.onclick=function(a){this.checked?imap5.categorylegend[b.usermap].visiblelist.push(b.categoryid):(a=imap5.categorylegend[b.usermap].visiblelist.indexOf(b.categoryid),imap5.categorylegend[b.usermap].visiblelist.splice(a,1));a={};a.usermap=b.usermap;imap5.updateCategoryLegend(a)};var g={};g.width=b.legendTextWidth;g.fontFamily=b.fontFamily;g.fontSize=b.fontSize;g.fontColor=
b.fontColor;g.text=b.text;g=new T(g);g.checkbox=f;g.onclick=function(){this.checkbox.checked=!this.checkbox.checked;if(this.checkbox.checked)imap5.categorylegend[b.usermap].visiblelist.push(b.categoryid);else{var a=imap5.categorylegend[b.usermap].visiblelist.indexOf(b.categoryid);imap5.categorylegend[b.usermap].visiblelist.splice(a,1)}a={};a.usermap=b.usermap;imap5.updateCategoryLegend(a)};a.touchdevices&&(g.ontouchstart=function(a){a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();
this._touch=1==a.touches.length?!0:!1});a.touchdevices&&(g.ontouchend=function(a){this._touch&&(this.checkbox.checked=!this.checkbox.checked,this.checkbox.checked?imap5.categorylegend[b.usermap].visiblelist.push(b.categoryid):(a=imap5.categorylegend[b.usermap].visiblelist.indexOf(b.categoryid),imap5.categorylegend[b.usermap].visiblelist.splice(a,1)),a={},a.usermap=b.usermap,imap5.updateCategoryLegend(a))});g.style.cursor="pointer";f=new M;d.style.width=b.width+"px";d.style.height="auto";d.style.cssFloat=
"left";d.style.padding="0px";d.appendChild(h);d.appendChild(g);d.appendChild(f);return d},ma=function(b,d){var h=q("g");h.id="imap5_"+b.usermap+"_maptitle";h.options=d;h._show=!0;a.svg[b.usermap].appendChild(h);h.setOptions=function(a){this.options=a};h.hide=function(){this.style.display="none";this._show=!1};h.show=function(){this.style.display="block";this._show=!0};h.remove=function(){a.svg[b.usermap].removeChild(this)};h.drawMapTitle=function(){var d=this.getElementsByTagName("text")[0];"undefined"!=
typeof d&&this.removeChild(d);d=q("text");d.appendChild(document.createTextNode(this.options.text));d.style.cursor="default";d.setAttribute("style","stroke-width:0");d.style.strokeOpacity=0;d.style.fontFamily=this.options.style.fontFamily;d.style.fill=this.options.style.fontColor;d.style.fontSize=this.options.style.fontSize;d.style.fontStyle=this.options.style.fontStyle;d.style.fontWeight=this.options.style.fontWeight;d.style.pointerEvents="none";this.appendChild(d);d.setAttribute("x",-4096);d.setAttribute("y",
-4096);d.setAttribute("text-anchor","middle");switch(this.options.anchor){case 1:d.setAttribute("text-anchor","start");d.setAttribute("x",0);d.setAttribute("y",parseInt(d.style.fontSize));break;case 2:d.setAttribute("text-anchor","middle");d.setAttribute("x",a.div[b.usermap].clientWidth/2);d.setAttribute("y",parseInt(d.style.fontSize));break;case 3:d.setAttribute("text-anchor","end");d.setAttribute("x",a.div[b.usermap].clientWidth);d.setAttribute("y",parseInt(d.style.fontSize));break;case 4:d.setAttribute("text-anchor",
"start");d.setAttribute("x",0);d.setAttribute("y",a.div[b.usermap].clientHeight/2+parseInt(d.style.fontSize)/2);break;case 5:d.setAttribute("text-anchor","middle");d.setAttribute("x",a.div[b.usermap].clientWidth/2);d.setAttribute("y",a.div[b.usermap].clientHeight/2+parseInt(d.style.fontSize)/2);break;case 6:d.setAttribute("text-anchor","end");d.setAttribute("x",a.div[b.usermap].clientWidth);d.setAttribute("y",a.div[b.usermap].clientHeight/2+parseInt(d.style.fontSize)/2);break;case 7:d.setAttribute("text-anchor",
"start");d.setAttribute("x",0);d.setAttribute("y",a.div[b.usermap].clientHeight-5);break;case 8:d.setAttribute("text-anchor","middle");d.setAttribute("x",a.div[b.usermap].clientWidth/2);d.setAttribute("y",a.div[b.usermap].clientHeight-5);break;case 9:d.setAttribute("text-anchor","end");d.setAttribute("x",a.div[b.usermap].clientWidth);d.setAttribute("y",a.div[b.usermap].clientHeight-5);break;default:d.setAttribute("text-anchor","middle"),d.setAttribute("x",a.div[b.usermap].clientWidth/2),d.setAttribute("y",
parseInt(d.style.fontSize))}};h.drawMapTitle();return h},la=function(b,d){var h=document.createElement("div");h.id="imap5_"+b.usermap+"_categorylegend";h.options=d;h.style.position="fixed";h._show=!0;a.div[b.usermap].appendChild(h);h.setOptions=function(a){this.options=a};h.hide=function(){this.style.display="none";this._show=!1};h.show=function(){this.style.display="block";this._show=!0};h.remove=function(){a.div[b.usermap].removeChild(document.getElementById(this.id))};h.drawCategoryLegend=function(){this.visiblelist=
[];this.touchlist={};if(this.hasChildNodes())for(;1<=this.childNodes.length;)this.removeChild(this.firstChild);for(var f in d.style)"backgroundColor"!=f&&"opacity"!=f&&(this.style[f]=this.options.style[f]);this.style.backgroundColor="rgba("+ +I(this.options.style.backgroundColor)+","+J(this.options.style.backgroundColor)+","+K(this.options.style.backgroundColor)+","+this.options.style.opacity+")";var g=0,c=this.options.columnsPerRow,e=parseInt(this.options.columnWidth)*c,h=parseInt(this.options.columnWidth)*
c-6,k=parseInt(this.options.columnWidth)-22-6,q=parseInt(this.options.columnWidth),m=new M;m.style.width=e+"px";this.appendChild(m);for(f in this.options.items)if(this.options.items.hasOwnProperty(f)){switch(this.options.items[f].type){case 1:m={};m.text=this.options.items[f].text;m.width=h;m.fontFamily=this.options.style.fontFamily;m.fontSize=this.options.style.fontSize;m.fontColor=this.options.style.fontColor;g=new ya(m);this.appendChild(g);g=0;break;case 2:0==this.options.mode?(m={},m.text=this.options.items[f].text,
m.categoryid=this.options.items[f].categoryid,m.checked=this.options.items[f].checked,this.options.items[f].checked&&-1==this.visiblelist.indexOf(this.options.items[f].categoryid)&&this.visiblelist.push(this.options.items[f].categoryid),m.usermap=b.usermap,m.legendTextWidth=k,m.width=q,m.fontFamily=this.options.style.fontFamily,m.fontSize=this.options.style.fontSize,m.fontColor=this.options.style.fontColor,m.columnsPerRow=this.options.columnsPerRow,m=new La(m)):(m={},m.text=this.options.items[f].text,
m.categoryid=this.options.items[f].categoryid,m.usermap=b.usermap,m.legendTextWidth=k+22,m.width=q,m.fontFamily=this.options.style.fontFamily,m.fontSize=this.options.style.fontSize,m.fontColor=this.options.style.fontColor,m.columnsPerRow=this.options.columnsPerRow,m=new Ka(m)),this.appendChild(m),g+=1}if(g==c||"1"==this.options.items[f].type)m=new M,m.style.width=e+"px",this.appendChild(m),g=0}this.style.position="absolute";this.style.display="table";this.style.width=e+"px";switch(this.options.anchor){case 1:this.style.top=
parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.bottom="auto";this.style.right="auto";break;case 2:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.width)-parseInt(this.offsetWidth))/2+"px";this.style.bottom="auto";this.style.right="auto";break;case 3:this.style.top=
parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.bottom="auto";this.style.left="auto";break;case 4:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.height)-parseInt(this.offsetHeight))/2+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.bottom="auto";this.style.right="auto";break;case 5:this.style.top=
parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.height)-parseInt(this.offsetHeight))/2+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.width)-parseInt(this.offsetWidth))/2+"px";this.style.bottom="auto";this.style.right="auto";break;case 6:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.height)-parseInt(this.offsetHeight))/2+"px";
this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.bottom="auto";this.style.left="auto";break;case 7:this.style.bottom=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.top="auto";this.style.right="auto";break;case 8:this.style.bottom=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+
(parseInt(a.usermap[b.usermap].div.style.width)-parseInt(this.offsetWidth))/2+"px";this.style.top="auto";this.style.right="auto";break;case 9:this.style.bottom=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.top="auto";this.style.left="auto";break;default:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px",this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+
"px",this.style.bottom="auto",this.style.left="auto"}};h.onmouseup=function(a){};h.onmousedown=function(a){};h.onmouseover=function(d){"edit"==a.mode[b.usermap]&&(this.style.cursor="pointer");"edit"==a.mode[b.usermap]&&v(b,d,"Click to select")};h.onmouseout=function(d){"edit"==a.mode[b.usermap]&&(this.style.cursor="auto");"edit"==a.mode[b.usermap]&&G(b)};h.onmousewheel=function(a){};a.div[b.usermap].addEventListener&&h.addEventListener("DOMMouseScroll",function(a){},!1);h.onclick=function(d){d.stopPropagation&&
d.stopPropagation();this._mapdragged||this._transformed||a.div[b.usermap]._mapdragged||"edit"!=a.mode[b.usermap]||(d={event:"click",object:"categorylegend"},window.console&&console.log(JSON.stringify(d)))};a.touchdevices&&(h.ontouchstart=h.ontouchmove=h.ontouchend=function(a){a.stopPropagation&&a.stopPropagation()});h.drawCategoryLegend();return h}}})();